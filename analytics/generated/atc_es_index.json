{"index": {"_id": 6910220422989095734}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "78bc5783-81d9-4d73-ac97-59f6db4f72a8", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: keywords and not 1 of filters\n  filters:\n    Message:\n    - '*Keygen*'\n    - '*Crack*'\n  keywords:\n    Message:\n    - '*HTool*'\n    - '*Hacktool*'\n    - '*ASP/Backdoor*'\n    - '*JSP/Backdoor*'\n    - '*PHP/Backdoor*'\n    - '*Backdoor.ASP*'\n    - '*Backdoor.JSP*'\n    - '*Backdoor.PHP*'\n    - '*Webshell*'\n    - '*Portscan*'\n    - '*Mimikatz*'\n    - '*WinCred*'\n    - '*PlugX*'\n    - '*Korplug*'\n    - '*Pwdump*'\n    - '*Chopper*'\n    - '*WmiExec*'\n    - '*Xscan*'\n    - '*Clearlog*'\n    - '*ASPXSpy*'\n", "detection_rule_title": "Relevant Anti-Virus Event", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8201514968096855014}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "968eef52-9cff-4454-8992-1e74b9cbad6c", "technique": ["T1087: Account Discovery", "T1069: Permission Groups Discovery"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - AccessMask: '0x2d'\n    EventID: 4661\n    ObjectName: S-1-5-21-*-500\n    ObjectType: SAM_USER\n  - AccessMask: '0x2d'\n    EventID: 4661\n    ObjectName: S-1-5-21-*-512\n    ObjectType: SAM_GROUP\n", "detection_rule_title": "Reconnaissance Activity", "detection_rule_author": "Florian Roth (rule), Jack Croock (method)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0029_4661_handle_to_an_object_was_requested"], "logging_policy": ["LP_0028_windows_audit_sam", "LP_0027_windows_audit_directory_service_access"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -306067758868719232}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "496a0e47-0a33-4dca-b009-9e6ca3591f39", "technique": ["T1208: Kerberoasting"], "raw_detection_rule": "detection:\n  condition: selection and not reduction\n  reduction:\n  - ServiceName: $*\n  selection:\n    EventID: 4769\n    TicketEncryptionType: '0x17'\n    TicketOptions: '0x40810000'\n", "detection_rule_title": "Suspicious Kerberos RC4 Ticket Encryption", "detection_rule_author": "not defined", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0077_4769_kerberos_service_ticket_was_requested"], "logging_policy": ["LP_0106_windows_audit_kerberos_service_ticket_operations"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3403462727980317762}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "839dd1e8-eda8-4834-8145-01beeee33acd", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: all of them\n  keywords:\n    Message:\n    - '*\\AppData\\Local\\Temp\\SAM-*.dmp *'\n  selection:\n    EventID: 16\n", "detection_rule_title": "SAM Dump to AppData", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["System"], "provider": ["Microsoft-Windows-Kernel-General"], "data_needed": ["DN_0083_16_access_history_in_hive_was_cleared"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6254242298264460778}}
{"date_created": "2019-02-05T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "faa031b5-21ed-4e02-8881-2591f98d82ed", "technique": ["T1099: Timestomp"], "raw_detection_rule": "detection:\n  condition: selection and not ( filter1 or filter2 or filter3 )\n  filter1:\n    ProcessName: C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe\n  filter2:\n    ProcessName: C:\\Windows\\System32\\VBoxService.exe\n  filter3:\n    ProcessName: C:\\Windows\\System32\\svchost.exe\n    SubjectUserSid: S-1-5-19\n  selection:\n    EventID: 4616\n", "detection_rule_title": "Unauthorized System Time Modification", "detection_rule_author": "@neu5ron", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0088_4616_system_time_was_changed"], "logging_policy": ["LP_0046_windows_audit_security_state_change"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5332029995904674514}}
{"date_created": "2019-11-20T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0001: Initial Access"], "dr_id": "f69a87ea-955e-4fb4-adb2-bb9fd6685632", "technique": ["T1091: Replication Through Removable Media", "T1200: Hardware Additions"], "raw_detection_rule": "detection:\n  condition: selection or selection2\n  selection:\n    DeviceClassName: DiskDrive\n    EventID:\n    - 6416\n  selection2:\n    DeviceDescription: USB Mass Storage Device\n", "detection_rule_title": "External Disk Drive or USB Storage Device", "detection_rule_author": "Keith Wright", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8177179883992184385}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0008: Lateral Movement"], "dr_id": "a8f29a7b-b137-4446-80a0-b804272f3da2", "technique": ["T1053: Scheduled Task"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Accesses: '*WriteData*'\n    EventID: 5145\n    RelativeTargetName: '*ScheduledTasks.xml'\n    ShareName: \\\\*\\SYSVOL\n", "detection_rule_title": "Persistence and Execution at scale via GPO scheduled task", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3090191432913916164}}
{"date_created": "2017-05-15T00:00:00", "date_modified": "2019-11-01T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access", "TA0002: Execution"], "dr_id": "4976aa50-8f41-45c6-8b15-ab3fc10e79ed", "technique": ["T1003: Credential Dumping", "T1035: Service Execution"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    selection:\n      EventID: 7045\n  logsource:\n    product: windows\n    service: system\n- detection:\n    selection:\n      EventID: 6\n  logsource:\n    product: windows\n    service: sysmon\n- detection:\n    selection:\n      EventID: 4697\n  logsource:\n    product: windows\n    service: security\ndetection:\n  condition: selection and selection_1\n  selection_1:\n  - ServiceName|contains:\n    - fgexec\n    - wceservice\n    - wce service\n    - pwdump\n    - gsecdump\n    - cachedump\n    - mimikatz\n    - mimidrv\n  - ImagePath|contains:\n    - fgexec\n    - dumpsvc\n    - cachedump\n    - mimidrv\n    - gsecdump\n    - servpw\n    - pwdump\n  - ImagePath|re: ((\\\\\\\\.*\\\\.*|.*\\\\)([{]?[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}[}])?\\.(exe|scr|cpl|bat|js|cmd|vbs).*)\n", "detection_rule_title": "Credential dumping tools service execution", "detection_rule_author": "Florian Roth, Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["System", "Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Service Control Manager", "Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0005_7045_windows_service_insatalled", "DN_0010_6_windows_sysmon_driver_loaded", "DN_0063_4697_service_was_installed_in_the_system"], "logging_policy": ["not defined", "LP_0100_windows_audit_security_system_extension"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1004011088674850557}}
{"date_created": "2019-08-12T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "13addce7-47b2-4ca0-a98f-1de964d1d669", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4656\n    Keywords: Audit Failure\n    ObjectName: servicesactive\n    ObjectType: SC_MANAGER OBJECT\n    SubjectLogonId: '0x3e4'\n", "detection_rule_title": "T1000 SCM Database Handle Failure", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0058_4656_handle_to_an_object_was_requested"], "logging_policy": ["LP_0102_windows_audit_file_system", "LP_0039_windows_audit_kernel_object", "LP_0104_windows_audit_removable_storage", "LP_0103_windows_audit_registry"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5577135460989202942}}
{"date_created": "2019-08-12T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "9a4ff3b8-6187-4fd2-8e8b-e0eae1129495", "technique": ["T1012: Query Registry"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 4656\n    - 4663\n    ObjectName|endswith:\n    - lsa\\JD\n    - lsa\\GBG\n    - lsa\\Skew1\n    - lsa\\Data\n    ObjectType: key\n", "detection_rule_title": "T1012 SysKey Registry Keys Access", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0058_4656_handle_to_an_object_was_requested", "DN_0062_4663_attempt_was_made_to_access_an_object"], "logging_policy": ["LP_0102_windows_audit_file_system", "LP_0039_windows_audit_kernel_object", "LP_0104_windows_audit_removable_storage", "LP_0103_windows_audit_registry"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -104113199776279682}}
{"date_created": "2019-09-12T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "13acf386-b8c6-4fe0-9a6e-c4756b974698", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    DestPort:\n    - 5985\n    - 5986\n    EventID: 5156\n    LayerRTID: 44\n", "detection_rule_title": "T1086 Remote PowerShell Sessions", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0087_5156_windows_filtering_platform_has_permitted_connection"], "logging_policy": ["LP_0045_windows_audit_filtering_platform_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -617115843002168570}}
{"date_created": "2019-10-25T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "cfeed607-6aa4-4bbd-9627-b637deb723c8", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 4720\n    - 4781\n    UserName|contains: $\nfields:\n- EventID\n- UserName\n- SubjectAccountName\n", "detection_rule_title": "New (or renamed) user account with '$' in attribute 'SamAccountName'.", "detection_rule_author": "Ilyas Ochkov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0086_4720_user_account_was_created"], "logging_policy": ["LP_0026_windows_audit_user_account_management"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3318977338506917286}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": "2019-03-01T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0004: Privilege Escalation"], "dr_id": "9eb99343-d336-4020-a3cd-67f3819e68ee", "technique": ["T1078: Valid Accounts"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 4625\n    - 4776\n    Status:\n    - '0xC0000072'\n    - '0xC000006F'\n    - '0xC0000070'\n    - '0xC0000413'\n    - '0xC000018C'\n    - '0xC000015B'\n", "detection_rule_title": "Account Tampering - Suspicious Failed Logon Reasons", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0057_4625_account_failed_to_logon", "DN_0079_4776_computer_attempted_to_validate_the_credentials_for_an_account"], "logging_policy": ["LP_0004_windows_audit_logon", "LP_0107_windows_audit_credential_validation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8796729867915551271}}
{"date_created": "2018-06-03T00:00:00", "date_modified": "2019-10-08T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "611eab06-a145-4dfa-a295-3ccc5c20f59a", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection and not filter1 and not filter2\n  filter1:\n    SubjectDomainName: Window Manager\n  filter2:\n    SubjectUserName:\n    - NT AUTHORITY*\n    - '*$'\n  selection:\n    EventID: 4662\n    Properties:\n    - '*Replicating Directory Changes All*'\n    - '*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*'\n", "detection_rule_title": "Mimikatz DC Sync", "detection_rule_author": "Benjamin Delpy, Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0030_4662_operation_was_performed_on_an_object"], "logging_policy": ["LP_0027_windows_audit_directory_service_access"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1210245281642898455}}
{"date_created": "2019-01-28T00:00:00", "date_modified": "2019-01-29T00:00:00", "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "51e33403-2a37-4d66-a574-1fda1782cc31", "technique": ["T1076: Remote Desktop Protocol"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4624\n    LogonType: 10\n    SourceNetworkAddress:\n    - ::1\n    - 127.0.0.1\n", "detection_rule_title": "RDP Login from localhost", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0004_4624_windows_account_logon"], "logging_policy": ["LP_0004_windows_audit_logon"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3988608459646984109}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0003: Persistence"], "dr_id": "586a8d6b-6bfe-4ad9-9d78-888cd2fe50c3", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Accesses: '*WriteData*'\n    EventID: 5145\n    RelativeTargetName: svcctl\n    ShareName: \\\\*\\IPC$\n", "detection_rule_title": "Remote Service Activity Detected via SVCCTL named pipe", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6226127875867513266}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "35ba1d85-724d-42a3-889f-2e2362bcaf23", "technique": ["T1087: Account Discovery"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4661\n    ObjectName:\n    - '*-512'\n    - '*-502'\n    - '*-500'\n    - '*-505'\n    - '*-519'\n    - '*-520'\n    - '*-544'\n    - '*-551'\n    - '*-555'\n    - '*admin*'\n    ObjectType:\n    - SAM_USER\n    - SAM_GROUP\n", "detection_rule_title": "AD Privileged Users or Groups Reconnaissance", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0029_4661_handle_to_an_object_was_requested"], "logging_policy": ["LP_0028_windows_audit_sam", "LP_0027_windows_audit_directory_service_access"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5340735417814732840}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "39a80702-d7ca-4a83-b776-525b1f86a36d", "technique": ["T1107: File Deletion", "T1066: Indicator Removal from Tools"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 4656\n    - 4663\n    - 4658\n    ObjectName:\n    - '*.AAA'\n    - '*.ZZZ'\n", "detection_rule_title": "Secure Deletion with SDelete", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0060_4658_handle_to_an_object_was_closed", "DN_0058_4656_handle_to_an_object_was_requested", "DN_0062_4663_attempt_was_made_to_access_an_object"], "logging_policy": ["LP_0102_windows_audit_file_system", "LP_0039_windows_audit_kernel_object", "LP_0104_windows_audit_removable_storage", "LP_0103_windows_audit_registry", "LP_0042_windows_audit_handle_manipulation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2416028521731137446}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "8eef149c-bd26-49f2-9e5a-9b00e3af499b", "technique": ["T1075: Pass the Hash"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    AccountName: ANONYMOUS LOGON\n  selection:\n  - EventID: 4624\n    KeyLength: '0'\n    LogonProcessName: NtLmSsp\n    LogonType: '3'\n    SubjectUserSid: S-1-0-0\n  - EventID: 4624\n    LogonProcessName: seclogo\n    LogonType: '9'\n", "detection_rule_title": "Pass the Hash Activity 2", "detection_rule_author": "Dave Kennedy, Jeff Warren (method) / David Vassallo (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "production", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0004_4624_windows_account_logon"], "logging_policy": ["LP_0004_windows_audit_logon"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8691464870867382257}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access", "TA0003: Persistence"], "dr_id": "300bac00-e041-4ee2-9c36-e262656a6ecc", "technique": ["T1098: Account Manipulation"], "raw_detection_rule": "detection:\n  condition: (selection1 and not 1 of filter*) or selection2 or selection3 or selection4\n  filter1:\n    AllowedToDelegateTo: null\n  filter2:\n    AllowedToDelegateTo: '-'\n  selection1:\n    EventID: 4738\n  selection2:\n    AttributeLDAPDisplayName: msDS-AllowedToDelegateTo\n    EventID: 5136\n  selection3:\n    AttributeLDAPDisplayName: servicePrincipalName\n    EventID: 5136\n    ObjectClass: user\n  selection4:\n    AttributeLDAPDisplayName: msDS-AllowedToActOnBehalfOfOtherIdentity\n    EventID: 5136\n", "detection_rule_title": "Active Directory User Backdoors", "detection_rule_author": "@neu5ron", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0026_5136_windows_directory_service_object_was_modified", "DN_0027_4738_user_account_was_changed"], "logging_policy": ["not defined", "LP_0026_windows_audit_user_account_management"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1370987869541716796}}
{"date_created": "2017-05-15T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "39f919f3-980b-4e6f-a975-8af7e507ef2b", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 16\n    HiveName|contains: \\AppData\\Local\\Temp\\SAM\n    HiveName|endswith: .dmp\n", "detection_rule_title": "QuarksPwDump clearing access history", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["System"], "provider": ["Microsoft-Windows-Kernel-General"], "data_needed": ["DN_0083_16_access_history_in_hive_was_cleared"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7514353219140328880}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0004: Privilege Escalation"], "dr_id": "2632954e-db1c-49cb-9936-67d1ef1d17d2", "technique": ["T1178: SID-History Injection"], "raw_detection_rule": "detection:\n  condition: selection1 or (selection2 and not selection3)\n  selection1:\n    EventID:\n    - 4765\n    - 4766\n  selection2:\n    EventID: 4738\n  selection3:\n    SidHistory:\n    - '-'\n    - '%%1793'\n", "detection_rule_title": "Addition of SID History to Active Directory Object", "detection_rule_author": "Thomas Patzke, @atc_project (improvements)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0074_4765_sid_history_was_added_to_an_account", "DN_0027_4738_user_account_was_changed", "DN_0075_4766_attempt_to_add_sid_history_to_an_account_failed"], "logging_policy": ["LP_0026_windows_audit_user_account_management"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 624068458161671505}}
{"date_created": "2019-10-26T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "843544a7-56e0-4dcc-a44f-5cc266dd97d6", "technique": ["T1134: Access Token Manipulation"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    selection:\n      EventID: 7045\n  logsource:\n    product: windows\n    service: system\n- detection:\n    selection:\n      EventID: 6\n  logsource:\n    product: windows\n    service: sysmon\n- detection:\n    selection:\n      EventID: 4697\n  logsource:\n    product: windows\n    service: security\ndetection:\n  condition: selection\n  selection:\n  - ServiceFileName|contains:\n    - cmd\n    - comspec\n  - ServiceFileName|contains|all:\n    - cmd\n    - /c\n    - echo\n    - \\pipe\\\n  - ServiceFileName|contains|all:\n    - '%COMSPEC%'\n    - /c\n    - echo\n    - \\pipe\\\n  - ServiceFileName|contains|all:\n    - rundll32\n    - .dll,a\n    - '/p:'\nfields:\n- ServiceFileName\n", "detection_rule_title": "Meterpreter or Cobalt Strike getsystem service installation", "detection_rule_author": "Teymur Kheirkhabarov", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["System", "Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Service Control Manager", "Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0005_7045_windows_service_insatalled", "DN_0010_6_windows_sysmon_driver_loaded", "DN_0063_4697_service_was_installed_in_the_system"], "logging_policy": ["not defined", "LP_0100_windows_audit_security_system_extension"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7789545167743497580}}
{"date_created": "2018-06-08T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "98c3bcf1-56f2-49dc-9d8d-c66cf190238b", "technique": ["T1075: Pass the Hash"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CallingProcessName: '*'\n    EventID: 8002\n", "detection_rule_title": "NTLM Logon", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-NTLM/Operational"], "provider": ["Microsoft-Windows-NTLM"], "data_needed": ["DN_0082_8002_ntlm_server_blocked_audit"], "logging_policy": ["LP_0044_windows_ntlm_audit"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5954402043781940576}}
{"date_created": "2019-11-08T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "51aa9387-1c53-4153-91cc-d73c59ae1ca9", "technique": ["T1027: Obfuscated Files or Information"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    selection:\n      EventID: 7045\n  logsource:\n    product: windows\n    service: system\n- detection:\n    selection:\n      EventID: 6\n  logsource:\n    product: windows\n    service: sysmon\n- detection:\n    selection:\n      EventID: 4697\n  logsource:\n    product: windows\n    service: security\ndetection:\n  condition: selection\n  selection:\n  - ImagePath|re: \\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\[\n  - ImagePath|re: \\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\[\n  - ImagePath|re: \\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\[\n  - ImagePath|re: \\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}\n  - ImagePath|re: \\*mdr\\*\\W\\s*\\)\\.Name\n  - ImagePath|re: \\$VerbosePreference\\.ToString\\(\n  - ImagePath|re: \\String\\]\\s*\\$VerbosePreference\n", "detection_rule_title": "Invoke-Obfuscation obfuscated IEX invocation", "detection_rule_author": "Daniel Bohannon (@Mandiant/@FireEye), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["System", "Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Service Control Manager", "Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0005_7045_windows_service_insatalled", "DN_0010_6_windows_sysmon_driver_loaded", "DN_0063_4697_service_was_installed_in_the_system"], "logging_policy": ["not defined", "LP_0100_windows_audit_security_system_extension"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6690614483940835649}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "0f63e1ef-1eb9-4226-9d54-8927ca08520a", "technique": ["T1078: Valid Accounts"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    AccountName: Admin-*\n    AuthenticationPackageName: Negotiate\n    EventID: 4624\n    LogonType: 10\n", "detection_rule_title": "Admin User Remote Logon", "detection_rule_author": "juju4", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0004_4624_windows_account_logon"], "logging_policy": ["LP_0004_windows_audit_logon"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1477465667305504290}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "0255a820-e564-4e40-af2b-6ac61160335c", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4706\n", "detection_rule_title": "Addition of Domain Trusts", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3753477910280441600}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "66b6be3d-55d0-4f47-9855-d69df21740ea", "technique": ["T1136: Create Account"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4720\nfields:\n- EventCode\n- AccountName\n- AccountDomain\n", "detection_rule_title": "Detects local user creation", "detection_rule_author": "Patrick Bareiss", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0086_4720_user_account_was_created"], "logging_policy": ["LP_0026_windows_audit_user_account_management"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1835107396243458479}}
{"date_created": "2019-10-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "910ab938-668b-401b-b08c-b596e80fdca5", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 5145\n    RelativeTargetName|contains:\n    - \\mimidrv\n    - \\lsass\n    - \\windows\\minidump\\\n    - \\hiberfil\n    - \\sqldmpr\n    - \\sam\n    - \\ntds.dit\n    - \\security\n", "detection_rule_title": "Transferring files with credential data via network shares", "detection_rule_author": "Teymur Kheirkhabarov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3973551309125370248}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0004: Privilege Escalation", "TA0003: Persistence"], "dr_id": "b0d77106-7bb0-41fe-bd94-d1752164d066", "technique": ["T1053: Scheduled Task"], "raw_detection_rule": "detection:\n  condition: selection | count() by TaskName < 5\n  selection:\n    EventID: 4698\n  timeframe: 7d\n", "detection_rule_title": "Rare Schtasks Creations", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0064_4698_scheduled_task_was_created"], "logging_policy": ["LP_0041_windows_audit_other_object_access_events"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6640156256284132869}}
{"date_created": "2018-02-12T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "192a0330-c20b-4356-90b6-7b7049ae0b87", "technique": ["T1075: Pass the Hash"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    AuthenticationPackageName: Negotiate\n    EventID: 4624\n    LogonProcessName: seclogo\n    LogonType: 9\n", "detection_rule_title": "Successful Overpass the Hash Attempt", "detection_rule_author": "Roberto Rodriguez (source), Dominik Schaudel (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0004_4624_windows_account_logon"], "logging_policy": ["LP_0004_windows_audit_logon"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3916823563663425905}}
{"date_created": "2019-08-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "dae8171c-5ec6-4396-b210-8466585b53e9", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4674\n    ObjectName: servicesactive\n    ObjectType: SC_MANAGER OBJECT\n    PrivilegeList: SeTakeOwnershipPrivilege\n    SubjectLogonId: '0x3e4'\n", "detection_rule_title": "T1000 SCM Database Privileged Operation", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2653523127867527161}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "f2f01843-e7b8-4f95-a35a-d23584476423", "technique": ["T1070: Indicator Removal on Host"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 517\n    - 1102\n", "detection_rule_title": "Security Eventlog Cleared", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Eventlog"], "data_needed": ["DN_0050_1102_audit_log_was_cleared", "DN_0038_1102_the_audit_log_was_cleared"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5555671296476730074}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "d99b79d2-0a6f-4f46-ad8b-260b6e17f982", "technique": ["T1070: Indicator Removal on Host"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 104\n    Source: Microsoft-Windows-Eventlog\n", "detection_rule_title": "Eventlog Cleared", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["System"], "provider": ["Microsoft-Windows-Eventlog"], "data_needed": ["DN_0034_104_log_file_was_cleared"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2274295456455966583}}
{"date_created": "2019-04-03T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access", "TA0003: Persistence"], "dr_id": "2c99737c-585d-4431-b61a-c911d86ff32f", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 5136\n    LDAPDisplayName: ntSecurityDescriptor\n    Value|contains:\n    - 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2\n    - 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2\n    - 89e95b76-444d-4c62-991a-0facbeda640c\n", "detection_rule_title": "Powerview Add-DomainObjectAcl DCSync AD Extend Right", "detection_rule_author": "Samir Bousseaden; Roberto Rodriguez @Cyb3rWard0g; oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0026_5136_windows_directory_service_object_was_modified"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 985998070443529994}}
{"date_created": "2017-05-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "13fc89a9-971e-4ca6-b9dc-aa53a445bf40", "technique": ["T1073: DLL Side-Loading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 1033\n", "detection_rule_title": "DHCP Server Loaded the CallOut DLL", "detection_rule_author": "Dimitrios Slamaris", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["System"], "provider": ["Microsoft-Windows-DHCP-Server"], "data_needed": ["DN_0048_1033_dhcp_service_successfully_loaded_callout_dlls"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2297273953372702546}}
{"date_created": "2019-08-12T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "f8748f2c-89dc-4d95-afb0-5a2dfdbad332", "technique": ["T1012: Query Registry"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4656\n    ObjectName|endswith: \\SAM\n    ObjectType: Key\n", "detection_rule_title": "T1012 SAM Registry Hive Handle Request", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0058_4656_handle_to_an_object_was_requested"], "logging_policy": ["LP_0102_windows_audit_file_system", "LP_0039_windows_audit_kernel_object", "LP_0104_windows_audit_removable_storage", "LP_0103_windows_audit_registry"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5628016894649112743}}
{"date_created": "2019-08-12T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "cc7abbd0-762b-41e3-8a26-57ad50d2eea3", "technique": ["T1140: Deobfuscate/Decode Files or Information"], "raw_detection_rule": "detection:\n  condition: selection1 or selection2\n  selection1:\n    CommandLine:\n    - '*mshta vbscript:CreateObject(\"Wscript.Shell\")*'\n    - '*mshta vbscript:Execute(\"Execute*'\n    - '*mshta vbscript:CreateObject(\"Wscript.Shell\").Run(\"mshta.exe*'\n  selection2:\n    CommandLine:\n    - '*.jpg*'\n    - '*.png*'\n    - '*.lnk*'\n    - '*.xls*'\n    - '*.doc*'\n    - '*.zip*'\n    Image:\n    - C:\\Windows\\system32\\mshta.exe\n", "detection_rule_title": "MSHTA Suspicious Execution 01", "detection_rule_author": "Diego Perez (@darkquassar)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8251189850205193374}}
{"date_created": "2019-10-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0004: Privilege Escalation"], "dr_id": "12e6d621-194f-4f59-90cc-1959e21e69f7", "technique": ["T1208: Kerberoasting"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - EventID: 4611\n    LogonProcessName: User32LogonProcesss\n", "detection_rule_title": "Register new logon process by Rubeus", "detection_rule_author": "Roberto Rodriguez (source), Ilyas Ochkov (rule), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4399688524920454159}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0001: Initial Access", "TA0008: Lateral Movement"], "dr_id": "aaa5b30d-f418-420b-83a0-299cb6024885", "technique": ["T1210: Exploitation of Remote Services", "T1190: Exploit Public-Facing Application"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 56\n    - 50\n    Source: TermDD\n", "detection_rule_title": "Potential RDP exploit CVE-2019-0708", "detection_rule_author": "Lionel PRAT, Christophe BROCAS, @atc_project (improvements)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["System"], "provider": ["TermDD"], "data_needed": ["DN_0090_50_terminal_server_security_layer_detected_an_error", "DN_0089_56_terminal_server_security_layer_detected_an_error"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4749822482173848123}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "eca91c7c-9214-47b9-b4c5-cb1d7e4f2350", "technique": ["T1208: Kerberoasting"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\lsass.exe\n    - \\opera.exe\n    - \\chrome.exe\n    - \\firefox.exe\n  selection:\n    DestinationPort: 88\n    EventID: 5156\n", "detection_rule_title": "Suspicious outbound Kerberos connection", "detection_rule_author": "Ilyas Ochkov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0087_5156_windows_filtering_platform_has_permitted_connection"], "logging_policy": ["LP_0045_windows_audit_filtering_platform_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4068209515576209066}}
{"date_created": "2018-03-20T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0002: Execution"], "dr_id": "52a85084-6989-40c3-8f32-091e12e13f09", "technique": ["T1077: Windows Admin Shares", "T1035: Service Execution"], "raw_detection_rule": "detection:\n  condition: service_installation\n  service_installation:\n    EventID: 7045\n    ServiceFileName: '*\\execute.bat'\n    ServiceName: BTOBTO\nfields:\n- ServiceName\n- ServiceFileName\n", "detection_rule_title": "smbexec.py Service Installation", "detection_rule_author": "Omer Faruk Celik", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["System"], "provider": ["Service Control Manager"], "data_needed": ["DN_0005_7045_windows_service_insatalled"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7901315381812690101}}
{"date_created": "2019-08-10T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "39a94fd1-8c9a-4ff6-bf22-c058762f8014", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4692\n", "detection_rule_title": "T1003 DPAPI Domain Master Key Backup Attempt", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4160579482663771530}}
{"date_created": "2017-05-08T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "cbe51394-cd93-4473-b555-edf0144952d9", "technique": ["T1073: DLL Side-Loading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 150\n    - 770\n", "detection_rule_title": "DNS Server Error Failed Loading the ServerLevelPluginDLL", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["DNS Server"], "provider": ["Microsoft-Windows-DNS-Server-Service"], "data_needed": ["DN_0043_770_dns_server_plugin_dll_has_been_loaded", "DN_0036_150_dns_server_could_not_load_dll"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8729890304908144855}}
{"date_created": "2017-03-27T00:00:00", "date_modified": "2019-11-01T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0004: Privilege Escalation"], "dr_id": "5a105d34-05fc-401e-8553-272b45c1522d", "technique": ["T1050: New Service"], "raw_detection_rule": "detection:\n  condition: selection and 1 of malsvc_*\n  malsvc_paexec:\n    ServiceFileName|contains: \\PAExec\n  malsvc_persistence:\n    ServiceFileName|contains: net user\n  malsvc_wannacry:\n    ServiceName: mssecsvc2.0\n  selection:\n    EventID: 7045\n", "detection_rule_title": "Malicious Service Installations", "detection_rule_author": "Florian Roth, Daniil Yugoslavskiy, oscd.community (update)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["System"], "provider": ["Service Control Manager"], "data_needed": ["DN_0005_7045_windows_service_insatalled"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6762444569029824591}}
{"date_created": "2017-05-31T00:00:00", "date_modified": "2019-07-26T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery", "TA0002: Execution"], "dr_id": "24549159-ac1b-479c-8175-d42aea947cae", "technique": ["T1087: Account Discovery", "T1075: Pass the Hash", "T1114: Email Collection", "T1059: Command-Line Interface"], "raw_detection_rule": "detection:\n  condition: (1 of selection*)\n  selection1:\n    EventID:\n    - 4776\n    Workstation: RULER\n  selection2:\n    EventID:\n    - 4624\n    - 4625\n    WorkstationName: RULER\n", "detection_rule_title": "Hacktool Ruler", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0057_4625_account_failed_to_logon", "DN_0004_4624_windows_account_logon", "DN_0079_4776_computer_attempted_to_validate_the_credentials_for_an_account"], "logging_policy": ["LP_0004_windows_audit_logon", "LP_0107_windows_audit_credential_validation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7000031307925819634}}
{"date_created": "2019-10-22T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0007: Discovery"], "dr_id": "68fcba0d-73a5-475e-a915-e8b4c576827e", "technique": ["T1112: Modify Registry", "T1012: Query Registry"], "raw_detection_rule": "detection:\n  condition: selection_1 and not selection_2\n  selection_1:\n    EventID: 5145\n    RelativeTargetName|contains: \\winreg\n  selection_2:\n    IpAddress: '%Admins_Workstations%'\n", "detection_rule_title": "Remote registry management using REG utility", "detection_rule_author": "Teymur Kheirkhabarov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1657960731874423124}}
{"date_created": "2019-09-12T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "028c7842-4243-41cd-be6f-12f3cf1a26c7", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    AccessMask: 262144\n    EventID: 4662\n    ObjectServer: DS\n    ObjectType:\n    - 19195a5b-6da0-11d0-afd3-00c04fd930c9\n    - domainDNS\n", "detection_rule_title": "T1000 AD Object WriteDAC Access", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0030_4662_operation_was_performed_on_an_object"], "logging_policy": ["LP_0027_windows_audit_directory_service_access"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1315004088332989270}}
{"date_created": "2017-01-10T00:00:00", "date_modified": "2019-10-11T00:00:00", "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0006: Credential Access"], "dr_id": "06d71506-7beb-4f22-8888-e2e5e2ca7fd8", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: keywords\n  keywords:\n    Message:\n    - '* mimikatz *'\n    - '* mimilib *'\n    - '* <3 eo.oe *'\n    - '* eo.oe.kiwi *'\n    - '* privilege::debug *'\n    - '* sekurlsa::logonpasswords *'\n    - '* lsadump::sam *'\n    - '* mimidrv.sys *'\n    - '* p::d *'\n    - '* s::l *'\n", "detection_rule_title": "Mimikatz Use", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4261425361528996728}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0009: Collection"], "dr_id": "91c945bc-2ad1-4799-a591-4d00198a1215", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 5145\n    RelativeTargetName:\n    - '*.pst'\n    - '*.ost'\n    - '*.msg'\n    - '*.nst'\n    - '*.oab'\n    - '*.edb'\n    - '*.nsf'\n    - '*.bak'\n    - '*.dmp'\n    - '*.kirbi'\n    - '*\\groups.xml'\n    - '*.rdp'\n", "detection_rule_title": "Suspicious access to sensitive file extensions", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2998156311189316784}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "311b6ce2-7890-4383-a8c2-663a9f6b43cd", "technique": ["T1078: Valid Accounts"], "raw_detection_rule": "detection:\n  condition: all of them\n  keywords:\n    Message:\n    - '*SeEnableDelegationPrivilege*'\n  selection:\n    EventID: 4704\n", "detection_rule_title": "Enabled User Right in AD to Control User Objects", "detection_rule_author": "@neu5ron", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0066_4704_user_right_was_assigned"], "logging_policy": ["LP_0105_windows_audit_authorization_policy_change"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6999191760774869889}}
{"date_created": "2017-05-15T00:00:00", "date_modified": "2019-07-17T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "75edd3fd-7146-48e5-9848-3013d7f0282c", "technique": ["T1073: DLL Side-Loading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 1031\n    - 1032\n    - 1034\n    Source: Microsoft-Windows-DHCP-Server\n", "detection_rule_title": "DHCP Server Error Failed Loading the CallOut DLL", "detection_rule_author": "Dimitrios Slamaris, @atc_project (fix)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["System"], "provider": ["Microsoft-Windows-DHCP-Server"], "data_needed": ["DN_0049_1034_dhcp_service_failed_to_load_callout_dlls", "DN_0047_1032_dhcp_service_callout_dll_file_has_caused_an_exception", "DN_0046_1031_dhcp_service_callout_dll_file_has_caused_an_exception"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3714338504484636139}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "69aeb277-f15f-4d2d-b32a-55e883609563", "technique": ["T1054: Indicator Blocking"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    AuditPolicyChanges: removed\n    EventID: 4719\n", "detection_rule_title": "Disabling Windows Event Auditing", "detection_rule_author": "@neu5ron", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0067_4719_system_audit_policy_was_changed"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3419024286693833425}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0004: Privilege Escalation"], "dr_id": "66bfef30-22a5-4fcd-ad44-8d81e60922ae", "technique": ["T1050: New Service"], "raw_detection_rule": "detection:\n  condition: selection | count() by ServiceFileName < 5\n  selection:\n    EventID: 7045\n  timeframe: 7d\n", "detection_rule_title": "Rare Service Installs", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["System"], "provider": ["Service Control Manager"], "data_needed": ["DN_0005_7045_windows_service_insatalled"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2917850074185792301}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "3ff152b2-1388-4984-9cd9-a323323fdadf", "technique": ["T1078: Valid Accounts"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    ComputerName: '%Workstations%'\n    LogonProcessName: Advapi\n  selection:\n    ComputerName:\n    - '%ServerSystems%'\n    - '%DomainControllers%'\n    EventID:\n    - 528\n    - 529\n    - 4624\n    - 4625\n    LogonType: 2\n", "detection_rule_title": "Interactive Logon to Server Systems", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0057_4625_account_failed_to_logon", "DN_0004_4624_windows_account_logon", "DN_0040_528_user_successfully_logged_on_to_a_computer", "DN_0041_529_logon_failure"], "logging_policy": ["LP_0004_windows_audit_logon"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7778251760185758313}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0004: Privilege Escalation"], "dr_id": "53ad8e36-f573-46bf-97e4-15ba5bf4bb51", "technique": ["T1098: Account Manipulation"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4794\n", "detection_rule_title": "Password Change on Directory Service Restore Mode (DSRM) Account", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0028_4794_directory_services_restore_mode_admin_password_set"], "logging_policy": ["LP_0026_windows_audit_user_account_management"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7698475449900387270}}
{"date_created": "2018-03-20T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "d67572a0-e2ec-45d6-b8db-c100d14b8ef2", "technique": ["T1212: Exploitation for Credential Access"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    selection1:\n      EventID: 13\n      TargetObject:\n      - '*SYSTEM\\\\*ControlSet*\\Control\\Lsa\\lmcompatibilitylevel'\n      - '*SYSTEM\\\\*ControlSet*\\Control\\Lsa\\NtlmMinClientSec'\n      - '*SYSTEM\\\\*ControlSet*\\Control\\Lsa\\RestrictSendingNTLMTraffic'\n  logsource:\n    product: windows\n    service: sysmon\n- detection:\n    selection2:\n      EventID: 4657\n      ObjectName: \\REGISTRY\\MACHINE\\SYSTEM\\\\*ControlSet*\\Control\\Lsa\n      ObjectValueName:\n      - LmCompatibilityLevel\n      - NtlmMinClientSec\n      - RestrictSendingNTLMTraffic\n  logsource:\n    definition: 'Requirements: Audit Policy : Object Access > Audit Registry (Success)'\n    product: windows\n    service: security\ndetection:\n  condition: 1 of them\n", "detection_rule_title": "NetNTLM Downgrade Attack", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0059_4657_registry_value_was_modified", "DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["LP_0103_windows_audit_registry"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7177177334773337218}}
{"date_created": "2019-08-10T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "45545954-4016-43c6-855e-eae8f1c369dc", "technique": ["T1021: Remote Services"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 5145\n    RelativeTargetName: protected_storage\n    ShareName|contains: IPC\n", "detection_rule_title": "T1003 Protected Storage Service Access", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1562312229227503373}}
{"date_created": "2017-05-09T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "6c82cf5c-090d-4d57-9188-533577631108", "technique": ["T1089: Disabling Security Tools", "T1211: Exploitation for Defense Evasion"], "raw_detection_rule": "detection:\n  condition: 1 of selection* and all of keywords\n  keywords:\n    Message:\n    - '*MsMpEng.exe*'\n    - '*mpengine.dll*'\n  selection1:\n    EventID: 1000\n    Source: Application Error\n  selection2:\n    EventID: 1001\n    Source: Windows Error Reporting\n", "detection_rule_title": "Microsoft Malware Protection Engine Crash", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7543100830550967862}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "1de68c67-af5c-4097-9c85-fe5578e09e67", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 4656\n    - 4658\n    - 4660\n    - 4663\n    ObjectName: '*\\wceaux.dll'\n", "detection_rule_title": "WCE wceaux.dll Access", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0060_4658_handle_to_an_object_was_closed", "DN_0058_4656_handle_to_an_object_was_requested", "DN_0061_4660_object_was_deleted", "DN_0062_4663_attempt_was_made_to_access_an_object"], "logging_policy": ["LP_0102_windows_audit_file_system", "LP_0039_windows_audit_kernel_object", "LP_0104_windows_audit_removable_storage", "LP_0103_windows_audit_registry", "LP_0042_windows_audit_handle_manipulation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2728922512156847703}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "c462f537-a1e3-41a6-b5fc-b2c2cef9bf82", "technique": ["T1077: Windows Admin Shares"], "raw_detection_rule": "detection:\n  condition: selection1 and not selection2\n  selection1:\n    EventID: 5145\n    RelativeTargetName:\n    - '*-stdin'\n    - '*-stdout'\n    - '*-stderr'\n    ShareName: \\\\*\\IPC$\n  selection2:\n    EventID: 5145\n    RelativeTargetName: PSEXESVC*\n    ShareName: \\\\*\\IPC$\n", "detection_rule_title": "Suspicious PsExec execution", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -9163394681629974499}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "9703792d-fd9a-456d-a672-ff92efe4806a", "technique": ["T1107: File Deletion"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 524\n    Source: Backup\n", "detection_rule_title": "Backup Catalog Deleted", "detection_rule_author": "Florian Roth (rule), Tom U. @c_APT_ure (collection)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2578401165767925718}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "f7644214-0eb0-4ace-9455-331ec4c09253", "technique": ["T1212: Exploitation for Credential Access"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 675\n    - 4768\n    - 4769\n    - 4771\n    FailureCode:\n    - '0x9'\n    - '0xA'\n    - '0xB'\n    - '0xF'\n    - '0x10'\n    - '0x11'\n    - '0x13'\n    - '0x14'\n    - '0x1A'\n    - '0x1F'\n    - '0x21'\n    - '0x22'\n    - '0x23'\n    - '0x24'\n    - '0x26'\n    - '0x27'\n    - '0x28'\n    - '0x29'\n    - '0x2C'\n    - '0x2D'\n    - '0x2E'\n    - '0x2F'\n    - '0x31'\n    - '0x32'\n    - '0x3E'\n    - '0x3F'\n    - '0x40'\n    - '0x41'\n    - '0x43'\n    - '0x44'\n", "detection_rule_title": "Kerberos Manipulation", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0042_675_kerberos_preauthentication_failed", "DN_0077_4769_kerberos_service_ticket_was_requested", "DN_0078_4771_kerberos_pre_authentication_failed", "DN_0076_4768_kerberos_authentication_ticket_was_requested"], "logging_policy": ["LP_0004_windows_audit_logon", "LP_0106_windows_audit_kerberos_service_ticket_operations", "LP_0038_windows_audit_kerberos_authentication_service"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6576742625268084196}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "f6de9536-0441-4b3f-a646-f4e00f300ffd", "technique": ["T1089: Disabling Security Tools"], "raw_detection_rule": "detection:\n  condition: selection and keywords and filters\n  filters:\n    Message:\n    - '*Enabled*'\n  keywords:\n    Message:\n    - '*DES*'\n    - '*Preauth*'\n    - '*Encrypted*'\n  selection:\n    EventID: 4738\n", "detection_rule_title": "Weak Encryption Enabled and Kerberoast", "detection_rule_author": "@neu5ron", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0027_4738_user_account_was_changed"], "logging_policy": ["LP_0026_windows_audit_user_account_management"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3982823753451175171}}
{"date_created": "2019-10-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0010: Exfiltration"], "dr_id": "8e4cf0e5-aa5d-4dc3-beff-dc26917744a9", "technique": ["T1048: Exfiltration Over Alternative Protocol"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    selection:\n      EventID: 7045\n  logsource:\n    product: windows\n    service: system\n- detection:\n    selection:\n      EventID: 6\n  logsource:\n    product: windows\n    service: sysmon\n- detection:\n    selection:\n      EventID: 4697\n  logsource:\n    product: windows\n    service: security\ndetection:\n  condition: selection\n  selection:\n    ImagePath|contains: tap0901\n", "detection_rule_title": "Tap driver installation", "detection_rule_author": "Daniil Yugoslavskiy, Ian Davis, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["System", "Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Service Control Manager", "Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0005_7045_windows_service_insatalled", "DN_0010_6_windows_sysmon_driver_loaded", "DN_0063_4697_service_was_installed_in_the_system"], "logging_policy": ["not defined", "LP_0100_windows_audit_security_system_extension"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4091699943415180895}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "7818b381-5eb1-4641-bea5-ef9e4cfb5951", "technique": ["T1212: Exploitation for Credential Access"], "raw_detection_rule": "detection:\n  condition: ( passwordchanged and not passwordchanged_filter ) | near samrpipe\n  passwordchanged:\n    EventID: 4738\n  passwordchanged_filter:\n    PasswordLastSet: null\n  samrpipe:\n    EventID: 5145\n    RelativeTargetName: samr\n  timeframe: 15s\n", "detection_rule_title": "Possible Remote Password Change Through SAMR", "detection_rule_author": "Dimitrios Slamaris", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed", "DN_0027_4738_user_account_was_changed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share", "LP_0026_windows_audit_user_account_management"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8289906582256024497}}
{"date_created": "2019-06-20T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "4ac1f50b-3bd0-4968-902d-868b4647937e", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    AccessMask: '0x2'\n    EventID: 4662\n    ObjectName: BCKUPKEY\n    ObjectType: SecretObject\n", "detection_rule_title": "T1003 DPAPI Domain Backup Key Extraction", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0030_4662_operation_was_performed_on_an_object"], "logging_policy": ["LP_0027_windows_audit_directory_service_access"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1890903081481694423}}
{"date_created": "2019-11-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation", "TA0006: Credential Access"], "dr_id": "16f5d8ca-44bd-47c8-acbe-6fc95a16c12f", "technique": ["T1171: LLMNR/NBT-NS Poisoning and Relay"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4624\n    LogonType: 3\n    SourceNetworkAddress: 127.0.0.1\n    TargetUserName: ANONYMOUS_LOGON\n    WorkstationName: '-'\n", "detection_rule_title": "RottenPotato Like Attack Pattern", "detection_rule_author": "@SBousseaden, Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0004_4624_windows_account_logon"], "logging_policy": ["LP_0004_windows_audit_logon"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5817490879114108201}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "52d8b0c6-53d6-439a-9e41-52ad442ad9ad", "technique": ["T1077: Windows Admin Shares"], "raw_detection_rule": "detection:\n  condition: selection1 and not selection2\n  selection1:\n    EventID: 5145\n    ShareName: \\\\*\\IPC$\n  selection2:\n    EventID: 5145\n    RelativeTargetName:\n    - atsvc\n    - samr\n    - lsarpc\n    - winreg\n    - netlogon\n    - srvsvc\n    - protected_storage\n    - wkssvc\n    - browser\n    - netdfs\n    ShareName: \\\\*\\IPC$\n", "detection_rule_title": "First time seen remote named pipe", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6338036725897643852}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "5af54681-df95-4c26-854f-2565e13cfab0", "technique": ["T1047: Windows Management Instrumentation"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4624\n    ProcessName: '*\\WmiPrvSE.exe'\n", "detection_rule_title": "Login with WMI", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0004_4624_windows_account_logon"], "logging_policy": ["LP_0004_windows_audit_logon"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7530676046801939284}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0001: Initial Access"], "dr_id": "1a4bd6e3-4c6e-405d-a9a3-53a116e341d4", "technique": ["T1200: Hardware Additions"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 2003\n    - 2100\n    - 2102\n", "detection_rule_title": "USB Device Plugged", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-DriverFrameworks-UserMode/Operational"], "provider": ["Microsoft-Windows-DriverFrameworks-UserMode"], "data_needed": ["DN_0054_2102_pnp_or_power_operation_for_usb_device", "DN_0053_2100_pnp_or_power_operation_for_usb_device", "DN_0052_2003_query_to_load_usb_drivers"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8720984159527714248}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "470ec5fa-7b4e-4071-b200-4c753100f49b", "technique": ["T1009: Binary Padding"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 5038\n    - 6281\n", "detection_rule_title": "Failed Code Integrity Checks", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1602481400226785687}}
{"date_created": "2019-06-20T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "962fe167-e48d-4fd6-9974-11e5b9a5d6d1", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    SubjectUserName|endswith: $\n  selection:\n    EventID:\n    - 4663\n    - 4656\n    ObjectName|endswith: \\lsass.exe\n    ObjectType: Process\n", "detection_rule_title": "T1003 LSASS Access from Non System Account", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0058_4656_handle_to_an_object_was_requested", "DN_0062_4663_attempt_was_made_to_access_an_object"], "logging_policy": ["LP_0102_windows_audit_file_system", "LP_0039_windows_audit_kernel_object", "LP_0104_windows_audit_removable_storage", "LP_0103_windows_audit_registry"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7236166280780384801}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "252902e3-5830-4cf6-bf21-c22083dfd5cf", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 5145\n    RelativeTargetName: SYSTEM32\\\\*.tmp\n    ShareName: \\\\*\\ADMIN$\n", "detection_rule_title": "Possible Impacket SecretDump remote activity", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3520680088765743375}}
{"date_created": "2019-10-25T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "32e19d25-4aed-4860-a55a-be99cb0bf7ed", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4742\n    ServicePrincipalNames: '*GC/*'\n", "detection_rule_title": "Possible DC Sync", "detection_rule_author": "Ilyas Ochkov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4873641577997498708}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "f8d98d6c-7a07-4d74-b064-dd4a3c244528", "technique": ["T1075: Pass the Hash"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    AccountName: ANONYMOUS LOGON\n  selection:\n  - ComputerName: '%Workstations%'\n    EventID: 4624\n    LogonProcessName: NtLmSsp\n    LogonType: '3'\n    WorkstationName: '%Workstations%'\n  - ComputerName: '%Workstations%'\n    EventID: 4625\n    LogonProcessName: NtLmSsp\n    LogonType: '3'\n    WorkstationName: '%Workstations%'\n", "detection_rule_title": "Pass the Hash Activity", "detection_rule_author": "Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0057_4625_account_failed_to_logon", "DN_0004_4624_windows_account_logon"], "logging_policy": ["LP_0004_windows_audit_logon"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -590502549102960015}}
{"date_created": "2019-07-26T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "17d619c1-e020-4347-957e-1d1207455c93", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    SubjectUserName|endswith: $\n  selection:\n    AccessMask: '0x100'\n    EventID: 4662\n    Properties|contains:\n    - 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2\n    - 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2\n    - 89e95b76-444d-4c62-991a-0facbeda640c\n", "detection_rule_title": "T1003 Active Directory Replication from Non Machine Account", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0030_4662_operation_was_performed_on_an_object"], "logging_policy": ["LP_0027_windows_audit_directory_service_access"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3731664516957332023}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "098d7118-55bc-4912-a836-dc6483a8d150", "technique": ["T1077: Windows Admin Shares"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    SubjectUserName: '*$'\n  selection:\n    EventID: 5140\n    ShareName: Admin$\n", "detection_rule_title": "Access to ADMIN$ Share", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0033_5140_network_share_object_was_accessed"], "logging_policy": ["LP_0030_windows_audit_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6675177683787938877}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "c265cf08-3f99-46c1-8d59-328247057d57", "technique": ["T1078: Valid Accounts"], "raw_detection_rule": "detection:\n  condition: selection and (1 of selection_group*) and not filter\n  filter:\n    SubjectUserName: '*$'\n  selection:\n    EventID: 4732\n  selection_group1:\n    GroupName: Administrators\n  selection_group2:\n    GroupSid: S-1-5-32-544\n", "detection_rule_title": "User Added to Local Administrators", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0069_4732_member_was_added_to_security_enabled_local_group"], "logging_policy": ["LP_0101_windows_audit_security_group_management"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3934213740631648050}}
{"date_created": "2019-11-01T00:00:00", "date_modified": "2019-11-07T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "4a1b6da0-d94f-4fc3-98fc-2d9cb9e5ee76", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection_1 or selection_2 and not filter\n  filter:\n    ProcessName|endswith:\n    - \\wmiprvse.exe\n    - \\taskmgr.exe\n    - \\procexp64.exe\n    - \\procexp.exe\n    - \\lsm.exe\n    - \\csrss.exe\n    - \\wininit.exe\n    - \\vmtoolsd.exe\n  selection_1:\n    AccessMask|contains:\n    - '0x40'\n    - '0x1400'\n    - '0x1000'\n    - '0x100000'\n    - '0x1410'\n    - '0x1010'\n    - '0x1438'\n    - '0x143a'\n    - '0x1418'\n    - '0x1f0fff'\n    - '0x1f1fff'\n    - '0x1f2fff'\n    - '0x1f3fff'\n    EventID: 4656\n    ObjectName|endswith: \\lsass.exe\n  selection_2:\n    AccessList|contains:\n    - '4484'\n    - '4416'\n    EventID: 4663\n    ObjectName|endswith: \\lsass.exe\n", "detection_rule_title": "Generic Password Dumper Activity on LSASS", "detection_rule_author": "Roberto Rodriguez, Teymur Kheirkhabarov, Dimitrios Slamaris, Mark Russinovich, Aleksey Potapov, oscd.community (update)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0058_4656_handle_to_an_object_was_requested", "DN_0062_4663_attempt_was_made_to_access_an_object"], "logging_policy": ["LP_0102_windows_audit_file_system", "LP_0039_windows_audit_kernel_object", "LP_0104_windows_audit_removable_storage", "LP_0103_windows_audit_registry"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2581100965315494664}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "aa1697b7-d611-4f9a-9cb2-5125b4ccfd5c", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    AccessMask: '0x705'\n    EventID: 4656\n    ObjectType: SAM_DOMAIN\n    ProcessName: C:\\Windows\\System32\\lsass.exe\n", "detection_rule_title": "Password Dumper Activity on LSASS", "detection_rule_author": "not defined", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0058_4656_handle_to_an_object_was_requested"], "logging_policy": ["LP_0102_windows_audit_file_system", "LP_0039_windows_audit_kernel_object", "LP_0104_windows_audit_removable_storage", "LP_0103_windows_audit_registry"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3845120237737563808}}
{"date_created": "2019-02-16T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0011: Command and Control"], "dr_id": "5bed80b6-b3e8-428e-a3ae-d3c757589e41", "technique": ["T1076: Remote Desktop Protocol"], "raw_detection_rule": "detection:\n  condition: selection and ( sourceRDP or destinationRDP )\n  destinationRDP:\n    DestinationPort: 3389\n    SourceAddress:\n    - 127.*\n    - ::1\n  selection:\n    EventID: 5156\n  sourceRDP:\n    DestinationAddress:\n    - 127.*\n    - ::1\n    SourcePort: 3389\n", "detection_rule_title": "RDP over Reverse SSH Tunnel WFP", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0087_5156_windows_filtering_platform_has_permitted_connection"], "logging_policy": ["LP_0045_windows_audit_filtering_platform_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7455960003276891789}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0003: Persistence"], "dr_id": "f6de6525-4509-495a-8a82-1f8b0ed73a00", "technique": ["T1053: Scheduled Task"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Accesses: '*WriteData*'\n    EventID: 5145\n    RelativeTargetName: atsvc\n    ShareName: \\\\*\\IPC$\n", "detection_rule_title": "Remote Task Creation via ATSVC named pipe", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0032_5145_network_share_object_was_accessed_detailed"], "logging_policy": ["LP_0029_windows_audit_detailed_file_share"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5551121031807376160}}
{"date_created": "2019-06-02T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "8400629e-79a9-4737-b387-5db940ab2367", "technique": ["T1210: Exploitation of Remote Services"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    AccountName: AAAAAAA\n    EventID: 4625\n", "detection_rule_title": "Scanner PoC for CVE-2019-0708 RDP RCE vuln", "detection_rule_author": "Florian Roth (rule), Adam Bradbury (idea)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0057_4625_account_failed_to_logon"], "logging_policy": ["LP_0004_windows_audit_logon"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7587945969853112921}}
{"date_created": "2019-10-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0004: Privilege Escalation"], "dr_id": "6daac7fc-77d1-449a-a71a-e6b4d59a0e54", "technique": ["T1208: Kerberoasting"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - EventID: 4673\n    Keywords: '0x8010000000000000'\n    Service: LsaRegisterLogonProcess()\n", "detection_rule_title": "User couldn't call a privileged service 'LsaRegisterLogonProcess'", "detection_rule_author": "Roberto Rodriguez (source), Ilyas Ochkov (rule), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3705138708989335482}}
{"date_created": "2018-08-26T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "a0a278fe-2c0e-4de2-ac3c-c68b08a9ba98", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 1121\n    Path: '*\\lsass.exe'\n", "detection_rule_title": "LSASS Access Detected via Attack Surface Reduction", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2745722505065655462}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0004: Privilege Escalation"], "dr_id": "e98374a6-e2d9-4076-9b5c-11bdb2569995", "technique": ["T1078: Valid Accounts"], "raw_detection_rule": "detection:\n  condition:\n  - selection1 | count(UserName) by WorkstationName > 3\n  - selection2 | count(UserName) by Workstation > 3\n  selection1:\n    EventID:\n    - 529\n    - 4625\n    UserName: '*'\n    WorkstationName: '*'\n  selection2:\n    EventID: 4776\n    UserName: '*'\n    Workstation: '*'\n  timeframe: 24h\n", "detection_rule_title": "Multiple Failed Logins with Different Accounts from Single Source System", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0057_4625_account_failed_to_logon", "DN_0079_4776_computer_attempted_to_validate_the_credentials_for_an_account", "DN_0041_529_logon_failure"], "logging_policy": ["LP_0004_windows_audit_logon", "LP_0107_windows_audit_credential_validation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1704809143442752476}}
{"date_created": "2019-08-06T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "0acaad27-9f02-4136-a243-c357202edd74", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*\\net.exe stop \"samss\" *'\n    - '*\\net.exe stop \"audioendpointbuilder\" *'\n    - '*\\net.exe stop \"unistoresvc_?????\" *'\n", "detection_rule_title": "Ryuk Ransomware", "detection_rule_author": "Vasiliy Burov", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7408455873986939752}}
{"date_created": "2018-09-09T00:00:00", "date_modified": "2019-10-04T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "fdf135a2-9241-4f96-a114-bb404948f736", "technique": ["T1100: Web Shell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Signature:\n    - PHP/Backdoor*\n    - JSP/Backdoor*\n    - ASP/Backdoor*\n    - Backdoor.PHP*\n    - Backdoor.JSP*\n    - Backdoor.ASP*\n    - '*Webshell*'\nfields:\n- FileName\n- User\n", "detection_rule_title": "Antivirus Web Shell Detection", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["AV Alerts"], "platform": ["antivirus"], "type": ["None"], "channel": ["None"], "provider": ["None"], "data_needed": ["DN_0084_av_alert"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4812799564481030402}}
{"date_created": "2018-09-09T00:00:00", "date_modified": "2019-10-04T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "c9a88268-0047-4824-ba6e-4d81ce0b907c", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    FileName:\n    - C:\\Windows\\Temp\\\\*\n    - C:\\Temp\\\\*\n    - '*\\\\Client\\\\*'\n    - C:\\PerfLogs\\\\*\n    - C:\\Users\\Public\\\\*\n    - C:\\Users\\Default\\\\*\n    - '*.ps1'\n    - '*.vbs'\n    - '*.bat'\n    - '*.chm'\n    - '*.xml'\n    - '*.txt'\n    - '*.jsp'\n    - '*.jspx'\n    - '*.asp'\n    - '*.aspx'\n    - '*.php'\n    - '*.war'\n    - '*.hta'\n    - '*.lnk'\n    - '*.scf'\n    - '*.sct'\n    - '*.vbe'\n    - '*.wsf'\n    - '*.wsh'\nfields:\n- Signature\n- User\n", "detection_rule_title": "Antivirus Relevant File Paths Alerts", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["AV Alerts"], "platform": ["antivirus"], "type": ["None"], "channel": ["None"], "provider": ["None"], "data_needed": ["DN_0084_av_alert"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1117685237254744237}}
{"date_created": "2018-09-09T00:00:00", "date_modified": "2019-01-16T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution", "TA0011: Command and Control"], "dr_id": "238527ad-3c2c-4e4f-a1f6-92fd63adb864", "technique": ["T1203: Exploitation for Client Execution", "T1219: Remote Access Tools"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Signature:\n    - '*MeteTool*'\n    - '*MPreter*'\n    - '*Meterpreter*'\n    - '*Metasploit*'\n    - '*PowerSploit*'\n    - '*CobaltSrike*'\n    - '*Swrort*'\n    - '*Rozena*'\n    - '*Backdoor.Cobalt*'\nfields:\n- FileName\n- User\n", "detection_rule_title": "Antivirus Exploitation Framework Detection", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["AV Alerts"], "platform": ["antivirus"], "type": ["None"], "channel": ["None"], "provider": ["None"], "data_needed": ["DN_0084_av_alert"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5924107578204649428}}
{"date_created": "2018-09-09T00:00:00", "date_modified": "2019-10-04T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "78cc2dd2-7d20-4d32-93ff-057084c38b93", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Signature:\n    - '*DumpCreds*'\n    - '*Mimikatz*'\n    - '*PWCrack*'\n    - HTool/WCE\n    - '*PSWtool*'\n    - '*PWDump*'\n    - '*SecurityTool*'\n    - '*PShlSpy*'\nfields:\n- FileName\n- User\n", "detection_rule_title": "Antivirus Password Dumper Detection", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["AV Alerts"], "platform": ["antivirus"], "type": ["None"], "channel": ["None"], "provider": ["None"], "data_needed": ["DN_0084_av_alert"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1211925233300467565}}
{"date_created": "2019-02-13T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "21f17060-b282-4249-ade0-589ea3591558", "technique": ["T1112: Modify Registry"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 13\n    TargetObject: '*\\Software\\AppDataLow\\Software\\Microsoft\\\\*'\n", "detection_rule_title": "Ursnif", "detection_rule_author": "megan201296", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -349895924896177361}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "42c575ea-e41e-41f1-b248-8093c3e82a28", "technique": ["T1035: Service Execution"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    service_execution:\n      EventID: 7036\n      ServiceName: PSEXESVC\n    service_installation:\n      EventID: 7045\n      ServiceFileName: '*\\PSEXESVC.exe'\n      ServiceName: PSEXESVC\n  logsource:\n    product: windows\n    service: system\n- detection:\n    sysmon_processcreation:\n      Image: '*\\PSEXESVC.exe'\n      User: NT AUTHORITY\\SYSTEM\n  logsource:\n    category: process_creation\n    product: windows\ndetection:\n  condition: 1 of them\nfields:\n- EventID\n- CommandLine\n- ParentCommandLine\n- ServiceName\n- ServiceFileName\n", "detection_rule_title": "PsExec Tool Execution", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["System", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Service Control Manager", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0005_7045_windows_service_insatalled", "DN_0031_7036_service_started_stopped", "DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["not defined", "LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6164343361149069733}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "b20f6158-9438-41be-83da-a5a16ac90c2b", "technique": ["T1053: Scheduled Task"], "raw_detection_rule": "detection:\n  condition: selection | count() by TaskName < 5\n  selection:\n    EventID: 106\n  timeframe: 7d\n", "detection_rule_title": "Rare Scheduled Task Creations", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-TaskScheduler/Operational"], "provider": ["Microsoft-Windows-TaskScheduler"], "data_needed": ["DN_0035_106_task_scheduler_task_registered"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2000917646370623451}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0003: Persistence"], "dr_id": "0b7889b4-5577-4521-a60a-3376ee7f9f7b", "technique": ["T1047: Windows Management Instrumentation"], "raw_detection_rule": "detection:\n  condition: selection and 1 of keywords or selection2\n  keywords:\n    Message:\n    - '*ActiveScriptEventConsumer*'\n    - '*CommandLineEventConsumer*'\n    - '*CommandLineTemplate*'\n  selection:\n    EventID: 5861\n  selection2:\n    EventID: 5859\n", "detection_rule_title": "WMI Persistence", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-WMI-Activity/Operational"], "provider": ["Microsoft-Windows-WMI-Activity"], "data_needed": ["DN_0081_5861_wmi_activity", "DN_0080_5859_wmi_activity"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7113304370119178798}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "6331d09b-4785-4c13-980f-f96661356249", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    HostVersion: 2.*\n  selection:\n    EngineVersion: 2.*\n    EventID: 400\n", "detection_rule_title": "PowerShell Downgrade Attack", "detection_rule_author": "Florian Roth (rule), Lee Holmes (idea)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Windows PowerShell"], "provider": ["PowerShell"], "data_needed": ["DN_0038_400_engine_state_is_changed_from_none_to_available"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5461694247457797610}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "65531a81-a694-4e31-ae04-f8ba5bc33759", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: keywords\n  keywords:\n    Message:\n    - '*System.Net.WebClient).DownloadString(*'\n    - '*system.net.webclient).downloadfile(*'\n", "detection_rule_title": "Suspicious PowerShell Download", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5954402043781940576}}
{"date_created": "2019-11-08T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "1b9dc62e-6e9e-42a3-8990-94d7a10007f7", "technique": ["T1027: Obfuscated Files or Information"], "raw_detection_rule": "detection:\n  condition: ( selection_1 and selection_2 ) or ( selection_3 and selection_4 )\n  selection_1:\n    EventID: 4104\n  selection_2:\n  - ScriptBlockText|re: \\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\[\n  - ScriptBlockText|re: \\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\[\n  - ScriptBlockText|re: \\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\[\n  - ScriptBlockText|re: \\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}\n  - ScriptBlockText|re: \\*mdr\\*\\W\\s*\\)\\.Name\n  - ScriptBlockText|re: \\$VerbosePreference\\.ToString\\(\n  - ScriptBlockText|re: \\String\\]\\s*\\$VerbosePreference\n  selection_3:\n    EventID: 4103\n  selection_4:\n  - Payload|re: \\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\[\n  - Payload|re: \\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\[\n  - Payload|re: \\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\[\n  - Payload|re: \\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}\n  - Payload|re: \\*mdr\\*\\W\\s*\\)\\.Name\n  - Payload|re: \\$VerbosePreference\\.ToString\\(\n  - Payload|re: \\String\\]\\s*\\$VerbosePreference\n", "detection_rule_title": "Invoke-Obfuscation obfuscated IEX invocation", "detection_rule_author": "Daniel Bohannon (@Mandiant/@FireEye), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0037_4103_windows_powershell_executing_pipeline", "DN_0036_4104_windows_powershell_script_block"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 99746026111121161}}
{"date_created": "2019-02-11T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "1f49f2ab-26bc-48b3-96cc-dcffbc93eadf", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: keywords\n  keywords:\n    Message:\n    - System.Reflection.Assembly.Load\n    - '[System.Reflection.Assembly]::Load'\n    - '[Reflection.Assembly]::Load'\n    - System.Reflection.AssemblyName\n    - Reflection.Emit.AssemblyBuilderAccess\n    - Runtime.InteropServices.DllImportAttribute\n    - SuspendThread\n", "detection_rule_title": "Suspicious PowerShell Keywords", "detection_rule_author": "Florian Roth, Perez Diego (@darkquassar)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1997671138293283099}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": "2019-01-22T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "89819aa4-bbd6-46bc-88ec-c7f7fe30efa6", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: keywords and not false_positives\n  false_positives:\n  - Get-SystemDriveInfo\n  keywords:\n    Message:\n    - '*Invoke-DllInjection*'\n    - '*Invoke-Shellcode*'\n    - '*Invoke-WmiCommand*'\n    - '*Get-GPPPassword*'\n    - '*Get-Keystrokes*'\n    - '*Get-TimedScreenshot*'\n    - '*Get-VaultCredential*'\n    - '*Invoke-CredentialInjection*'\n    - '*Invoke-Mimikatz*'\n    - '*Invoke-NinjaCopy*'\n    - '*Invoke-TokenManipulation*'\n    - '*Out-Minidump*'\n    - '*VolumeShadowCopyTools*'\n    - '*Invoke-ReflectivePEInjection*'\n    - '*Invoke-UserHunter*'\n    - '*Find-GPOLocation*'\n    - '*Invoke-ACLScanner*'\n    - '*Invoke-DowngradeAccount*'\n    - '*Get-ServiceUnquoted*'\n    - '*Get-ServiceFilePermission*'\n    - '*Get-ServicePermission*'\n    - '*Invoke-ServiceAbuse*'\n    - '*Install-ServiceBinary*'\n    - '*Get-RegAutoLogon*'\n    - '*Get-VulnAutoRun*'\n    - '*Get-VulnSchTask*'\n    - '*Get-UnattendedInstallFile*'\n    - '*Get-ApplicationHost*'\n    - '*Get-RegAlwaysInstallElevated*'\n    - '*Get-Unconstrained*'\n    - '*Add-RegBackdoor*'\n    - '*Add-ScrnSaveBackdoor*'\n    - '*Gupt-Backdoor*'\n    - '*Invoke-ADSBackdoor*'\n    - '*Enabled-DuplicateToken*'\n    - '*Invoke-PsUaCme*'\n    - '*Remove-Update*'\n    - '*Check-VM*'\n    - '*Get-LSASecret*'\n    - '*Get-PassHashes*'\n    - '*Show-TargetScreen*'\n    - '*Port-Scan*'\n    - '*Invoke-PoshRatHttp*'\n    - '*Invoke-PowerShellTCP*'\n    - '*Invoke-PowerShellWMI*'\n    - '*Add-Exfiltration*'\n    - '*Add-Persistence*'\n    - '*Do-Exfiltration*'\n    - '*Start-CaptureServer*'\n    - '*Get-ChromeDump*'\n    - '*Get-ClipboardContents*'\n    - '*Get-FoxDump*'\n    - '*Get-IndexedItem*'\n    - '*Get-Screenshot*'\n    - '*Invoke-Inveigh*'\n    - '*Invoke-NetRipper*'\n    - '*Invoke-EgressCheck*'\n    - '*Invoke-PostExfil*'\n    - '*Invoke-PSInject*'\n    - '*Invoke-RunAs*'\n    - '*MailRaider*'\n    - '*New-HoneyHash*'\n    - '*Set-MacAttribute*'\n    - '*Invoke-DCSync*'\n    - '*Invoke-PowerDump*'\n    - '*Exploit-Jboss*'\n    - '*Invoke-ThunderStruck*'\n    - '*Invoke-VoiceTroll*'\n    - '*Set-Wallpaper*'\n    - '*Invoke-InveighRelay*'\n    - '*Invoke-PsExec*'\n    - '*Invoke-SSHCommand*'\n    - '*Get-SecurityPackages*'\n    - '*Install-SSP*'\n    - '*Invoke-BackdoorLNK*'\n    - '*PowerBreach*'\n    - '*Get-SiteListPassword*'\n    - '*Get-System*'\n    - '*Invoke-BypassUAC*'\n    - '*Invoke-Tater*'\n    - '*Invoke-WScriptBypassUAC*'\n    - '*PowerUp*'\n    - '*PowerView*'\n    - '*Get-RickAstley*'\n    - '*Find-Fruit*'\n    - '*HTTP-Login*'\n    - '*Find-TrustedDocuments*'\n    - '*Invoke-Paranoia*'\n    - '*Invoke-WinEnum*'\n    - '*Invoke-ARPScan*'\n    - '*Invoke-PortScan*'\n    - '*Invoke-ReverseDNSLookup*'\n    - '*Invoke-SMBScanner*'\n    - '*Invoke-Mimikittenz*'\n", "detection_rule_title": "Malicious PowerShell Commandlets", "detection_rule_author": "Sean Metcalf (source), Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8803754672053439530}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "8c521530-5169-495d-a199-0a3a881ad24e", "technique": ["T1096: NTFS File Attributes"], "raw_detection_rule": "detection:\n  condition: keyword1 and keyword2\n  keyword1:\n  - set-content\n  keyword2:\n  - -stream\n", "detection_rule_title": "NTFS Alternate Data Stream", "detection_rule_author": "Sami Ruohonen", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0037_4103_windows_powershell_executing_pipeline", "DN_0036_4104_windows_powershell_script_block"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4643043398522715232}}
{"date_created": "2019-08-10T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "96b9f619-aa91-478f-bacb-c3e50f8df575", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 4103\n    - 400\n    HostApplication|contains: wsmprovhost.exe\n    HostName: ServerRemoteHost\n", "detection_rule_title": "T1086 Remote PowerShell Session", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0037_4103_windows_powershell_executing_pipeline"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 9008596066170767024}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0006: Credential Access"], "dr_id": "ca8b77a9-d499-4095-b793-5d5f330d450e", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: all of them\n  keyword:\n    Message:\n    - '*PromptForCredential*'\n  selection:\n    EventID: 4104\n", "detection_rule_title": "PowerShell Credential Prompt", "detection_rule_author": "John Lambert (idea), Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0036_4104_windows_powershell_script_block"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3480875483649312924}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "c70e019b-1479-4b65-b0cc-cd0c6093a599", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection1\n  selection1:\n    EngineVersion:\n    - 2.*\n    - 4.*\n    - 5.*\n    EventID: 400\n    HostVersion: 3.*\n", "detection_rule_title": "PowerShell called from an Executable Version Mismatch", "detection_rule_author": "Sean Metcalf (source), Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Windows PowerShell"], "provider": ["PowerShell"], "data_needed": ["DN_0038_400_engine_state_is_changed_from_none_to_available"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5402949659532480942}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "3d304fda-78aa-43ed-975c-d740798a49c1", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: all of them\n  encoded:\n  - ' -enc '\n  - ' -EncodedCommand '\n  hidden:\n  - ' -w hidden '\n  - ' -window hidden '\n  - ' - windowstyle hidden '\n  noninteractive:\n  - ' -noni '\n  - ' -noninteractive '\n", "detection_rule_title": "Suspicious PowerShell Invocations - Generic", "detection_rule_author": "Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0037_4103_windows_powershell_executing_pipeline", "DN_0036_4104_windows_powershell_script_block"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3527796174231327810}}
{"date_created": "2018-11-17T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation", "TA0002: Execution"], "dr_id": "16b37b70-6fcf-4814-a092-c36bd3aafcbd", "technique": ["T1055: Process Injection", "T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection and keyword1 and keyword2\n  keyword1:\n  - '*AAAAYInlM*'\n  keyword2:\n  - '*OiCAAAAYInlM*'\n  - '*OiJAAAAYInlM*'\n  selection:\n    EventID: 4104\n", "detection_rule_title": "PowerShell ShellCode", "detection_rule_author": "David Ledbetter (shellcode), Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0036_4104_windows_powershell_script_block"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 9060982269578403906}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": "2019-01-22T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "f62176f3-8128-4faa-bf6c-83261322e5eb", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: keywords\n  keywords:\n    Message:\n    - '*AdjustTokenPrivileges*'\n    - '*IMAGE_NT_OPTIONAL_HDR64_MAGIC*'\n    - '*Microsoft.Win32.UnsafeNativeMethods*'\n    - '*ReadProcessMemory.Invoke*'\n    - '*SE_PRIVILEGE_ENABLED*'\n    - '*LSA_UNICODE_STRING*'\n    - '*MiniDumpWriteDump*'\n    - '*PAGE_EXECUTE_READ*'\n    - '*SECURITY_DELEGATION*'\n    - '*TOKEN_ADJUST_PRIVILEGES*'\n    - '*TOKEN_ALL_ACCESS*'\n    - '*TOKEN_ASSIGN_PRIMARY*'\n    - '*TOKEN_DUPLICATE*'\n    - '*TOKEN_ELEVATION*'\n    - '*TOKEN_IMPERSONATE*'\n    - '*TOKEN_INFORMATION_CLASS*'\n    - '*TOKEN_PRIVILEGES*'\n    - '*TOKEN_QUERY*'\n    - '*Metasploit*'\n    - '*Mimikatz*'\n", "detection_rule_title": "Malicious PowerShell Keywords", "detection_rule_author": "Sean Metcalf (source), Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1326176049199153874}}
{"date_created": "2019-10-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0010: Exfiltration"], "dr_id": "a6d67db4-6220-436d-8afc-f3842fe05d43", "technique": ["T1048: Exfiltration Over Alternative Protocol"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4104\n    ScriptBlockText|contains: Start-Dnscat2\n", "detection_rule_title": "Dnscat execution", "detection_rule_author": "Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0036_4104_windows_powershell_script_block"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4380087149417048151}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "b7ec41a4-042c-4f31-a5db-d0fcde9fa5c5", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: all of them\n  keyword:\n  - PS ATTACK!!!\n  selection:\n    EventID: 4103\n", "detection_rule_title": "PowerShell PSAttack", "detection_rule_author": "Sean Metcalf (source), Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0037_4103_windows_powershell_executing_pipeline"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3851236309443622709}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "fce5f582-cc00-41e1-941a-c6fabf0fdb8c", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: keywords\n  keywords:\n    Message:\n    - '* -nop -w hidden -c * [Convert]::FromBase64String*'\n    - '* -w hidden -noni -nop -c \"iex(New-Object*'\n    - '* -w hidden -ep bypass -Enc*'\n    - '*powershell.exe reg add HKCU\\software\\microsoft\\windows\\currentversion\\run*'\n    - '*bypass -noprofile -windowstyle hidden (new-object system.net.webclient).download*'\n    - '*iex(New-Object Net.WebClient).Download*'\n", "detection_rule_title": "Suspicious PowerShell Invocations - Specific", "detection_rule_author": "Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7263006417690352458}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0010: Exfiltration"], "dr_id": "6dc5d284-69ea-42cf-9311-fb1c3932a69a", "technique": ["T1002: Data Compressed"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 4104\n    keywords|contains|all:\n    - -Recurse\n    - '|'\n    - Compress-Archive\n", "detection_rule_title": "Data Compressed - Powershell", "detection_rule_author": "Timur Zinniatullin, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0036_4104_windows_powershell_script_block"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8147019887155468940}}
{"date_created": "2019-08-11T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "64e8e417-c19a-475a-8d19-98ea705394cc", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    HostApplication: powershell.exe\n  selection:\n    EventID:\n    - 4103\n    - 400\n", "detection_rule_title": "T1086 Alternate PowerShell Hosts", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0037_4103_windows_powershell_executing_pipeline"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3834615333410480587}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "851c506b-6b7c-4ce2-8802-c703009d03c0", "technique": ["T1004: Winlogon Helper DLL"], "raw_detection_rule": "detection:\n  condition: selection and ( keyword1 and keyword2 )\n  keyword1:\n  - '*Set-ItemProperty*'\n  - '*New-Item*'\n  keyword2:\n  - '*CurrentVersion\\Winlogon*'\n  selection:\n    EventID: 4104\n", "detection_rule_title": "Winlogon Helper DLL", "detection_rule_author": "Timur Zinniatullin, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0036_4104_windows_powershell_script_block"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -9166030768230190741}}
{"date_created": "2019-10-25T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "dfba4ce1-e0ea-495f-986e-97140f31af2d", "technique": ["T1146: Clear Command History"], "raw_detection_rule": "detection:\n  condition: keywords\n  keywords:\n  - del (Get-PSReadlineOption).HistorySavePath\n  - \"Set-PSReadlineOption \\u2013HistorySaveStyle SaveNothing\"\n  - Remove-Item (Get-PSReadlineOption).HistorySavePath\n  - rm (Get-PSReadlineOption).HistorySavePath\n", "detection_rule_title": "Clear PowerShell History", "detection_rule_author": "Ilyas Ochkov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-PowerShell/Operational"], "provider": ["Microsoft-Windows-PowerShell"], "data_needed": ["DN_0037_4103_windows_powershell_executing_pipeline", "DN_0036_4104_windows_powershell_script_block"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1152256896280429810}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "60fc936d-2eb0-4543-8a13-911c750a1dfc", "technique": ["T1053: Scheduled Task"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: interactive\n    Image|endswith: \\at.exe\n", "detection_rule_title": "Interactive AT Job", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -863157744309347640}}
{"date_created": "2018-03-07T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0003: Persistence"], "dr_id": "ec1d5e28-8f3b-4188-a6f8-6e8df81dc28e", "technique": ["T1047: Windows Management Instrumentation"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: C:\\WINDOWS\\system32\\wbem\\scrcons.exe\n    ParentImage: C:\\Windows\\System32\\svchost.exe\n", "detection_rule_title": "WMI Persistence - Script Event Consumer", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7815431999459584054}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "1e33157c-53b1-41ad-bbcc-780b80b58288", "technique": ["T1064: Scripting"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*.jse'\n    - '*.vbe'\n    - '*.js'\n    - '*.vba'\n    Image:\n    - '*\\wscript.exe'\n    - '*\\cscript.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "WSF/JSE/JS/VBA/VBE File Execution", "detection_rule_author": "Michael Haag", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1704809143442752476}}
{"date_created": "2019-12-16T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "c37510b8-2107-4b78-aa32-72f251e7a844", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - Microsoft\\Windows\\CurrentVersion\\Run\n    - C:\\users\\Public\\\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Ryuk Ransomware", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5081108554078174147}}
{"date_created": "2018-09-05T00:00:00", "date_modified": null, "customer": ["TESTCUSTOMER"], "tactic": ["TA0002: Execution"], "dr_id": "bb780e0c-16cf-4383-8383-1e5471db6cf9", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '* -bxor*'\n", "detection_rule_title": "Suspicious XOR Encoded PowerShell Command Line", "detection_rule_author": "Sami Ruohonen", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3698497074403033210}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "95eadcb2-92e4-4ed1-9031-92547773a6db", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection and not falsepositive\n  falsepositive:\n    CurrentDirectory: '*\\Health Service State\\\\*'\n  selection:\n    Image:\n    - '*\\powershell.exe'\n    ParentImage:\n    - '*\\wscript.exe'\n    - '*\\cscript.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious PowerShell Invocation based on Parent Process", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1086024299488309627}}
{"date_created": "2019-10-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0010: Exfiltration"], "dr_id": "27a72a60-7e5e-47b1-9d17-909c9abafdcd", "technique": ["T1020: Automated Exfiltration", "T1002: Data Compressed"], "raw_detection_rule": "detection:\n  condition: selection and not falsepositive\n  falsepositive:\n    ParentImage: C:\\Program*\n  selection:\n    CommandLine:\n    - '* -p*'\n    - '* -ta*'\n    - '* -tb*'\n    - '* -sdel*'\n    - '* -dw*'\n    - '* -hp*'\n    OriginalFileName:\n    - 7z*.exe\n    - '*rar.exe'\n    - '*Command*Line*RAR*'\n", "detection_rule_title": "Suspicious Compression Tool Parameters", "detection_rule_author": "Florian Roth, Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -514315964132412504}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "526be59f-a573-4eea-b5f7-f0973207634d", "technique": ["T1047: Windows Management Instrumentation"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*/NODE:*process call create *'\n    - '* path AntiVirusProduct get *'\n    - '* path FirewallProduct get *'\n    - '* shadowcopy delete *'\n    Image:\n    - '*\\wmic.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious WMI execution", "detection_rule_author": "Michael Haag, Florian Roth, juju4", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2479262438217248838}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "138d3531-8793-4f50-a2cd-f291b2863d78", "technique": ["T1031: Modify Existing Service"], "raw_detection_rule": "detection:\n  condition: selection_1 and selection_2\n  selection_1:\n    CommandLine|contains|all:\n    - config\n    - binpath\n    Image|endswith: \\sc.exe\n  selection_2:\n    CommandLine|contains:\n    - powershell\n    - cmd\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious service path modification", "detection_rule_author": "Victor Sergeev, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 9149602422083419442}}
{"date_created": "2019-09-03T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "10c14723-61c7-4c75-92ca-9af245723ad2", "technique": ["T1047: Windows Management Instrumentation", "T1175: Distributed Component Object Model"], "raw_detection_rule": "detection:\n  condition: (1 of selection_*)\n  selection_atexec:\n    CommandLine:\n    - cmd.exe /C *Windows\\\\Temp\\\\*&1\n    ParentCommandLine:\n    - '*svchost.exe -k netsvcs'\n    - taskeng.exe*\n  selection_other:\n    CommandLine:\n    - '*cmd.exe* /Q /c * \\\\\\\\127.0.0.1\\\\*&1*'\n    ParentImage:\n    - '*\\wmiprvse.exe'\n    - '*\\mmc.exe'\n    - '*\\explorer.exe'\n    - '*\\services.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Impacket Lateralization Detection", "detection_rule_author": "Ecco", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7769739183608859297}}
{"date_created": "2019-10-25T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "24357373-078f-44ed-9ac4-6d334a668a11", "technique": ["T1060: Registry Run Keys / Startup Folder"], "raw_detection_rule": "detection:\n  condition: selection_1 and selection_2\n  selection_1:\n    CommandLine|contains: add\n    Image|endswith: '*\\reg.exe'\n  selection_2:\n    CommandLine|contains:\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\Run\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\RunServices\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce\n    - \\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit\n    - \\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell\n    - \\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\n    - \\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Direct autorun keys modification", "detection_rule_author": "Victor Sergeev, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8524729135279850749}}
{"date_created": "2018-03-18T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "9fff585c-c33e-4a86-b3cd-39312079a65f", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: '*\\taskmgr.exe'\n    User: NT AUTHORITY\\SYSTEM\n", "detection_rule_title": "Taskmgr as LOCAL_SYSTEM", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8320443160555250087}}
{"date_created": "2019-06-03T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "8065b1b4-1778-4427-877f-6bf948b26d38", "technique": ["T1068: Exploitation for Privilege Escalation"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    IntegrityLevel: System\n    ParentIntegrityLevel: Medium\n    User: NT AUTHORITY\\SYSTEM\nenrichment:\n- EN_0001_cache_sysmon_event_id_1_info\n- EN_0002_enrich_sysmon_event_id_1_with_parent_info\n", "detection_rule_title": "Windows Kernel and 3rd-party drivers exploits. Token stealing", "detection_rule_author": "Teymur Kheirkhabarov (source), Daniil Yugoslavskiy (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["EN_0001_cache_sysmon_event_id_1_info", "EN_0002_enrich_sysmon_event_id_1_with_parent_info"], "enrichment_requirements": ["not defined", ["EN_0001_cache_sysmon_event_id_1_info"]]}
{"index": {"_id": 6773296799874670927}}
{"date_created": "2018-08-17T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0005: Defense Evasion"], "dr_id": "30edb182-aa75-42c0-b0a9-e998bb29067c", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection1 and selection2\n  falsepositives:\n  - Potential Admin Activity\n  selection1:\n    CommandLine:\n    - '*System.Management.Automation.AmsiUtils*'\n  selection2:\n    CommandLine:\n    - '*amsiInitFailed*'\n", "detection_rule_title": "Powershell AMSI Bypass via .NET Reflection", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3163448859978414680}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0007: Discovery", "TA0005: Defense Evasion"], "dr_id": "183e7ea8-ac4b-4c23-9aec-b3dac4e401ac", "technique": ["T1027: Obfuscated Files or Information", "T1049: System Network Connections Discovery", "T1077: Windows Admin Shares", "T1135: Network Share Discovery"], "raw_detection_rule": "detection:\n  cmdline:\n    CommandLine:\n    - '* group*'\n    - '* localgroup*'\n    - '* user*'\n    - '* view*'\n    - '* share'\n    - '* accounts*'\n    - '* use*'\n    - '* stop *'\n  condition: selection and cmdline\n  selection:\n    Image:\n    - '*\\net.exe'\n    - '*\\net1.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Net.exe Execution", "detection_rule_author": "Michael Haag, Mark Woan (improvements), James Pemberton / @4A616D6573 / oscd.community (improvements)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8235058810989745128}}
{"date_created": "2019-10-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "a642964e-bead-4bed-8910-1bb4d63e3b4d", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection_1 or selection_2 and selection_3\n  selection_1:\n    CommandLine|contains:\n    - DumpCreds\n    - invoke-mimikatz\n  selection_2:\n    CommandLine|contains:\n    - rpc\n    - token\n    - crypto\n    - dpapi\n    - sekurlsa\n    - kerberos\n    - lsadump\n    - privilege\n    - process\n  selection_3:\n    CommandLine|contains:\n    - '::'\n", "detection_rule_title": "Mimikatz command line", "detection_rule_author": "Teymur Kheirkhabarov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 643114997491967098}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "419dbf2b-8a9b-4bea-bf99-7544b050ec8d", "technique": ["T1127: Trusted Developer Utilities"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: '*\\Microsoft.Workflow.Compiler.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Microsoft Workflow Compiler", "detection_rule_author": "Nik Seetharaman", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3159064757738137101}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0006: Credential Access", "TA0005: Defense Evasion"], "dr_id": "79aeeb41-8156-4fac-a0cd-076495ab82a1", "technique": ["T1085: Rundll32", "T1070: Indicator Removal on Host", "T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: 1 of them\n  perfc_keyword:\n  - '*\\perfc.dat*'\n  pipe_com:\n    CommandLine: '*\\AppData\\Local\\Temp\\\\* \\\\.\\pipe\\\\*'\n  rundll32_dash1:\n    CommandLine: '*.dat,#1'\n    Image: '*\\rundll32.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "NotPetya Ransomware Activity", "detection_rule_author": "Florian Roth, Tom Ueltschi", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8328114036544177764}}
{"date_created": "2018-03-13T00:00:00", "date_modified": "2012-12-11T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "3ede524d-21cc-472d-a3ce-d21b568d8db7", "technique": ["T1035: Service Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    ProcessCommandLine: C:\\Windows\\PSEXESVC.exe\n", "detection_rule_title": "PsExec Service Start", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5289273817798803588}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": "2012-12-11T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "61ab5496-748e-4818-a92f-de78e20fe7f1", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection | count() by MachineName > 5\n  selection:\n    CommandLine:\n    - arp.exe\n    - at.exe\n    - attrib.exe\n    - cscript.exe\n    - dsquery.exe\n    - hostname.exe\n    - ipconfig.exe\n    - mimikatz.exe\n    - nbtstat.exe\n    - net.exe\n    - netsh.exe\n    - nslookup.exe\n    - ping.exe\n    - quser.exe\n    - qwinsta.exe\n    - reg.exe\n    - runas.exe\n    - sc.exe\n    - schtasks.exe\n    - ssh.exe\n    - systeminfo.exe\n    - taskkill.exe\n    - telnet.exe\n    - tracert.exe\n    - wscript.exe\n    - xcopy.exe\n    - pscp.exe\n    - copy.exe\n    - robocopy.exe\n    - certutil.exe\n    - vssadmin.exe\n    - powershell.exe\n    - wevtutil.exe\n    - psexec.exe\n    - bcedit.exe\n    - wbadmin.exe\n    - icacls.exe\n    - diskpart.exe\n  timeframe: 5m\n", "detection_rule_title": "Quick Execution of a Series of Suspicious Commands", "detection_rule_author": "juju4", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5671705810468110398}}
{"date_created": "2019-02-06T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "0a4f6091-223b-41f6-8743-f322ec84930b", "technique": ["T1073: DLL Side-Loading"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image:\n    - C:\\Users\\\\*\\AppData\\Local\\Notepad++\\updater\\gup.exe\n    - C:\\Users\\\\*\\AppData\\Roaming\\Notepad++\\updater\\gup.exe\n    - C:\\Program Files\\Notepad++\\updater\\gup.exe\n    - C:\\Program Files (x86)\\Notepad++\\updater\\gup.exe\n  selection:\n    Image: '*\\GUP.exe'\n", "detection_rule_title": "Suspicious GUP Usage", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3533349495900279706}}
{"date_created": "2019-10-12T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "2158f96f-43c2-43cb-952a-ab4580f32382", "technique": ["T1218: Signed Binary Proxy Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: /start\n    Image|endswith: \\Psr.exe\n", "detection_rule_title": "psr.exe capture screenshots", "detection_rule_author": "Beyu Denis, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 254490676963712854}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": "2019-11-01T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "5f0f47a5-cb16-4dbe-9e31-e8d976d73de3", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '* sekurlsa:*'\n    - net localgroup administrators * /add\n    - net group \"Domain Admins\" * /ADD /DOMAIN\n    - certutil.exe *-urlcache* http*\n    - certutil.exe *-urlcache* ftp*\n    - netsh advfirewall firewall *\\AppData\\\\*\n    - attrib +S +H +R *\\AppData\\\\*\n    - schtasks* /create *\\AppData\\\\*\n    - schtasks* /sc minute*\n    - '*\\Regasm.exe *\\AppData\\\\*'\n    - '*\\Regasm *\\AppData\\\\*'\n    - '*\\bitsadmin* /transfer*'\n    - '*\\certutil.exe * -decode *'\n    - '*\\certutil.exe * -decodehex *'\n    - '*\\certutil.exe -ping *'\n    - icacls * /grant Everyone:F /T /C /Q\n    - '* wbadmin.exe delete catalog -quiet*'\n    - '*\\wscript.exe *.jse'\n    - '*\\wscript.exe *.js'\n    - '*\\wscript.exe *.vba'\n    - '*\\wscript.exe *.vbe'\n    - '*\\cscript.exe *.jse'\n    - '*\\cscript.exe *.js'\n    - '*\\cscript.exe *.vba'\n    - '*\\cscript.exe *.vbe'\n    - '*\\fodhelper.exe'\n    - '*waitfor*/s*'\n    - '*waitfor*/si persist*'\n    - '*remote*/s*'\n    - '*remote*/c*'\n    - '*remote*/q*'\n    - '*AddInProcess*'\n    - '* /stext *'\n    - '* /scomma *'\n    - '* /stab *'\n    - '* /stabular *'\n    - '* /shtml *'\n    - '* /sverhtml *'\n    - '* /sxml *'\n", "detection_rule_title": "Suspicious Process Creation", "detection_rule_author": "Florian Roth, Daniil Yugoslavskiy, oscd.community (update)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -515197957438627474}}
{"date_created": "2019-10-02T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "bd70d3f8-e60e-4d25-89f0-0b5a9cff20e0", "technique": ["T1117: Regsvr32"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*\\regsvr32*\\AppData\\Local\\\\*'\n    - '*\\AppData\\Local\\\\*,DllEntry*'\n", "detection_rule_title": "BlueMashroom DLL Load", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2297041669973566759}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "517490a7-115a-48c6-8862-1a481504d5a8", "technique": ["T1138: Application Shimming"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*.sdb*'\n    Image:\n    - '*\\sdbinst.exe'\n", "detection_rule_title": "Possible Shim Database Persistence via sdbinst.exe", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2023794074533835182}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "05a2ab7e-ce11-4b63-86db-ab32e763e11d", "technique": ["T1175: Distributed Component Object Model"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - '*\\cmd.exe'\n    - '*\\powershell.exe'\n    - '*\\wscript.exe'\n    - '*\\cscript.exe'\n    - '*\\sh.exe'\n    - '*\\bash.exe'\n    - '*\\reg.exe'\n    - '*\\regsvr32.exe'\n    - '*\\BITSADMIN*'\n    ParentImage: '*\\mmc.exe'\nfields:\n- CommandLine\n- Image\n- ParentCommandLine\n", "detection_rule_title": "MMC Spawning Windows Shell", "detection_rule_author": "Karneades, Swisscom CSIRT", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4333194773305754072}}
{"date_created": "2017-08-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "01d2e2a1-5f09-44f7-9fc1-24faa7479b6d", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection and not filter and not filter_null\n  filter:\n    ParentImage:\n    - '*\\services.exe'\n    - '*\\MsMpEng.exe'\n    - '*\\Mrt.exe'\n    - '*\\rpcnet.exe'\n    - '*\\svchost.exe'\n  filter_null:\n    ParentImage: null\n  selection:\n    Image: '*\\svchost.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious Svchost Process", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4398748467437950156}}
{"date_created": "2019-01-29T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0011: Command and Control"], "dr_id": "cd5cfd80-aa5f-44c0-9c20-108c4ae12e3c", "technique": ["T1090: Connection Proxy"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*netsh firewall add*'\n", "detection_rule_title": "Netsh", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4787424898050941901}}
{"date_created": "2019-10-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0040: Impact"], "dr_id": "c947b146-0abc-4c87-9c64-b17e9d7274a2", "technique": ["T1070: Indicator Removal on Host", "T1490: Inhibit System Recovery"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - shadow\n    - delete\n    NewProcessName|endswith:\n    - \\powershell.exe\n    - \\wmic.exe\n    - \\vssadmin.exe\n", "detection_rule_title": "Shadow copies deletion using operating systems utilities", "detection_rule_author": "Florian Roth, Michael Haag, Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6998425995839624228}}
{"date_created": "2019-10-23T00:00:00", "date_modified": "2019-11-07T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "4d7cda18-1b12-4e52-b45c-d28653210df8", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - unload\n    - sys\n    Image|endswith: \\fltmc.exe\nfields:\n- CommandLine\n- Details\n", "detection_rule_title": "Sysmon driver unload", "detection_rule_author": "Kirill Kiryanov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3429703867601081534}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "7f741dcf-fc22-4759-87b4-9ae8376676a2", "technique": ["T1088: Bypass User Account Control"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    ParentImage|endswith: \\fodhelper.exe\n", "detection_rule_title": "Bypass UAC via Fodhelper.exe", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Tony Lambert), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -904126180135363098}}
{"date_created": "2019-10-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0010: Exfiltration"], "dr_id": "99793437-3e16-439b-be0f-078782cf953d", "technique": ["T1048: Exfiltration Over Alternative Protocol"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image|endswith: \\tapinstall.exe\n", "detection_rule_title": "Tap installer execution", "detection_rule_author": "Daniil Yugoslavskiy, Ian Davis, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2453008409844132949}}
{"date_created": "2019-09-06T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0004: Privilege Escalation"], "dr_id": "ae215552-081e-44c7-805f-be16f975c8a2", "technique": ["T1015: Accessibility Features"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*\\CurrentVersion\\Image File Execution Options\\sethc.exe*'\n    - '*\\CurrentVersion\\Image File Execution Options\\utilman.exe*'\n    - '*\\CurrentVersion\\Image File Execution Options\\osk.exe*'\n    - '*\\CurrentVersion\\Image File Execution Options\\magnify.exe*'\n    - '*\\CurrentVersion\\Image File Execution Options\\narrator.exe*'\n    - '*\\CurrentVersion\\Image File Execution Options\\displayswitch.exe*'\n", "detection_rule_title": "Suspicious Debugger Registration Cmdline", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4947929414966857363}}
{"date_created": "2018-09-03T00:00:00", "date_modified": "2019-12-16T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "ca2092a1-c273-4878-9b4b-0d60115bf5ea", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection and not falsepositive1\n  falsepositive1:\n    CommandLine: '* -ExecutionPolicy remotesigned *'\n  selection:\n    CommandLine:\n    - '* -e JAB*'\n    - '* -e  JAB*'\n    - '* -e   JAB*'\n    - '* -e    JAB*'\n    - '* -e     JAB*'\n    - '* -e      JAB*'\n    - '* -en JAB*'\n    - '* -enc JAB*'\n    - '* -enc* JAB*'\n    - '* -w hidden -e* JAB*'\n    - '* BA^J e-'\n    - '* -e SUVYI*'\n    - '* -e aWV4I*'\n    - '* -e SQBFAFgA*'\n    - '* -e aQBlAHgA*'\n    - '* -enc SUVYI*'\n    - '* -enc aWV4I*'\n    - '* -enc SQBFAFgA*'\n    - '* -enc aQBlAHgA*'\n", "detection_rule_title": "Suspicious Encoded PowerShell Command Line", "detection_rule_author": "Florian Roth, Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -136894347403705286}}
{"date_created": "2019-10-01T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0001: Initial Access"], "dr_id": "a018fdc3-46a3-44e5-9afb-2cd4af1d4b39", "technique": ["T1193: Spearphishing Attachment"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: '*\\Temporary Internet Files\\Content.Outlook\\\\*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Execution in Outlook Temp Folder", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1112393515696992838}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "f26c6093-6f14-4b12-800f-0fcb46f5ffd0", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: encoded and selection\n  encoded:\n    CommandLine: '* hidden *'\n    Image: '*\\powershell.exe'\n  selection:\n    CommandLine:\n    - '*AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA*'\n    - '*aXRzYWRtaW4gL3RyYW5zZmVy*'\n    - '*IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA*'\n    - '*JpdHNhZG1pbiAvdHJhbnNmZX*'\n    - '*YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg*'\n    - '*Yml0c2FkbWluIC90cmFuc2Zlc*'\n    - '*AGMAaAB1AG4AawBfAHMAaQB6AGUA*'\n    - '*JABjAGgAdQBuAGsAXwBzAGkAegBlA*'\n    - '*JGNodW5rX3Npem*'\n    - '*QAYwBoAHUAbgBrAF8AcwBpAHoAZQ*'\n    - '*RjaHVua19zaXpl*'\n    - '*Y2h1bmtfc2l6Z*'\n    - '*AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A*'\n    - '*kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg*'\n    - '*lPLkNvbXByZXNzaW9u*'\n    - '*SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA*'\n    - '*SU8uQ29tcHJlc3Npb2*'\n    - '*Ty5Db21wcmVzc2lvb*'\n    - '*AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ*'\n    - '*kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA*'\n    - '*lPLk1lbW9yeVN0cmVhb*'\n    - '*SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A*'\n    - '*SU8uTWVtb3J5U3RyZWFt*'\n    - '*Ty5NZW1vcnlTdHJlYW*'\n    - '*4ARwBlAHQAQwBoAHUAbgBrA*'\n    - '*5HZXRDaHVua*'\n    - '*AEcAZQB0AEMAaAB1AG4Aaw*'\n    - '*LgBHAGUAdABDAGgAdQBuAGsA*'\n    - '*LkdldENodW5r*'\n    - '*R2V0Q2h1bm*'\n    - '*AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A*'\n    - '*QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA*'\n    - '*RIUkVBRF9JTkZPNj*'\n    - '*SFJFQURfSU5GTzY0*'\n    - '*VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA*'\n    - '*VEhSRUFEX0lORk82N*'\n    - '*AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA*'\n    - '*cmVhdGVSZW1vdGVUaHJlYW*'\n    - '*MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA*'\n    - '*NyZWF0ZVJlbW90ZVRocmVhZ*'\n    - '*Q3JlYXRlUmVtb3RlVGhyZWFk*'\n    - '*QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA*'\n    - '*0AZQBtAG0AbwB2AGUA*'\n    - '*1lbW1vdm*'\n    - '*AGUAbQBtAG8AdgBlA*'\n    - '*bQBlAG0AbQBvAHYAZQ*'\n    - '*bWVtbW92Z*'\n    - '*ZW1tb3Zl*'\n", "detection_rule_title": "Malicious Base64 encoded PowerShell Keywords in command lines", "detection_rule_author": "John Lambert (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -604794895175251136}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "41d40bff-377a-43e2-8e1b-2e543069e079", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: 1 of them\n  selection1:\n    Image:\n    - '*\\tasksche.exe'\n    - '*\\mssecsvc.exe'\n    - '*\\taskdl.exe'\n    - '*\\@WanaDecryptor@*'\n    - '*\\WanaDecryptor*'\n    - '*\\taskhsvc.exe'\n    - '*\\taskse.exe'\n    - '*\\111.exe'\n    - '*\\lhdfrgui.exe'\n    - '*\\diskpart.exe'\n    - '*\\linuxnew.exe'\n    - '*\\wannacry.exe'\n  selection2:\n    CommandLine:\n    - '*icacls * /grant Everyone:F /T /C /Q*'\n    - '*bcdedit /set {default} recoveryenabled no*'\n    - '*wbadmin delete catalog -quiet*'\n    - '*@Please_Read_Me@.txt*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "WannaCry Ransomware", "detection_rule_author": "Florian Roth (rule), Tom U. @c_APT_ure (collection)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7124767308700836712}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "3b6ab547-8ec2-4991-b9d2-2b06702a48d7", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*new-object system.net.webclient).downloadstring(*'\n    - '*new-object system.net.webclient).downloadfile(*'\n    - '*new-object net.webclient).downloadstring(*'\n    - '*new-object net.webclient).downloadfile(*'\n    Image: '*\\powershell.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "PowerShell Download from URL", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5925841009178045677}}
{"date_created": "2019-10-26T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "60f16a96-db70-42eb-8f76-16763e333590", "technique": ["T1218: Signed Binary Proxy Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - -c\n    - .exe\n    Image|endswith: \\dxcap.exe\n", "detection_rule_title": "Application Whitelisting bypass via dxcap.exe", "detection_rule_author": "Beyu Denis, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1445175643056009958}}
{"date_created": "2019-10-12T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "cec8e918-30f7-4e2d-9bfa-a59cc97ae60f", "technique": ["T1218: Signed Binary Proxy Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: /c\n    Image|endswith: \\OpenWith.exe\n", "detection_rule_title": "OpenWith.exe executes specified binary", "detection_rule_author": "Beyu Denis, oscd.community (rule), @harr0ey (idea)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8502459932083292668}}
{"date_created": "2019-10-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "fd877b94-9bb5-4191-bb25-d79cbd93c167", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection_1 and selection_2 and selection_3\n  selection_1:\n    CommandLine|contains:\n    - save\n    - export\n    NewProcessName: '*\\reg.exe'\n  selection_2:\n    CommandLine|contains:\n    - hklm\n    - hkey_local_machine\n  selection_3:\n    CommandLine|endswith:\n    - \\system\n    - \\sam\n    - \\security\n", "detection_rule_title": "Grabbing sensitive hives via reg utility", "detection_rule_author": "Teymur Kheirkhabarov, Endgame, JHasenbusch, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -518078521740560408}}
{"date_created": "2018-11-14T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "1eeed653-dbc8-4187-ad0c-eeebb20e6599", "technique": ["T1208: Kerberoasting"], "raw_detection_rule": "detection:\n  cmd:\n    CommandLine: '*-q*'\n  condition: (selection_image or selection_desc) and cmd\n  selection_desc:\n    Description: '*Query or reset the computer* SPN attribute*'\n  selection_image:\n    Image: '*\\setspn.exe'\n", "detection_rule_title": "Possible SPN Enumeration", "detection_rule_author": "Markus Neis, keepwatch", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1817476257786529305}}
{"date_created": "2018-10-30T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "62510e69-616b-4078-b371-847da438cc03", "technique": ["T1018: Remote System Discovery"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    CommandLine|contains: \\\\\n  selection:\n    CommandLine|contains: view\n    Image|endswith:\n    - \\net.exe\n    - \\net1.exe\n", "detection_rule_title": "Windows Network Enumeration", "detection_rule_author": "Endgame, JHasenbusch (ported for oscd.community)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7288225228726527383}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0040: Impact"], "dr_id": "1444443e-6757-43e4-9ea4-c8fc705f79a2", "technique": ["T1490: Inhibit System Recovery"], "raw_detection_rule": "detection:\n  condition: selection1 and selection2\n  selection1:\n    CommandLine: set\n    Image|endswith: \\bcdedit.exe\n  selection2:\n  - CommandLine|contains|all:\n    - bootstatuspolicy\n    - ignoreallfailures\n  - CommandLine|contains|all:\n    - recoveryenabled\n    - 'no'\n", "detection_rule_title": "Modification of Boot Configuration", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5758624444657793289}}
{"date_created": "2019-10-30T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "f1531fa4-5b84-4342-8f68-9cf3fdbd83d4", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine: '* echo EEEE > *'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "DTRACK Process Creation", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3091954268639009711}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "8f88e3f6-2a49-48f5-a5c4-2f7eedf78710", "technique": ["T1046: Network Service Scanning"], "raw_detection_rule": "detection:\n  condition: selection and not exclusion\n  exclusion:\n  - CommandLine: '*address=127.0.0.1*'\n  - CommandLine: '*address=localhost*'\n  selection:\n    CommandLine: '*transport=dt_socket,address=*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Java Running with Remote Debugging", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3401247452888756282}}
{"date_created": "2019-08-15T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "d21374ff-f574-44a7-9998-4a8c8bf33d7d", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    LogonId: '0x3e7'\n  selection:\n    ParentImage|endswith: \\WmiPrvSe.exe\n", "detection_rule_title": "T1047 Wmiprvse Spawning Process", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6037203769083233149}}
{"date_created": "2019-01-10T00:00:00", "date_modified": null, "customer": ["TESTCUSTOMER"], "tactic": ["TA0005: Defense Evasion", "TA0004: Privilege Escalation"], "dr_id": "e6eb5a96-9e6f-4a18-9cdd-642cfda21c8e", "technique": ["T1055: Process Injection"], "raw_detection_rule": "detection:\n  condition: 1 of them\n  selection1:\n    CommandLine: '*\\svchost.exe C:\\Users\\\\*\\Desktop\\\\*'\n  selection2:\n    CommandLine:\n    - '*whoami.exe /all'\n    - '*net.exe view'\n    ParentImage: '*\\svchost.exe*'\n", "detection_rule_title": "Dridex Process Pattern", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1460392921018013981}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["TESTCUSTOMER"], "tactic": ["TA0005: Defense Evasion", "TA0003: Persistence"], "dr_id": "4281cb20-2994-4580-aa63-c8b86d019934", "technique": ["T1158: Hidden Files and Directories"], "raw_detection_rule": "detection:\n  condition: selection and not (ini or intel)\n  ini:\n    CommandLine: '*\\desktop.ini *'\n  intel:\n    CommandLine: +R +H +S +A \\\\*.cui\n    ParentCommandLine: C:\\WINDOWS\\system32\\\\*.bat\n    ParentImage: '*\\cmd.exe'\n  selection:\n    CommandLine: '* +h *'\n    Image: '*\\attrib.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n- User\n", "detection_rule_title": "Hiding files with attrib.exe", "detection_rule_author": "Sami Ruohonen", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8828753390361487053}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "82a19e3a-2bfe-4a91-8c0d-5d4c98fbb719", "technique": ["T1118: InstallUtil", "T1121: Regsvcs/Regasm", "T1127: Trusted Developer Utilities", "T1170: Mshta"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - \\msdt.exe\n    - \\installutil.exe\n    - \\regsvcs.exe\n    - \\regasm.exe\n    - \\msbuild.exe\n    - \\ieexec.exe\n", "detection_rule_title": "Possible Applocker Bypass", "detection_rule_author": "juju4", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2405198016366628360}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0009: Collection"], "dr_id": "932fb0d8-692b-4b0f-a26e-5643a50fe7d6", "technique": ["T1123: Audio Capture"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: WindowsAudioDevice-Powershell-Cmdlet\n", "detection_rule_title": "Audio Capture via PowerShell", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5291885801104540418}}
{"date_created": "2019-10-23T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery", "TA0004: Privilege Escalation"], "dr_id": "80167ada-7a12-41ed-b8e9-aa47195c66a1", "technique": ["T1033: System Owner/User Discovery"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image|endswith: \\whoami.exe\n    User: NT AUTHORITY\\SYSTEM\n", "detection_rule_title": "Run whoami as SYSTEM", "detection_rule_author": "Teymur Kheirkhabarov", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7506685467318759009}}
{"date_created": "2019-06-15T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "36480ae1-a1cb-4eaa-a0d6-29801d7e9142", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\cmd.exe\n    - \\powershell.exe\n    - \\powershell_ise.exe\n    - \\psexec.exe\n    - \\psexec64.exe\n    - \\cscript.exe\n    - \\wscript.exe\n    - \\mshta.exe\n    - \\regsvr32.exe\n    - \\wmic.exe\n    - \\certutil.exe\n    - \\rundll32.exe\n    - \\cmstp.exe\n    - \\msiexec.exe\n    - \\7z.exe\n    - \\winrar.exe\n    - \\wevtutil.exe\n    - \\net.exe\n    - \\net1.exe\n  selection:\n    OriginalFileName:\n    - cmd.exe\n    - powershell.exe\n    - powershell_ise.exe\n    - psexec.exe\n    - psexec.c\n    - cscript.exe\n    - wscript.exe\n    - mshta.exe\n    - regsvr32.exe\n    - wmic.exe\n    - certutil.exe\n    - rundll32.exe\n    - cmstp.exe\n    - msiexec.exe\n    - 7z.exe\n    - winrar.exe\n    - wevtutil.exe\n    - net.exe\n    - net1.exe\n", "detection_rule_title": "Renamed Binary", "detection_rule_author": "Matthew Green - @mgreen27, Ecco, James Pemberton / @4A616D6573, oscd.community (improvements)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6202998262407952123}}
{"date_created": "2019-10-26T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0011: Command and Control"], "dr_id": "0c79148b-118e-472b-bdb7-9b57b444cc19", "technique": ["T1105: Remote File Copy"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: http\n    Image|endswith:\n    - \\powerpnt.exe\n    - \\winword.exe\n    - \\excel.exe\n", "detection_rule_title": "Malicious payload download via Office binaries", "detection_rule_author": "Beyu Denis, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5052950379276112937}}
{"date_created": "2018-02-09T00:00:00", "date_modified": "2012-12-11T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "f7b5f842-a6af-4da5-9e95-e32478f3cd2f", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '* msiexec*://*'\n", "detection_rule_title": "MsiExec Web Install", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1410778050787138113}}
{"date_created": "2019-11-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0004: Privilege Escalation"], "dr_id": "1c373b6d-76ce-4553-997d-8c1da9a6b5f5", "technique": ["T1055: Process Injection"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image:\n    - C:\\Windows\\System32\\\\*\n    - C:\\Windows\\SysWOW64\\\\*\n    - C:\\Windows\\WinSxS\\\\*\n    - C:\\Windows\\Setup\\\\*\n  selection:\n    ParentCommandLine:\n    - '*\\cmd.exe /c C:\\Windows\\Setup\\Scripts\\SetupComplete.cmd'\n    - '*\\cmd.exe /c C:\\Windows\\Setup\\Scripts\\PartnerSetupComplete.cmd'\n", "detection_rule_title": "Exploiting SetupComplete.cmd CVE-2019-1378", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6774314542508023840}}
{"date_created": "2019-10-26T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "81ebd28b-9607-4478-bf06-974ed9d53ed7", "technique": ["T1218: Signed Binary Proxy Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image|endswith: \\dnx.exe\n", "detection_rule_title": "Application Whitelisting bypass via dnx.exe", "detection_rule_author": "Beyu Denis, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8048853480259080467}}
{"date_created": "2019-04-02T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0005: Defense Evasion"], "dr_id": "aa3a6f94-890e-4e22-b634-ffdfd54792cc", "technique": ["T1059: Command-Line Interface", "T1202: Indirect Command Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - C:\\users\\\\*.exe\n    ParentImage:\n    - '*\\WINWORD.EXE'\n    - '*\\EXCEL.EXE'\n    - '*\\POWERPNT.exe'\n    - '*\\MSPUB.exe'\n    - '*\\VISIO.exe'\n    - '*\\OUTLOOK.EXE'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "MS Office Product Spawning Exe in User Dir", "detection_rule_author": "Jason Lynch", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4127837761569800602}}
{"date_created": "2018-06-22T00:00:00", "date_modified": "2018-12-11T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*\\sysprep.exe *\\AppData\\\\*'\n    - sysprep.exe *\\AppData\\\\*\n", "detection_rule_title": "Sysprep on AppData Folder", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -588558923780576975}}
{"date_created": "2019-06-17T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "b655a06a-31c0-477a-95c2-3726b83d649d", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter1 and not filter2\n  filter1:\n    CommandLine: '*\\\\netlogon\\\\*'\n  filter2:\n    Image: '*\\explorer.exe'\n  selection:\n    ParentImage: '*\\userinit.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious Userinit Child Process", "detection_rule_author": "Florian Roth (rule), Samir Bousseaden (idea)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8339040449020535696}}
{"date_created": "2019-10-26T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "aaf46cdc-934e-4284-b329-34aa701e3771", "technique": ["T1218: Signed Binary Proxy Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - /popup\n    - /nolicprompt\n    Image|endswith: \\bginfo.exe\n", "detection_rule_title": "Application whitelisting bypass via bginfo", "detection_rule_author": "Beyu Denis, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5335673629553339714}}
{"date_created": "2019-02-11T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "b730a276-6b63-41b8-bcf8-55930c8fc6ee", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: '*\\csc.exe*'\n    ParentImage:\n    - '*\\wscript.exe'\n    - '*\\cscript.exe'\n    - '*\\mshta.exe'\n", "detection_rule_title": "Suspicious Parent of Csc.exe", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4043129286008529732}}
{"date_created": "2019-05-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation", "TA0002: Execution"], "dr_id": "931b6802-d6a6-4267-9ffa-526f57f22aaf", "technique": ["T1053: Scheduled Task"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine: '*/change*/TN*/RU*/RP*'\n    Image: schtasks.exe\n", "detection_rule_title": "Windows 10 scheduled task SandboxEscaper 0-day", "detection_rule_author": "Olaf Hartong", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 9115593326904258557}}
{"date_created": "2019-04-20T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "79f4ede3-402e-41c8-bc3e-ebbf5f162581", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '* -NoP -sta -NonI -W Hidden -Enc *'\n    - '* -noP -sta -w 1 -enc *'\n    - '* -NoP -NonI -W Hidden -enc *'\n", "detection_rule_title": "Empire PowerShell Launch Parameters", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5550354359069385840}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0010: Exfiltration"], "dr_id": "6f3e2987-db24-4c78-a860-b4f4095a7095", "technique": ["T1002: Data Compressed"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: ' a '\n    Image|endswith: \\rar.exe\nfields:\n- Image\n- CommandLine\n- User\n- LogonGuid\n- Hashes\n- ParentProcessGuid\n- ParentCommandLine\n", "detection_rule_title": "Data Compressed - rar.exe", "detection_rule_author": "Timur Zinniatullin, E.M. Anhaus, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3097353402530466343}}
{"date_created": "2018-12-27T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "e212d415-0e93-435f-9e1a-f29005bb4723", "technique": ["T1059: Command-Line Interface", "T1202: Indirect Command Execution"], "raw_detection_rule": "detection:\n  clientMailRules:\n    CommandLine: '*EnableUnsafeClientMailRules*'\n  condition: clientMailRules or outlookExec\n  outlookExec:\n    CommandLine: \\\\\\\\*\\\\*.exe\n    ParentImage: '*\\outlook.exe'\n", "detection_rule_title": "Suspicious Execution from Outlook", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2739368255715458294}}
{"date_created": "2019-09-30T00:00:00", "date_modified": "2019-10-16T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "d02e8cf5-6099-48cf-9bfc-1eec2d0c7b18", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '* -e* PAA*'\n    - '*JABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQ*'\n    - '*QAZQBuAHYAOgB1AHMAZQByAHAAcgBvAGYAaQBsAGUA*'\n    - '*kAGUAbgB2ADoAdQBzAGUAcgBwAHIAbwBmAGkAbABlA*'\n    - '*IgAoACcAKgAnACkAOwAkA*'\n    - '*IAKAAnACoAJwApADsAJA*'\n    - '*iACgAJwAqACcAKQA7ACQA*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Emotet Process Creation", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7273715410790269349}}
{"date_created": "2019-08-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0005: Defense Evasion"], "dr_id": "fdb62a13-9a81-4e5c-a38f-ea93a16f6d7c", "technique": ["T1086: PowerShell", "T1140: Deobfuscate/Decode Files or Information"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|base64offset|contains: ::FromBase64String\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Encoded FromBase64String", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 448310091207376350}}
{"date_created": "2019-04-03T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0005: Defense Evasion"], "dr_id": "692f0bec-83ba-4d04-af7e-e884a96059b6", "technique": ["T1064: Scripting"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - '*\\powershell.exe'\n    ParentImage:\n    - '*\\wmiprvse.exe'\n", "detection_rule_title": "WMI Spawning Windows PowerShell", "detection_rule_author": "Markus Neis / @Karneades", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5792234944282021619}}
{"date_created": "2017-04-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "d7eb979b-c2b5-4a6f-a3a7-c87ce6763819", "technique": ["T1073: DLL Side-Loading", "T1085: Rundll32"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    CommandLine: '*Shell32.dll*'\n  selection:\n    CommandLine: '*\\rundll32.exe *'\n    ParentImage: '*\\System32\\control.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious Control Panel DLL Load", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7830214289855574307}}
{"date_created": "2018-03-06T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0003: Persistence", "TA0004: Privilege Escalation"], "dr_id": "56c217c3-2de2-479b-990f-5c109ba8458f", "technique": ["T1053: Scheduled Task", "T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*schtasks*/Create*/SC *ONLOGON*/TN *Updater*/TR *powershell*'\n    - '*schtasks*/Create*/SC *DAILY*/TN *Updater*/TR *powershell*'\n    - '*schtasks*/Create*/SC *ONIDLE*/TN *Updater*/TR *powershell*'\n    - '*schtasks*/Create*/SC *Updater*/TN *Updater*/TR *powershell*'\n    ParentImage:\n    - '*\\powershell.exe'\n", "detection_rule_title": "Default PowerSploit and Empire Schtasks Persistence", "detection_rule_author": "Markus Neis, @Karneades", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 877647975944432220}}
{"date_created": "2018-04-09T00:00:00", "date_modified": "2018-12-11T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "05f3c945-dcc8-4393-9f3d-af65077a8f86", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine: '*\\SYSVOL\\\\*\\policies\\\\*'\n", "detection_rule_title": "Suspicious SYSVOL Domain Group Policy Access", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5710607445961006151}}
{"date_created": "2018-02-22T00:00:00", "date_modified": null, "customer": ["TESTCUSTOMER"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "7993792c-5ce2-4475-a3db-a3a5539827ef", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: '*\\MicroScMgmt.exe '\n    ParentImage: '*\\WINWORD.EXE'\n", "detection_rule_title": "Exploit for CVE-2015-1641", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3154410553770974170}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access", "TA0007: Discovery"], "dr_id": "ba1f7802-adc7-48b4-9ecb-81e227fddfd5", "technique": ["T1040: Network Sniffing"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - CommandLine|contains: -i\n    Image|endswith: \\tshark.exe\n  - Image|endswith: \\windump.exe\nfields:\n- Image\n- CommandLine\n- User\n- LogonGuid\n- Hashes\n- ParentProcessGuid\n- ParentCommandLine\n", "detection_rule_title": "Network Sniffing", "detection_rule_author": "Timur Zinniatullin, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6171454733471012262}}
{"date_created": "2017-03-09T00:00:00", "date_modified": "2019-12-06T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0003: Persistence"], "dr_id": "d059842b-6b9d-4ed1-b5c3-5b89143c6ede", "technique": ["T1197: BITS Jobs"], "raw_detection_rule": "detection:\n  condition: selection1 or selection2\n  selection1:\n    CommandLine:\n    - '* /transfer *'\n    Image:\n    - '*\\bitsadmin.exe'\n  selection2:\n    CommandLine:\n    - '*copy bitsadmin.exe*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Bitsadmin Download", "detection_rule_author": "Michael Haag", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8754474349038198472}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "05c36dd6-79d6-4a9a-97da-3db20298ab2d", "technique": ["T1220: XSL Script Processing"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - CommandLine|contains: /format\n    Image|endswith: \\wmic.exe\n  - Image|endswith: \\msxsl.exe\n", "detection_rule_title": "XSL Script Processing", "detection_rule_author": "Timur Zinniatullin, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2384970312832720475}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["TESTCUSTOMER2", "TESTCUSTOMER"], "tactic": ["TA0006: Credential Access"], "dr_id": "07f8bdc2-c9b3-472a-9817-5a670b872f53", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine: '* /list *'\n    Image: '*\\cmdkey.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n- User\n", "detection_rule_title": "Cmdkey Cached Credentials Recon", "detection_rule_author": "jmallette", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -9038984731285010298}}
{"date_created": "2019-05-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "1012f107-b8f1-4271-af30-5aed2de89b39", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image: '*\\rdpclip.exe'\n  selection:\n    ParentCommandLine: '*\\svchost.exe*termsvcs'\n", "detection_rule_title": "Terminal Service Process Spawn", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2436759269910066706}}
{"date_created": "2019-09-02T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "09e6d5c0-05b8-4ff8-9eeb-043046ec774c", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: (rundll_image or rundll_ofn) and selection\n  rundll_image:\n    Image: '*\\rundll32.exe'\n  rundll_ofn:\n    OriginalFileName: RUNDLL32.EXE\n  selection:\n    CommandLine:\n    - '*comsvcs*MiniDump*full*'\n    - '*comsvcs*MiniDumpW*full*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Process dump via comsvcs DLL", "detection_rule_author": "Modexp (idea)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3777289872348737329}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "36210e0d-5b19-485d-a087-c096088885f0", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - ' -windowstyle h '\n    - ' -windowstyl h'\n    - ' -windowsty h'\n    - ' -windowst h'\n    - ' -windows h'\n    - ' -windo h'\n    - ' -wind h'\n    - ' -win h'\n    - ' -wi h'\n    - ' -win h '\n    - ' -win hi '\n    - ' -win hid '\n    - ' -win hidd '\n    - ' -win hidde '\n    - ' -NoPr '\n    - ' -NoPro '\n    - ' -NoProf '\n    - ' -NoProfi '\n    - ' -NoProfil '\n    - ' -nonin '\n    - ' -nonint '\n    - ' -noninte '\n    - ' -noninter '\n    - ' -nonintera '\n    - ' -noninterac '\n    - ' -noninteract '\n    - ' -noninteracti '\n    - ' -noninteractiv '\n    - ' -ec '\n    - ' -encodedComman '\n    - ' -encodedComma '\n    - ' -encodedComm '\n    - ' -encodedCom '\n    - ' -encodedCo '\n    - ' -encodedC '\n    - ' -encoded '\n    - ' -encode '\n    - ' -encod '\n    - ' -enco '\n    - ' -en '\n    Image:\n    - '*\\Powershell.exe'\n", "detection_rule_title": "Suspicious PowerShell Parameter Substring", "detection_rule_author": "Florian Roth (rule), Daniel Bohannon (idea), Roberto Rodriguez (Fix)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8020242522118729683}}
{"date_created": "2018-08-13T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "e28a5a99-da44-436d-b7a0-2afc20a5f413", "technique": ["T1033: System Owner/User Discovery"], "raw_detection_rule": "detection:\n  condition: selection or selection2\n  selection:\n    Image: '*\\whoami.exe'\n  selection2:\n    OriginalFileName: whoami.exe\n", "detection_rule_title": "Whoami Execution", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4074218366023508765}}
{"date_created": "2018-10-30T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0003: Persistence"], "dr_id": "f67dbfce-93bc-440d-86ad-a95ae8858c90", "technique": ["T1197: BITS Jobs"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: Start-BitsTransfer\n    Image|endswith: \\powershell.exe\n", "detection_rule_title": "Suspicious Bitsadmin Job via PowerShell", "detection_rule_author": "Endgame, JHasenbusch (ported to sigma for oscd.community)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6507021212816740896}}
{"date_created": "2019-02-23T00:00:00", "date_modified": "2019-08-20T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "96036718-71cc-4027-a538-d1587e0006a7", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection and not filter and not filter_null\n  filter:\n    ParentImage:\n    - '*\\System32\\\\*'\n    - '*\\SysWOW64\\\\*'\n    - '*\\SavService.exe'\n    - '*\\Windows Defender\\\\*\\MsMpEng.exe'\n  filter_null:\n    ParentImage: null\n  selection:\n    Image:\n    - '*\\svchost.exe'\n    - '*\\taskhost.exe'\n    - '*\\lsm.exe'\n    - '*\\lsass.exe'\n    - '*\\services.exe'\n    - '*\\lsaiso.exe'\n    - '*\\csrss.exe'\n    - '*\\wininit.exe'\n    - '*\\winlogon.exe'\n", "detection_rule_title": "Windows Processes Suspicious Parent Directory", "detection_rule_author": "vburov", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7621221663625921727}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "15b75071-74cc-47e0-b4c6-b43744a62a2b", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - '*:\\RECYCLER\\\\*'\n    - '*:\\SystemVolumeInformation\\\\*'\n    - C:\\\\Windows\\\\Tasks\\\\*\n    - C:\\\\Windows\\\\debug\\\\*\n    - C:\\\\Windows\\\\fonts\\\\*\n    - C:\\\\Windows\\\\help\\\\*\n    - C:\\\\Windows\\\\drivers\\\\*\n    - C:\\\\Windows\\\\addins\\\\*\n    - C:\\\\Windows\\\\cursors\\\\*\n    - C:\\\\Windows\\\\system32\\tasks\\\\*\n", "detection_rule_title": "Suspicious Process Start Locations", "detection_rule_author": "juju4", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5001033006298552446}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "35efb964-e6a5-47ad-bbcd-19661854018d", "technique": ["T1100: Web Shell"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image:\n    - '*bin\\\\*'\n    - '*\\Tools\\\\*'\n    - '*\\SMSComponent\\\\*'\n    ParentImage:\n    - '*\\services.exe'\n  selection:\n    Image:\n    - '*\\wwwroot\\\\*'\n    - '*\\wmpub\\\\*'\n    - '*\\htdocs\\\\*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Execution in Webserver Root Folder", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7405442825660449801}}
{"date_created": "2019-09-12T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "f4bbd493-b796-416e-bbf2-121235348529", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    ParentImage|endswith: \\explorer.exe\n  selection:\n    Image|endswith: \\powershell.exe\n", "detection_rule_title": "T1086 Non Interactive PowerShell", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g (rule), oscd.community (improvements)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -9007373915999187712}}
{"date_created": "2019-01-09T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "ac175779-025a-4f12-98b0-acdaeb77ea85", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '* /c powershell*\\AppData\\Local\\\\*'\n    - '* /c powershell*\\AppData\\Roaming\\\\*'\n", "detection_rule_title": "PowerShell Script Run in AppData", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2495448805956018758}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0009: Collection"], "dr_id": "83865853-59aa-449e-9600-74b9d89a6d6e", "technique": ["T1123: Audio Capture"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: /FILE\n    Image|endswith: \\SoundRecorder.exe\n", "detection_rule_title": "Audio Capture via SoundRecorder", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3081605416964080045}}
{"date_created": "2019-09-26T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "add64136-62e5-48ea-807e-88638d02df1e", "technique": ["T1070: Indicator Removal on Host"], "raw_detection_rule": "detection:\n  binary_1:\n    Image|endswith: \\fsutil.exe\n  binary_2:\n    OriginalFileName: fsutil.exe\n  condition: (1 of binary_*) and selection\n  selection:\n    CommandLine|contains:\n    - deletejournal\n    - createjournal\n", "detection_rule_title": "Fsutil suspicious invocation", "detection_rule_author": "Ecco, E.M. Anhaus, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4225260200573989190}}
{"date_created": "2018-08-22T00:00:00", "date_modified": "2018-12-11T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "2887e914-ce96-435f-8105-593937e90757", "technique": ["T1087: Account Discovery", "T1082: System Information Discovery"], "raw_detection_rule": "detection:\n  condition: selection | count() by CommandLine > 4\n  selection:\n    CommandLine:\n    - tasklist\n    - net time\n    - systeminfo\n    - whoami\n    - nbtstat\n    - net start\n    - '*\\net1 start'\n    - qprocess\n    - nslookup\n    - hostname.exe\n    - '*\\net1 user /domain'\n    - '*\\net1 group /domain'\n    - '*\\net1 group \"domain admins\" /domain'\n    - '*\\net1 group \"Exchange Trusted Subsystem\" /domain'\n    - '*\\net1 accounts /domain'\n    - '*\\net1 user net localgroup administrators'\n    - netstat -an\n  timeframe: 15s\n", "detection_rule_title": "Reconnaissance Activity with Net Command", "detection_rule_author": "Florian Roth, Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8622643475447824690}}
{"date_created": "2019-10-25T00:00:00", "date_modified": "2019-10-25T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "56321594-9087-49d9-bf10-524fe8479452", "technique": ["T1060: Registry Run Keys / Startup Folder"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - add\n    - helper\n    Image|endswith: \\netsh.exe\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious netsh Dll persistence", "detection_rule_author": "Victor Sergeev, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "test", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1017503279165929658}}
{"date_created": "2019-10-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "40b19fa6-d835-400c-b301-41f3a2baacaf", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - mklink\n    - HarddiskVolumeShadowCopy\n", "detection_rule_title": "Shadow copies access via symlink", "detection_rule_author": "Teymur Kheirkhabarov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4692301246722859802}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0003: Persistence", "TA0004: Privilege Escalation"], "dr_id": "92626ddd-662c-49e3-ac59-f6535f12d189", "technique": ["T1053: Scheduled Task"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    User: NT AUTHORITY\\SYSTEM\n  selection:\n    CommandLine: '* /create *'\n    Image: '*\\schtasks.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Scheduled Task Creation", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1816382115602532226}}
{"date_created": "2017-01-01T00:00:00", "date_modified": "2019-10-26T00:00:00", "customer": ["None"], "tactic": ["TA0004: Privilege Escalation", "TA0003: Persistence"], "dr_id": "bed2a484-9348-4143-8a8a-b801c979301c", "technique": ["T1100: Web Shell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*whoami*'\n    - '*net user *'\n    - '*ping -n *'\n    - '*systeminfo'\n    - '*&cd&echo*'\n    - '*cd /d*'\n    ParentImage:\n    - '*\\apache*'\n    - '*\\tomcat*'\n    - '*\\w3wp.exe'\n    - '*\\php-cgi.exe'\n    - '*\\nginx.exe'\n    - '*\\httpd.exe'\nfields:\n- CommandLine\n- ParentCommandLine\nreference:\n- https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html\n", "detection_rule_title": "Webshell Detection With Command Line Keywords", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8479831189094012051}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "d797268e-28a9-49a7-b9a8-2f5039011c5c", "technique": ["T1088: Bypass User Account Control"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image|endswith: \\conhost.exe\n  selection:\n    ParentImage|endswith: \\wsreset.exe\n", "detection_rule_title": "Bypass UAC via WSReset.exe", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Tony Lambert), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7041013366072517408}}
{"date_created": "2019-01-29T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0011: Command and Control"], "dr_id": "322ed9ec-fcab-4f67-9a34-e7c6aef43614", "technique": ["T1090: Connection Proxy"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - netsh interface portproxy add v4tov4 *\n", "detection_rule_title": "Netsh Port Forwarding", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3979252887227832869}}
{"date_created": "2019-10-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0010: Exfiltration"], "dr_id": "98a96a5a-64a0-4c42-92c5-489da3866cb0", "technique": ["T1048: Exfiltration Over Alternative Protocol"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - Image|endswith: '*\\iodine.exe'\n  - Image|contains: \\dnscat2\n", "detection_rule_title": "DNS exfiltration tools execution", "detection_rule_author": "Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7468309227511592777}}
{"date_created": "2018-10-30T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0006: Credential Access"], "dr_id": "cd219ff3-fa99-45d4-8380-a7d15116c6dc", "technique": ["T1136: Create Account"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - user\n    - add\n    Image|endswith:\n    - \\net.exe\n    - \\net1.exe\n", "detection_rule_title": "Net.exe User Account Creation", "detection_rule_author": "Endgame, JHasenbusch (adapted to sigma for oscd.community)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7793471668230279991}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "2a072a96-a086-49fa-bcb5-15cc5a619093", "technique": ["T1035: Service Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: ' start '\n    Image|endswith:\n    - \\net.exe\n    - \\net1.exe\n", "detection_rule_title": "Service Execution", "detection_rule_author": "Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5294784002017745167}}
{"date_created": "2019-10-26T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "b5c7395f-e501-4a08-94d4-57fe7a9da9d2", "technique": ["T1218: Signed Binary Proxy Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: -cf\n    Image|endswith: \\cdb.exe\n", "detection_rule_title": "Possible Application Whitelisting Bypass via WinDbg/CDB as a shellcode runner", "detection_rule_author": "Beyu Denis, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 9049125119346479007}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "3d3aa6cd-6272-44d6-8afc-7e88dfef7061", "technique": ["T1042: Change Default File Association"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - cmd\n    - /c\n    - assoc\nfields:\n- Image\n- CommandLine\n- User\n- LogonGuid\n- Hashes\n- ParentProcessGuid\n- ParentCommandLine\n", "detection_rule_title": "Change Default File Association", "detection_rule_author": "Timur Zinniatullin, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3942374446840184971}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "cea72823-df4d-4567-950c-0b579eaf0846", "technique": ["T1064: Scripting"], "raw_detection_rule": "detection:\n  condition: selection and not falsepositive\n  falsepositive:\n    ParentImage: '*\\winzip*'\n  selection:\n    CommandLine:\n    - '* C:\\Users\\\\*.jse *'\n    - '* C:\\Users\\\\*.vbe *'\n    - '* C:\\Users\\\\*.js *'\n    - '* C:\\Users\\\\*.vba *'\n    - '* C:\\Users\\\\*.vbs *'\n    - '* C:\\ProgramData\\\\*.jse *'\n    - '* C:\\ProgramData\\\\*.vbe *'\n    - '* C:\\ProgramData\\\\*.js *'\n    - '* C:\\ProgramData\\\\*.vba *'\n    - '* C:\\ProgramData\\\\*.vbs *'\n    Image:\n    - '*\\wscript.exe'\n    - '*\\cscript.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "WScript or CScript Dropper", "detection_rule_author": "Margaritis Dimitrios (idea), Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8348269450276236981}}
{"date_created": "2019-02-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "e62a9f0c-ca1e-46b2-85d5-a6da77f86d1a", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - certutil -f -encode *\n    - certutil.exe -f -encode *\n    - certutil -encode -f *\n    - certutil.exe -encode -f *\n", "detection_rule_title": "Certutil Encode", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8957806151475148419}}
{"date_created": "2017-09-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "fdd84c68-a1f6-47c9-9477-920584f94905", "technique": ["T1203: Exploitation for Client Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: '*\\csc.exe'\n    ParentImage: '*\\WINWORD.EXE'\n", "detection_rule_title": "Exploit for CVE-2017-8759", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7150301605085852543}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "fa4b21c9-0057-4493-b289-2556416ae4d7", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*--processStart*.exe*'\n    - '*--processStartAndWait*.exe*'\n    - \"*\\u2013createShortcut*.exe*\"\n    Image:\n    - '*\\update.exe'\n", "detection_rule_title": "Squirrel Lolbin", "detection_rule_author": "Karneades / Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 9153587501501860865}}
{"date_created": "2018-04-06T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0005: Defense Evasion"], "dr_id": "438025f9-5856-4663-83f7-52f878a70a50", "technique": ["T1059: Command-Line Interface", "T1202: Indirect Command Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - '*\\cmd.exe'\n    - '*\\powershell.exe'\n    - '*\\wscript.exe'\n    - '*\\cscript.exe'\n    - '*\\sh.exe'\n    - '*\\bash.exe'\n    - '*\\scrcons.exe'\n    - '*\\schtasks.exe'\n    - '*\\regsvr32.exe'\n    - '*\\hh.exe'\n    - '*\\wmic.exe'\n    - '*\\mshta.exe'\n    - '*\\rundll32.exe'\n    - '*\\msiexec.exe'\n    - '*\\forfiles.exe'\n    - '*\\scriptrunner.exe'\n    - '*\\mftrace.exe'\n    - '*\\AppVLP.exe'\n    - '*\\svchost.exe'\n    ParentImage:\n    - '*\\WINWORD.EXE'\n    - '*\\EXCEL.EXE'\n    - '*\\POWERPNT.exe'\n    - '*\\MSPUB.exe'\n    - '*\\VISIO.exe'\n    - '*\\OUTLOOK.EXE'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Microsoft Office Product Spawning Windows Shell", "detection_rule_author": "Michael Haag, Florian Roth, Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7314349706017127815}}
{"date_created": "2018-11-17T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "2d117e49-e626-4c7c-bd1f-c3c0147774c8", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection1 and selection2\n  selection1:\n    CommandLine: '*AAAAYInlM*'\n  selection2:\n    CommandLine:\n    - '*OiCAAAAYInlM*'\n    - '*OiJAAAAYInlM*'\n", "detection_rule_title": "PowerShell Base64 Encoded Shellcode", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1588257241986581880}}
{"date_created": "2019-10-01T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "4fcac6eb-0287-4090-8eea-2602e4c20040", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection1 or selection2\n  selection1:\n    Image: '*\\wscript.exe'\n    ParentImage: '*\\WinRAR.exe'\n  selection2:\n    CommandLine: '* /c ping.exe -n 6 127.0.0.1 & type *'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "QBot Process Creation", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -9216681083034663176}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "502b42de-4306-40b4-9596-6f590c81f073", "technique": ["T1033: System Owner/User Discovery", "T1087: Account Discovery"], "raw_detection_rule": "detection:\n  condition: selection_1 or ( selection_2 and not filter )\n  filter:\n    CommandLine|contains:\n    - /domain\n    - /add\n    - /delete\n    - /active\n    - /expires\n    - /passwordreq\n    - /scriptpath\n    - /times\n    - /workstations\n  selection_1:\n  - Image|endswith: \\whoami.exe\n  - CommandLine|contains|all:\n    - useraccount\n    - get\n    Image|endswith: \\wmic.exe\n  - Image|endswith:\n    - \\quser.exe\n    - \\qwinsta.exe\n  - CommandLine|contains: /list\n    Image|endswith: \\cmdkey.exe\n  - CommandLine|contains|all:\n    - /c\n    - dir\n    - \\Users\\\n    Image|endswith: \\cmd.exe\n  selection_2:\n    CommandLine|contains: user\n    Image|endswith:\n    - \\net.exe\n    - \\net1.exe\nfields:\n- Image\n- CommandLine\n- User\n- LogonGuid\n- Hashes\n- ParentProcessGuid\n- ParentCommandLine\n", "detection_rule_title": "Local Accounts Discovery", "detection_rule_author": "Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8958153956944058323}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "8e2b24c9-4add-46a0-b4bb-0057b4e6187d", "technique": ["T1117: Regsvr32"], "raw_detection_rule": "detection:\n  condition: 1 of them\n  selection1:\n    CommandLine: '*\\Temp\\\\*'\n    Image: '*\\regsvr32.exe'\n  selection2:\n    Image: '*\\regsvr32.exe'\n    ParentImage: '*\\powershell.exe'\n  selection3:\n    Image: '*\\regsvr32.exe'\n    ParentImage: '*\\cmd.exe'\n  selection4:\n    CommandLine:\n    - '*/i:http* scrobj.dll'\n    - '*/i:ftp* scrobj.dll'\n    Image: '*\\regsvr32.exe'\n  selection5:\n    Image: '*\\wscript.exe'\n    ParentImage: '*\\regsvr32.exe'\n  selection6:\n    CommandLine: '*..\\..\\..\\Windows\\System32\\regsvr32.exe *'\n    Image: '*\\EXCEL.EXE'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Regsvr32 Anomaly", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3812793950637135965}}
{"date_created": "2019-06-01T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "4eebe114-4b24-4a9d-9a6c-c7bd7c8eaa61", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*vssadmin delete shadows*'\n    - '*wmic SHADOWCOPY DELETE*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Ransomware Deletes Volume Shadow Copies", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 819806385837972203}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation", "TA0003: Persistence"], "dr_id": "8202070f-edeb-4d31-a010-a26c72ac5600", "technique": ["T1100: Web Shell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - '*\\cmd.exe'\n    - '*\\sh.exe'\n    - '*\\bash.exe'\n    - '*\\powershell.exe'\n    ParentImage:\n    - '*\\w3wp.exe'\n    - '*\\httpd.exe'\n    - '*\\nginx.exe'\n    - '*\\php-cgi.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Shells Spawned by Web Servers", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8864609798301947498}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "e66779cc-383e-4224-a3a4-267eeb585c40", "technique": ["T1191: CMSTP", "T1088: Bypass User Account Control"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - /s\n    - /au\n    Image|endswith: \\cmstp.exe\n", "detection_rule_title": "Bypass UAC via CMSTP", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 545173727413962663}}
{"date_created": "2019-10-22T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "03552375-cc2c-4883-bbe4-7958d5a980be", "technique": ["not defined"], "raw_detection_rule": "action: global\nadditions:\n- logsource:\n    category: process_creation\n    product: windows\n- detection:\n    selection:\n      EventID: 7\n  logsource:\n    product: windows\n    service: sysmon\ndetection:\n  condition: selection\n  selection:\n    Description|contains: st2stager\n", "detection_rule_title": "SILENTTRINITY stager execution", "detection_rule_author": "Aleksey Potapov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0011_7_windows_sysmon_image_loaded", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0006_windows_sysmon_image_loaded", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 522388122110193676}}
{"date_created": "2019-10-30T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "45a594aa-1fbd-4972-a809-ff5a99dd81b8", "technique": ["T1096: NTFS File Attributes"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - Get-Content\n    - -Stream\n    Image|endswith: \\powershell.exe\n    ParentImage|endswith: \\powershell.exe\n", "detection_rule_title": "Run PowerShell script from ADS", "detection_rule_author": "Sergey Soldatov, Kaspersky Lab, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4344239605520028545}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "ffa6861c-4461-4f59-8a41-578c39f3f23e", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection1 and not selection2 or selection3\n  selection1:\n    CommandLine|contains|all:\n    - lsass\n    - .dmp\n  selection2:\n    Image|endswith: \\werfault.exe\n  selection3:\n    CommandLine|contains: lsass\n    Image|contains: \\procdump\n    Image|endswith: .exe\n", "detection_rule_title": "LSASS Memory Dumping", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Tony Lambert), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4963762234142099849}}
{"date_created": "2019-02-09T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "737e618a-a410-49b5-bec3-9e55ff7fbc15", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection1 or ( selection2 and not filter2 )\n  filter2:\n    Image: '*\\Windows\\Sys*'\n  selection1:\n    CommandLine: '*\\calc.exe *'\n  selection2:\n    Image: '*\\calc.exe'\n", "detection_rule_title": "Suspicious Calculator Usage", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7987633417602298300}}
{"date_created": "2019-10-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "e79a9e79-eb72-4e78-a628-0e7e8f59e89c", "technique": ["T1085: Rundll32"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine: '*\\rundll32.exe *,#*'\n", "detection_rule_title": "Suspicious Call by Ordinal", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7286041383803658052}}
{"date_created": "2019-09-30T00:00:00", "date_modified": "2019-10-31T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "032f5fb3-d959-41a5-9263-4173c802dc2b", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '* /c del \"C:\\Users\\\\*\\AppData\\Local\\Temp\\\\*.exe'\n    - '* /c del \"C:\\Users\\\\*\\Desktop\\\\*.exe'\n    - '* /C type nul > \"C:\\Users\\\\*\\Desktop\\\\*.exe'\n    ParentCommandLine:\n    - C:\\Windows\\System32\\\\*.exe\n    - C:\\Windows\\SysWOW64\\\\*.exe\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Formbook Process Creation", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1095077652975705625}}
{"date_created": "2019-08-30T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0004: Privilege Escalation"], "dr_id": "3268b746-88d8-4cd3-bffc-30077d02c787", "technique": ["T1088: Bypass User Account Control"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '* -NoP -NonI -w Hidden -c $x=$((gp HKCU:Software\\\\Microsoft\\\\Windows Update).Update)*'\n    - '* -NoP -NonI -c $x=$((gp HKCU:Software\\\\Microsoft\\\\Windows Update).Update);*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Empire PowerShell UAC Bypass", "detection_rule_author": "Ecco", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5954402043781940576}}
{"date_created": "2019-11-08T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "4bf943c6-5146-4273-98dd-e958fd1e3abf", "technique": ["T1027: Obfuscated Files or Information"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - CommandLine|re: \\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\[\n  - CommandLine|re: \\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\[\n  - CommandLine|re: \\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\[\n  - CommandLine|re: \\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}\n  - CommandLine|re: \\*mdr\\*\\W\\s*\\)\\.Name\n  - CommandLine|re: \\$VerbosePreference\\.ToString\\(\n  - CommandLine|re: \\String\\]\\s*\\$VerbosePreference\n", "detection_rule_title": "Invoke-Obfuscation obfuscated IEX invocation", "detection_rule_author": "Daniel Bohannon (@Mandiant/@FireEye), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["not defined"], "platform": ["not defined"], "type": ["not defined"], "channel": ["not defined"], "provider": ["not defined"], "data_needed": ["not defined"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2764001348306742588}}
{"date_created": "2018-10-30T00:00:00", "date_modified": "2019-10-14T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0006: Credential Access"], "dr_id": "5afee48e-67dd-4e03-a783-f74259dcf998", "technique": ["T1036: Masquerading", "T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: ( selection1 and selection2 ) or selection3\n  selection1:\n    CommandLine:\n    - '* -ma *'\n  selection2:\n    CommandLine:\n    - '* lsass*'\n  selection3:\n    CommandLine:\n    - '* -ma ls*'\n", "detection_rule_title": "Suspicious Use of Procdump", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -484960699026483189}}
{"date_created": "2017-11-27T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "e4a6b256-3e47-40fc-89d2-7a477edd6915", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image:\n    - C:\\Windows\\System32\\\\*\n    - C:\\Windows\\SysWow64\\\\*\n    - C:\\Windows\\explorer.exe\n    - C:\\Windows\\winsxs\\\\*\n  selection:\n    Image:\n    - '*\\svchost.exe'\n    - '*\\rundll32.exe'\n    - '*\\services.exe'\n    - '*\\powershell.exe'\n    - '*\\regsvr32.exe'\n    - '*\\spoolsv.exe'\n    - '*\\lsass.exe'\n    - '*\\smss.exe'\n    - '*\\csrss.exe'\n    - '*\\conhost.exe'\n    - '*\\wininit.exe'\n    - '*\\lsm.exe'\n    - '*\\winlogon.exe'\n    - '*\\explorer.exe'\n    - '*\\taskhost.exe'\n", "detection_rule_title": "System File Execution Location Anomaly", "detection_rule_author": "Florian Roth, Patrick Bareiss", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 855733664090846985}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "3dfd06d2-eaf4-4532-9555-68aca59f57c4", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - '*\\$Recycle.bin'\n    - '*\\Users\\All Users\\\\*'\n    - '*\\Users\\Default\\\\*'\n    - '*\\Users\\Public\\\\*'\n    - C:\\Perflogs\\\\*\n    - '*\\config\\systemprofile\\\\*'\n    - '*\\Windows\\Fonts\\\\*'\n    - '*\\Windows\\IME\\\\*'\n    - '*\\Windows\\addins\\\\*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Execution in Non-Executable Folder", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5321189563117099669}}
{"date_created": "2019-10-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0005: Defense Evasion", "TA0001: Initial Access"], "dr_id": "023394c4-29d5-46ab-92b8-6a534c6f447b", "technique": ["T1059: Command-Line Interface", "T1202: Indirect Command Execution", "T1193: Spearphishing Attachment"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: '*\\gbb.exe'\n    ParentImage: '*\\Hwp.exe'\n", "detection_rule_title": "Suspicious HWP Sub Processes", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4510990081125763224}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "68c8acb4-1b60-4890-8e82-3ddf7a6dba84", "technique": ["T1223: Compiled HTML File"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: .chm\n    Image|endswith: \\hh.exe\n", "detection_rule_title": "HH.exe execution", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Dan Beavin), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3565298749208088788}}
{"date_created": "2018-12-19T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "7ec2c172-dceb-4c10-92c9-87c1881b7e18", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '* asreproast *'\n    - '* dump /service:krbtgt *'\n    - '* kerberoast *'\n    - '* createnetonly /program:*'\n    - '* ptt /ticket:*'\n    - '* /impersonateuser:*'\n    - '* renew /ticket:*'\n    - '* asktgt /user:*'\n    - '* harvest /interval:*'\n", "detection_rule_title": "Rubeus Hack Tool", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4441902113647025919}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": "2012-12-11T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "9465ddf4-f9e4-4ebd-8d98-702df3a93239", "technique": ["T1100: Web Shell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*\\APPCMD.EXE install module /name:*'\n", "detection_rule_title": "IIS Native-Code Module Command Line Installation", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -9204482002749019810}}
{"date_created": "2019-10-23T00:00:00", "date_modified": "2019-11-08T00:00:00", "customer": ["None"], "tactic": ["TA0040: Impact"], "dr_id": "eb87818d-db5d-49cc-a987-d5da331fbd90", "technique": ["T1489: Service Stop"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - Image|endswith: \\taskkill.exe\n  - CommandLine|contains: stop\n    Image|endswith:\n    - \\sc.exe\n    - \\net.exe\n    - \\net1.exe\n", "detection_rule_title": "Stop windows service", "detection_rule_author": "Jakob Weinzettl, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5878968167254951571}}
{"date_created": "2019-11-20T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "02e0b2ea-a597-428e-b04a-af6a1a403e5c", "technique": ["T1068: Exploitation for Privilege Escalation"], "raw_detection_rule": "detection:\n  condition: selection and ( rights1 or rights2 )\n  rights1:\n    IntegrityLevel: System\n  rights2:\n    User: NT AUTHORITY\\SYSTEM\n  selection:\n    CommandLine: '* http*'\n    Image: '*\\iexplore.exe'\n    ParentImage: '*\\consent.exe'\n", "detection_rule_title": "Exploiting CVE-2019-1388", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2171624852303445592}}
{"date_created": "2017-10-14T00:00:00", "date_modified": "2019-02-21T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "7a38aa19-86a9-4af7-ac51-6bfe4e59f254", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - C:\\PerfLogs\\\\*\n    - C:\\$Recycle.bin\\\\*\n    - C:\\Intel\\Logs\\\\*\n    - C:\\Users\\Default\\\\*\n    - C:\\Users\\Public\\\\*\n    - C:\\Users\\NetworkService\\\\*\n    - C:\\Windows\\Fonts\\\\*\n    - C:\\Windows\\Debug\\\\*\n    - C:\\Windows\\Media\\\\*\n    - C:\\Windows\\Help\\\\*\n    - C:\\Windows\\addins\\\\*\n    - C:\\Windows\\repair\\\\*\n    - C:\\Windows\\security\\\\*\n    - '*\\RSA\\MachineKeys\\\\*'\n    - C:\\Windows\\system32\\config\\systemprofile\\\\*\n    - C:\\Windows\\Tasks\\\\*\n    - C:\\Windows\\System32\\Tasks\\\\*\n", "detection_rule_title": "Executables Started in Suspicious Folder", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2755791068623196948}}
{"date_created": "2019-09-26T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "cc36992a-4671-4f21-a91d-6c2b72a2edf5", "technique": ["T1070: Indicator Removal on Host"], "raw_detection_rule": "detection:\n  condition: 1 of them\n  selection_ps:\n    CommandLine|contains:\n    - Clear-EventLog\n    - Remove-EventLog\n    - Limit-EventLog\n    Image|endswith: \\powershell.exe\n  selection_wevtutil:\n    CommandLine|contains:\n    - clear-log\n    - cl\n    - set-log\n    - sl\n    Image|endswith: \\wevtutil.exe\n  selection_wmic:\n    CommandLine|contains: ClearEventLog\n    Image|endswith: \\wmic.exe\n", "detection_rule_title": "Suspicious eventlog clear or configuration using wevtutil", "detection_rule_author": "Ecco, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1759780350715079418}}
{"date_created": "2019-10-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0010: Exfiltration"], "dr_id": "c75309a3-59f8-4a8d-9c2c-4c927ad50555", "technique": ["T1020: Automated Exfiltration"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    NewProcessName|endswith:\n    - \\plink.exe\n    - \\socat.exe\n    - \\stunnel.exe\n    - \\httptunnel.exe\n", "detection_rule_title": "Exfiltration and tunneling tools execution", "detection_rule_author": "Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3047470343165391620}}
{"date_created": "2017-11-23T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "678eb5f4-8597-4be6-8be7-905e4234b53a", "technique": ["T1211: Exploitation for Defense Evasion"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    ParentImage: '*\\EQNEDT32.EXE'\nfields:\n- CommandLine\n", "detection_rule_title": "Droppers exploiting CVE-2017-11882", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7789674641036839937}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": "2019-01-22T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "e011a729-98a6-4139-b5c4-bf6f6dd8239a", "technique": ["T1140: Deobfuscate/Decode Files or Information", "T1105: Remote File Copy"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '* -decode *'\n    - '* /decode *'\n    - '* -decodehex *'\n    - '* /decodehex *'\n    - '* -urlcache *'\n    - '* /urlcache *'\n    - '* -verifyctl *'\n    - '* /verifyctl *'\n    - '* -encode *'\n    - '* /encode *'\n    - '*certutil* -URL*'\n    - '*certutil* /URL*'\n    - '*certutil* -ping*'\n    - '*certutil* /ping*'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious Certutil Command", "detection_rule_author": "Florian Roth, juju4, keepwatch", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -468328235768139960}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "b243b280-65fe-48df-ba07-6ddea7646427", "technique": ["T1124: System Time Discovery"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - CommandLine|contains: time\n    Image|endswith:\n    - \\net.exe\n    - \\net1.exe\n  - CommandLine|contains: tz\n    Image|endswith: \\w32tm.exe\n  - CommandLine|contains: Get-Date\n    Image|endswith: \\powershell.exe\n", "detection_rule_title": "Discovery of a system time", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4482387604087622576}}
{"date_created": "2019-03-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "a238b5d0-ce2d-4414-a676-7a531b3d13d6", "technique": ["T1070: Indicator Removal on Host"], "raw_detection_rule": "detection:\n  condition: selection_clear_1 or selection_clear_2 or selection_disable_1 or selection_disable_2\n  selection_clear_1:\n    CommandLine: '* cl */Trace*'\n  selection_clear_2:\n    CommandLine: '* clear-log */Trace*'\n  selection_disable_1:\n    CommandLine: '* sl* /e:false*'\n  selection_disable_2:\n    CommandLine: '* set-log* /e:false*'\n", "detection_rule_title": "Disable of ETW Trace", "detection_rule_author": "@neu5ron, Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -9209675124018088567}}
{"date_created": "2019-04-17T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "7b0666ad-3e38-4e3d-9bab-78b06de85f7b", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: (selection1 and selection2) and not filter1\n  filter1:\n    Image: '*paexec*'\n  selection1:\n    Product:\n    - '*PAExec*'\n  selection2:\n    Imphash:\n    - 11D40A7B7876288F919AB819CC2D9802\n    - 6444f8a34e99b8f7d9647de66aabe516\n    - dfd6aa3f7b2b1035b76b718f1ddc689f\n    - 1a6cca4d5460b1710a12dea39e4a592c\n", "detection_rule_title": "Execution of Renamed PaExec", "detection_rule_author": "Jason Lynch", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4996467912931881586}}
{"date_created": "2019-10-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "b17ea6f7-6e90-447e-a799-e6c0a493d6ce", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - shadow\n    - create\n    NewProcessName|endswith:\n    - \\powershell.exe\n    - \\wmic.exe\n    - \\vssadmin.exe\n", "detection_rule_title": "Shadow copies creation using operating systems utilities", "detection_rule_author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8708709328523332872}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution", "TA0005: Defense Evasion"], "dr_id": "67f113fa-e23d-4271-befa-30113b3e08b1", "technique": ["T1170: Mshta"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: javascript\n    Image|endswith: \\mshta.exe\n", "detection_rule_title": "Mshta Network Connections", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3570202424526290358}}
{"date_created": "2019-10-22T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "e7be6119-fc37-43f0-ad4f-1f3f99be2f9f", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - CommandLine|contains:\n    - vss\n    - /m\n    - /y\n    Image|endswith: \\esentutl.exe\n  - CommandLine|contains:\n    - \\windows\\ntds\\ntds.dit\n    - \\config\\sam\n    - \\config\\security\n    - \\config\\system\n    - \\repair\\sam\n    - \\repair\\system\n    - \\repair\\security\n    - \\config\\RegBack\\sam\n    - \\config\\RegBack\\system\n    - \\config\\RegBack\\security\n", "detection_rule_title": "Copying sensitive files with credential data", "detection_rule_author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3923576288794843181}}
{"date_created": "2019-08-27T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution", "TA0005: Defense Evasion"], "dr_id": "0ba863e6-def5-4e50-9cea-4dd8c7dc46a4", "technique": ["T1196: Control Panel Items"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    CommandLine:\n    - '*\\System32\\\\*'\n    - '*%System%*'\n  selection:\n    CommandLine: '*.cpl'\nreference:\n- https://attack.mitre.org/techniques/T1196/\n", "detection_rule_title": "Control Panel Items", "detection_rule_author": "Kyaw Min Thein", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8597766463088919895}}
{"date_created": "2018-12-12T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "17eb8e57-9983-420d-ad8a-2c4976c22eb8", "technique": ["T1055: Process Injection", "T1218: Signed Binary Proxy Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine: '* /INJECTRUNNING *'\n", "detection_rule_title": "MavInject Process Injection", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3463361676131000592}}
{"date_created": "2019-08-24T00:00:00", "date_modified": "2019-12-17T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "dcaa3f04-70c3-427a-80b4-b870d73c94c4", "technique": ["T1500: Compile After Delivery"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    ParentImage:\n    - C:\\Program Files*\n    - '*\\sdiagnhost.exe'\n    - '*\\w3wp.exe'\n  selection:\n    CommandLine:\n    - '*\\AppData\\\\*'\n    - '*\\Windows\\Temp\\\\*'\n    Image: '*\\csc.exe'\n", "detection_rule_title": "Suspicious Csc.exe Source File Folder", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1307149720860099526}}
{"date_created": "2019-01-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "f50bfd8b-e2a3-4c15-9373-7900b5a4c6d5", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - '*\\$Recycle.bin'\n    - '*\\Users\\Public\\\\*'\n    - C:\\Perflogs\\\\*\n    - '*\\Windows\\Fonts\\\\*'\n    - '*\\Windows\\IME\\\\*'\n    - '*\\Windows\\addins\\\\*'\n    - '*\\Windows\\debug\\\\*'\n", "detection_rule_title": "Suspicious Program Location Process Starts", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5403622101164771896}}
{"date_created": "2018-03-17T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0011: Command and Control"], "dr_id": "9847f263-4a81-424f-970c-875dab15b79b", "technique": ["T1219: Remote Access Tools"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: '*\\tscon.exe'\n    User: NT AUTHORITY\\SYSTEM\n", "detection_rule_title": "Suspicious TSCON Start", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6712075214660639413}}
{"date_created": "2019-10-30T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "2d87d610-d760-45ee-a7e6-7a6f2a65de00", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: 1 of them\n  selection1:\n    CommandLine:\n    - '*Temp\\wtask.exe /create*'\n    - '*%windir:~-3,1%%PUBLIC:~-9,1%*'\n    - '*/E:vbscript * C:\\Users\\*.txt\" /F'\n    - '*/tn \"Security Script *'\n    - '*%windir:~-1,1%*'\n  selection2:\n    Image:\n    - '*Temp\\winwsh.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Mustang Panda Dropper", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2186314876981757955}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": "2019-07-31T00:00:00", "customer": ["TESTCUSTOMER2", "TESTCUSTOMER"], "tactic": ["TA0005: Defense Evasion", "TA0004: Privilege Escalation", "TA0002: Execution"], "dr_id": "4b60e6f2-bf39-47b4-b4ea-398e33cfe253", "technique": ["T1088: Bypass User Account Control", "T1191: CMSTP"], "raw_detection_rule": "detection:\n  condition: selection1 and selection2\n  selection1:\n    ParentCommandLine: '*\\DllHost.exe'\n  selection2:\n    ParentCommandLine:\n    - '*{3E5FC7F9-9A51-4367-9063-A120244FBEC7}'\n    - '*{3E000D72-A845-4CD9-BD83-80C07C3B881F}'\nfields:\n- CommandLine\n- ParentCommandLine\n- Hashes\n", "detection_rule_title": "CMSTP UAC Bypass via COM Object Access", "detection_rule_author": "Nik Seetharaman", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1859691785486453614}}
{"date_created": "2019-10-26T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "d937b75f-a665-4480-88a5-2f20e9f9b22a", "technique": ["T1134: Access Token Manipulation"], "raw_detection_rule": "detection:\n  binpath:\n    CommandLine|contains|all:\n    - config\n    - binPath\n  condition: scbynonadmin and (binpath or failurecommand)\n  failurecommand:\n    CommandLine|contains|all:\n    - failure\n    - command\n  scbynonadmin:\n    Image|endswith: \\sc.exe\n    IntegrityLevel: Medium\n", "detection_rule_title": "Possible privilege escalation via weak service permissions", "detection_rule_author": "Teymur Kheirkhabarov", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4581358269991820422}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "2afafd61-6aae-4df4-baed-139fa1f4c345", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine: '*\\ntdsutil*'\n", "detection_rule_title": "Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6701583184555929398}}
{"date_created": "2019-10-14T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "c7942406-33dd-4377-a564-0f62db0593a3", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - chcp* 936\n    - chcp* 1258\nfields:\n- ParentCommandLine\n", "detection_rule_title": "Suspicious Code Page Switch", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6714332062331021829}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0004: Privilege Escalation"], "dr_id": "7fe71fc9-de3b-432a-8d57-8c809efc10ab", "technique": ["T1050: New Service"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - CommandLine|contains|all:\n    - create\n    - binpath\n    Image|endswith: \\sc.exe\n  - CommandLine|contains: new-service\n    Image|endswith: \\powershell.exe\n", "detection_rule_title": "New service creation", "detection_rule_author": "Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4480457440943727676}}
{"date_created": "2019-08-23T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "88f680b8-070e-402c-ae11-d2914f2257f1", "technique": ["T1086: PowerShell", "T1140: Deobfuscate/Decode Files or Information"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|base64offset|contains:\n    - IEX ([\n    - iex ([\n    - iex (New\n    - IEX (New\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Encoded IEX", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2131352389037374818}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": "2018-12-11T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "f0cdd048-82dc-4f7a-8a7a-b87a52b6d0fd", "technique": ["T1140: Deobfuscate/Decode Files or Information"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - ^h^t^t^p\n    - h\"t\"t\"p\n", "detection_rule_title": "Suspicious Commandline Escape", "detection_rule_author": "juju4", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6806891277622309868}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["TESTCUSTOMER2", "TESTCUSTOMER"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "8d63dadf-b91b-4187-87b6-34a1114577ea", "technique": ["T1047: Windows Management Instrumentation"], "raw_detection_rule": "detection:\n  condition: 1 of them\n  selection1:\n    CommandLine:\n    - wmic * *format:\\\"http*\n    - wmic * /format:'http\n    - wmic * /format:http*\n    Image:\n    - '*\\wmic.exe'\n  selection2:\n    CommandLine:\n    - '* *format:\\\"http*'\n    - '* /format:''http'\n    - '* /format:http*'\n    Imphash:\n    - 1B1A3F43BF37B5BFE60751F2EE2F326E\n    - 37777A96245A3C74EB217308F3546F4C\n    - 9D87C9D67CE724033C0B40CC4CA1B206\n", "detection_rule_title": "SquiblyTwo", "detection_rule_author": "Markus Neis / Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7228808519530426083}}
{"date_created": "2018-02-22T00:00:00", "date_modified": null, "customer": ["TESTCUSTOMER"], "tactic": ["TA0005: Defense Evasion", "TA0004: Privilege Escalation"], "dr_id": "864403a1-36c9-40a2-a982-4c9a45f7d833", "technique": ["T1055: Process Injection"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: '*\\FLTLDR.exe*'\n    ParentImage: '*\\WINWORD.EXE'\n", "detection_rule_title": "Exploit for CVE-2017-0261", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4072062449142213491}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "d95de845-b83c-4a9a-8a6a-4fc802ebf6c0", "technique": ["T1087: Account Discovery"], "raw_detection_rule": "analysis:\n  recommendation: Check if the user that executed the commands is suspicious (e.g.\n    service accounts, LOCAL_SYSTEM)\ndetection:\n  condition: selection\n  selection:\n    CommandLine:\n    - net group \"domain admins\" /domain\n    - net localgroup administrators\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious Reconnaissance Activity", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3000617333411376270}}
{"date_created": "2019-10-11T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "797011dc-44f4-4e6f-9f10-a8ceefbe566b", "technique": ["T1084: Windows Management Instrumentation Event Subscription"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    ParentImage: '*\\EdgeTransport.exe'\n", "detection_rule_title": "WMI Backdoor Exchange Transport Agent", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3786671462930052431}}
{"date_created": "2019-02-07T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0003: Persistence"], "dr_id": "c9fbe8e9-119d-40a6-9b59-dd58a5d84429", "technique": ["T1070: Indicator Removal on Host", "T1067: Bootkit"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    NewProcessName: '*\\bcdedit.exe'\n    ProcessCommandLine:\n    - '*delete*'\n    - '*deletevalue*'\n    - '*import*'\n", "detection_rule_title": "Possible Ransomware or unauthorized MBR modifications", "detection_rule_author": "@neu5ron", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log"], "channel": ["Security"], "provider": ["Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3272372353587634080}}
{"date_created": "2019-10-26T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "6c5808ee-85a2-4e56-8137-72e5876a5096", "technique": ["T1134: Access Token Manipulation"], "raw_detection_rule": "detection:\n  condition: selection and not rundllexception\n  rundllexception:\n    CommandLine|contains: DavSetCookie\n    Image|endswith: \\rundll32.exe\n  selection:\n    ParentUser:\n    - NT AUTHORITY\\NETWORK SERVICE\n    - NT AUTHORITY\\LOCAL SERVICE\n    User: NT AUTHORITY\\SYSTEM\nenrichment:\n- EN_0001_cache_sysmon_event_id_1_info\n- EN_0002_enrich_sysmon_event_id_1_with_parent_info\n", "detection_rule_title": "Possible Rotten Potato detection - privilege escalation fro Service accounts to SYSTEM", "detection_rule_author": "Teymur Kheirkhabarov", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["EN_0001_cache_sysmon_event_id_1_info", "EN_0002_enrich_sysmon_event_id_1_with_parent_info"], "enrichment_requirements": ["not defined", ["EN_0001_cache_sysmon_event_id_1_info"]]}
{"index": {"_id": -5894402638572025644}}
{"date_created": "2018-03-23T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "1a0d4aba-7668-4365-9ce4-6d79ab088dfd", "technique": ["T1140: Deobfuscate/Decode Files or Information", "T1027: Obfuscated Files or Information"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*\\ping.exe 0x*'\n    - '*\\ping 0x*'\nfields:\n- ParentCommandLine\n", "detection_rule_title": "Ping Hex IP", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1696746624172574873}}
{"date_created": "2019-10-26T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "15619216-e993-4721-b590-4c520615a67d", "technique": ["T1134: Access Token Manipulation"], "raw_detection_rule": "detection:\n  condition: selection_1 and selection_2\n  selection_1:\n    ParentImage|endswith: \\services.exe\n  selection_2:\n  - CommandLine|contains:\n    - cmd\n    - comspec\n  - CommandLine|contains|all:\n    - cmd\n    - /c\n    - echo\n    - \\pipe\\\n  - CommandLine|contains|all:\n    - '%COMSPEC%'\n    - /c\n    - echo\n    - \\pipe\\\n  - CommandLine|contains|all:\n    - rundll32\n    - .dll,a\n    - '/p:'\n", "detection_rule_title": "Meterpreter or Cobalt Strike getsystem service start", "detection_rule_author": "Teymur Kheirkhabarov", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6356082215839694454}}
{"date_created": "2018-03-13T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "3d7679bd-0c00-440c-97b0-3f204273e6c7", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image:\n    - '*\\resmon.exe'\n    - '*\\mmc.exe'\n    - '*\\taskmgr.exe'\n  selection:\n    ParentImage: '*\\taskmgr.exe'\nfields:\n- Image\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Taskmgr as Parent", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2864108420192298189}}
{"date_created": "2018-04-06T00:00:00", "date_modified": "2019-02-05T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution", "TA0005: Defense Evasion"], "dr_id": "3a6586ad-127a-4d3b-a677-1e6eacdf8fde", "technique": ["T1064: Scripting"], "raw_detection_rule": "detection:\n  condition: selection and not falsepositives\n  falsepositives:\n    CurrentDirectory: '*\\ccmcache\\\\*'\n  selection:\n    Image:\n    - '*\\schtasks.exe'\n    - '*\\nslookup.exe'\n    - '*\\certutil.exe'\n    - '*\\bitsadmin.exe'\n    - '*\\mshta.exe'\n    ParentImage:\n    - '*\\mshta.exe'\n    - '*\\powershell.exe'\n    - '*\\rundll32.exe'\n    - '*\\cscript.exe'\n    - '*\\wscript.exe'\n    - '*\\wmiprvse.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Windows Shell Spawning Suspicious Program", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3470736122252612264}}
{"date_created": "2019-10-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "d3c3861d-c504-4c77-ba55-224ba82d0118", "technique": ["T1040: Network Sniffing"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - netsh\n    - trace\n    - start\n", "detection_rule_title": "Capture a Network Trace with netsh.exe", "detection_rule_author": "Kutepov Anton, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1733721894417878372}}
{"date_created": "2017-06-12T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "aeab5ec5-be14-471a-80e8-e344418305c2", "technique": ["T1073: DLL Side-Loading"], "raw_detection_rule": "detection:\n  condition: ( selection_cammute and not filter_cammute ) or ( selection_chrome_frame\n    and not filter_chrome_frame ) or ( selection_devemu and not filter_devemu ) or\n    ( selection_gadget and not filter_gadget ) or ( selection_hcc and not filter_hcc\n    ) or ( selection_hkcmd and not filter_hkcmd ) or ( selection_mc and not filter_mc\n    ) or ( selection_msmpeng and not filter_msmpeng ) or ( selection_msseces and not\n    filter_msseces ) or ( selection_oinfo and not filter_oinfo ) or ( selection_oleview\n    and not filter_oleview ) or ( selection_rc and not filter_rc )\n  filter_cammute:\n    Image: '*\\Lenovo\\Communication Utility\\\\*'\n  filter_chrome_frame:\n    Image: '*\\Google\\Chrome\\application\\\\*'\n  filter_devemu:\n    Image: '*\\Microsoft Device Emulator\\\\*'\n  filter_gadget:\n    Image: '*\\Windows Media Player\\\\*'\n  filter_hcc:\n    Image: '*\\HTML Help Workshop\\\\*'\n  filter_hkcmd:\n    Image:\n    - '*\\System32\\\\*'\n    - '*\\SysNative\\\\*'\n    - '*\\SysWowo64\\\\*'\n  filter_mc:\n    Image:\n    - '*\\Microsoft Visual Studio*'\n    - '*\\Microsoft SDK*'\n    - '*\\Windows Kit*'\n  filter_msmpeng:\n    Image:\n    - '*\\Microsoft Security Client\\\\*'\n    - '*\\Windows Defender\\\\*'\n    - '*\\AntiMalware\\\\*'\n  filter_msseces:\n    Image:\n    - '*\\Microsoft Security Center\\\\*'\n    - '*\\Microsoft Security Client\\\\*'\n    - '*\\Microsoft Security Essentials\\\\*'\n  filter_oinfo:\n    Image: '*\\Common Files\\Microsoft Shared\\\\*'\n  filter_oleview:\n    Image:\n    - '*\\Microsoft Visual Studio*'\n    - '*\\Microsoft SDK*'\n    - '*\\Windows Kit*'\n    - '*\\Windows Resource Kit\\\\*'\n  filter_rc:\n    Image:\n    - '*\\Microsoft Visual Studio*'\n    - '*\\Microsoft SDK*'\n    - '*\\Windows Kit*'\n    - '*\\Windows Resource Kit\\\\*'\n    - '*\\Microsoft.NET\\\\*'\n  selection_cammute:\n    Image: '*\\CamMute.exe'\n  selection_chrome_frame:\n    Image: '*\\chrome_frame_helper.exe'\n  selection_devemu:\n    Image: '*\\dvcemumanager.exe'\n  selection_gadget:\n    Image: '*\\Gadget.exe'\n  selection_hcc:\n    Image: '*\\hcc.exe'\n  selection_hkcmd:\n    Image: '*\\hkcmd.exe'\n  selection_mc:\n    Image: '*\\Mc.exe'\n  selection_msmpeng:\n    Image: '*\\MsMpEng.exe'\n  selection_msseces:\n    Image: '*\\msseces.exe'\n  selection_oinfo:\n    Image: '*\\OInfoP11.exe'\n  selection_oleview:\n    Image: '*\\OleView.exe'\n  selection_rc:\n    Image: '*\\rc.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Executable used by PlugX in Uncommon Location - Sysmon Version", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2837409417540329132}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "03cc0c25-389f-4bf8-b48d-11878079f1ca", "technique": ["T1170: Mshta"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - '*\\cmd.exe'\n    - '*\\powershell.exe'\n    - '*\\wscript.exe'\n    - '*\\cscript.exe'\n    - '*\\sh.exe'\n    - '*\\bash.exe'\n    - '*\\reg.exe'\n    - '*\\regsvr32.exe'\n    - '*\\BITSADMIN*'\n    ParentImage: '*\\mshta.exe'\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "MSHTA Spawning Windows Shell", "detection_rule_author": "Michael Haag", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 194040969227011175}}
{"date_created": "2018-06-07T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "ed5d72a6-f8f4-479d-ba79-02f6a80d7471", "technique": ["T1170: Mshta"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image: '*\\mshta.exe'\n    ParentImage: '*\\svchost.exe'\n", "detection_rule_title": "MSHTA spwaned by SVCHOST as seen in LethalHTA", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6950767904065164897}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "1ac8666b-046f-4201-8aba-1951aaec03a3", "technique": ["T1059: Command-Line Interface"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - cmd.exe /c *http://*%AppData%\n    - cmd.exe /c *https://*%AppData%\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Command Line Execution with suspicious URL and AppData Strings", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1800281001507499052}}
{"date_created": "2017-11-10T00:00:00", "date_modified": "2018-12-11T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "1fac1481-2dbc-48b2-9096-753c49b4ec71", "technique": ["T1064: Scripting"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    selection:\n      CommandLine:\n      - '*\\AppData\\Roaming\\Oracle*\\java*.exe *'\n      - '*cscript.exe *Retrive*.vbs *'\n  logsource:\n    category: process_creation\n    product: windows\n- detection:\n    selection:\n      EventID: 11\n      TargetFilename:\n      - '*\\AppData\\Roaming\\Oracle\\bin\\java*.exe'\n      - '*\\Retrive*.vbs'\n  logsource:\n    product: windows\n    service: sysmon\n- detection:\n    selection:\n      Details: '%AppData%\\Roaming\\Oracle\\bin\\\\*'\n      EventID: 13\n      TargetObject: \\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run*\n  logsource:\n    product: windows\n    service: sysmon\ndetection:\n  condition: selection\n", "detection_rule_title": "Adwind RAT / JRAT", "detection_rule_author": "Florian Roth, Tom Ueltschi", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0015_11_windows_sysmon_FileCreate", "DN_0017_13_windows_sysmon_RegistryEvent", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0008_windows_sysmon_FileCreate", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6552925683061614323}}
{"date_created": "2019-10-23T00:00:00", "date_modified": "2019-11-08T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "37ae075c-271b-459b-8d7b-55ad5f993dd8", "technique": ["T1222: File Permissions Modification"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - Image|endswith: \\takeown.exe\n  - CommandLine|contains: /grant\n    Image|endswith:\n    - \\cacls.exe\n    - \\icacls.exe\n  - CommandLine|contains: -r\n    Image|endswith: \\attrib.exe\n", "detection_rule_title": "File or folder permissions modifications", "detection_rule_author": "Jakob Weinzettl, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8777234313995084063}}
{"date_created": "2018-03-17T00:00:00", "date_modified": "2018-12-11T00:00:00", "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0004: Privilege Escalation"], "dr_id": "f72aa3e8-49f9-4c7d-bd74-f8ab84ff9bbb", "technique": ["T1076: Remote Desktop Protocol"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine: '* /dest:rdp-tcp:*'\n", "detection_rule_title": "Suspicious RDP Redirect Using TSCON", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7010612655679370567}}
{"date_created": "2019-10-23T00:00:00", "date_modified": "2019-11-08T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "77815820-246c-47b8-9741-e0def3f57308", "technique": ["T1482: Domain Trust Discovery"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - CommandLine|contains|all:\n    - -filter\n    - trustedDomain\n    Image|endswith: \\dsquery.exe\n  - CommandLine|contains: domain_trusts\n    Image|endswith: \\nltest.exe\n", "detection_rule_title": "Domain Trust Discovery", "detection_rule_author": "Jakob Weinzettl, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4648765359872683775}}
{"date_created": "2019-11-14T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "e22a6eb2-f8a5-44b5-8b44-a2dbd47b1144", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image:\n    - C:\\Windows\\System32\\\\*\n    - C:\\Windows\\SysWOW64\\\\*\n    - C:\\Windows\\WinSxS\\\\*\n  selection:\n    Image: '*\\msiexec.exe'\n", "detection_rule_title": "Suspicious MsiExec Directory", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -9190838406750250926}}
{"date_created": "2019-11-01T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "57c4bf16-227f-4394-8ec7-1b745ee061c3", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - netsh firewall set opmode mode=disable\n    - netsh advfirewall set * state off\n", "detection_rule_title": "Firewall Disabled via Netsh", "detection_rule_author": "Fatih Sirin", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7641446539536213512}}
{"date_created": "2019-06-26T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0001: Initial Access"], "dr_id": "1cdd9a09-06c9-4769-99ff-626e2b3991b8", "technique": ["T1193: Spearphishing Attachment"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Image:\n    - '*.doc.exe'\n    - '*.docx.exe'\n    - '*.xls.exe'\n    - '*.xlsx.exe'\n    - '*.ppt.exe'\n    - '*.pptx.exe'\n    - '*.rtf.exe'\n    - '*.pdf.exe'\n    - '*.txt.exe'\n    - '*      .exe'\n    - '*______.exe'\n", "detection_rule_title": "Suspicious Double Extension", "detection_rule_author": "Florian Roth (rule), @blu3_team (idea)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Windows Log", "Applications and Services Logs"], "channel": ["Security", "Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Security-Auditing", "Microsoft-Windows-Sysmon"], "data_needed": ["DN_0001_4688_windows_process_creation", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0001_windows_audit_process_creation", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7010612655679370567}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "3bad990e-4848-4a78-9530-b427d854aac0", "technique": ["T1482: Domain Trust Discovery"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - CommandLine|contains: domain_trusts\n    Image|endswith: \\nltest.exe\n  - CommandLine|contains: trustedDomain\n    Image|endswith: \\dsquery.exe\n", "detection_rule_title": "Domain Trust Discovery", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Tony Lambert), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3799329479483485745}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0007: Discovery"], "dr_id": "970007b7-ce32-49d0-a4a4-fbef016950bd", "technique": ["T1012: Query Registry", "T1007: System Service Discovery"], "raw_detection_rule": "detection:\n  condition: selection_1 and selection_2\n  selection_1:\n    CommandLine|contains:\n    - query\n    - save\n    - export\n    Image|endswith: \\reg.exe\n  selection_2:\n    CommandLine|contains:\n    - currentVersion\\windows\n    - currentVersion\\runServicesOnce\n    - currentVersion\\runServices\n    - winlogon\\\n    - currentVersion\\shellServiceObjectDelayLoad\n    - currentVersion\\runOnce\n    - currentVersion\\runOnceEx\n    - currentVersion\\run\n    - currentVersion\\policies\\explorer\\run\n    - currentcontrolset\\services\nfields:\n- Image\n- CommandLine\n- User\n- LogonGuid\n- Hashes\n- ParentProcessGuid\n- ParentCommandLine\n", "detection_rule_title": "Query Registry", "detection_rule_author": "Timur Zinniatullin, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1769029505553647775}}
{"date_created": "2019-10-25T00:00:00", "date_modified": "2019-11-07T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "65d2be45-8600-4042-b4c0-577a1ff8a60e", "technique": ["T1218: Signed Binary Proxy Execution"], "raw_detection_rule": "detection:\n  condition: selection_1 or selection_2\n  selection_1:\n    CommandLine|contains:\n    - -f\n    - regsvr\n    Image|endswith: \\odbcconf.exe\n  selection_2:\n    Image|endswith: \\rundll32.exe\n    ParentImage|endswith: \\odbcconf.exe\n", "detection_rule_title": "Possible Application Whitelisting Bypass via dll loaded by odbcconf.exe", "detection_rule_author": "Kirill Kiryanov, Beyu Denis, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6357897437087693476}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "fa47597e-90e9-41cd-ab72-c3b74cfb0d02", "technique": ["T1202: Indirect Command Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    ParentImage|endswith:\n    - \\pcalua.exe\n    - \\forfiles.exe\n", "detection_rule_title": "Indirect Command Execution", "detection_rule_author": "E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4643043398522715232}}
{"date_created": "2019-09-12T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "734f8d9b-42b8-41b2-bcf5-abaf49d5a3c8", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - Image|endswith: \\wsmprovhost.exe\n  - ParentImage|endswith: \\wsmprovhost.exe\n", "detection_rule_title": "T1086 Remote PowerShell Session", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3056569679676697730}}
{"date_created": "2018-08-25T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "6812a10b-60ea-420c-832f-dfcc33b646ba", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: (selection1 or selection2) and selection3\n  selection1:\n    Image:\n    - '*\\rundll32.exe'\n  selection2:\n    Description:\n    - '*Windows-Hostprozess (Rundll32)*'\n  selection3:\n    CommandLine:\n    - '*Default.GetString*'\n    - '*FromBase64String*'\n", "detection_rule_title": "Detection of PowerShell Execution via DLL", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5169691444132355455}}
{"date_created": "2019-10-12T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "cc268ac1-42d9-40fd-9ed3-8c4e1a5b87e6", "technique": ["T1218: Signed Binary Proxy Execution"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine|contains: LaunchForDeploy\n    Image|endswith: \\devtoolslauncher.exe\n", "detection_rule_title": "Devtoolslauncher.exe executes specified binary", "detection_rule_author": "Beyu Denis, oscd.community (rule), @_felamos (idea)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2793634295591304848}}
{"date_created": "2019-01-29T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "782d6f3e-4c5d-4b8c-92a3-1d05fed72e63", "technique": ["T1021: Remote Services"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - netsh i* p*=3389 c*\n", "detection_rule_title": "Netsh RDP Port Forwarding", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8488565213472621515}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "6bba49bf-7f8c-47d6-a1bb-6b4dece4640e", "technique": ["T1064: Scripting"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - rasdial\n", "detection_rule_title": "Suspicious RASdial Activity", "detection_rule_author": "juju4", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -101142344680308475}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "e593cf51-88db-4ee1-b920-37e89012a3c9", "technique": ["T1085: Rundll32"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CommandLine:\n    - '*\\rundll32.exe* url.dll,*OpenURL *'\n    - '*\\rundll32.exe* url.dll,*OpenURLA *'\n    - '*\\rundll32.exe* url.dll,*FileProtocolHandler *'\n    - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *'\n    - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *'\n    - '*\\rundll32.exe javascript:*'\n    - '* url.dll,*OpenURL *'\n    - '* url.dll,*OpenURLA *'\n    - '* url.dll,*FileProtocolHandler *'\n    - '* zipfldr.dll,*RouteTheCall *'\n    - '* Shell32.dll,*Control_RunDLL *'\n    - '* javascript:*'\n    - '*.RegisterXLL*'\n", "detection_rule_title": "Suspicious Rundll32 Activity", "detection_rule_author": "juju4", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -206294489323696834}}
{"date_created": "2018-03-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation", "TA0003: Persistence"], "dr_id": "baca5663-583c-45f9-b5dc-ea96a22ce542", "technique": ["T1015: Accessibility Features"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    selection_registry:\n      EventID: 13\n      EventType: SetValue\n      TargetObject:\n      - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\\Debugger'\n      - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman.exe\\Debugger'\n      - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\osk.exe\\Debugger'\n      - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Magnify.exe\\Debugger'\n      - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Narrator.exe\\Debugger'\n      - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DisplaySwitch.exe\\Debugger'\n  logsource:\n    product: windows\n    service: sysmon\n- detection:\n    selection_process:\n      CommandLine:\n      - '*cmd.exe sethc.exe *'\n      - '*cmd.exe utilman.exe *'\n      - '*cmd.exe osk.exe *'\n      - '*cmd.exe Magnify.exe *'\n      - '*cmd.exe Narrator.exe *'\n      - '*cmd.exe DisplaySwitch.exe *'\n      ParentImage:\n      - '*\\winlogon.exe'\n  logsource:\n    category: process_creation\n    product: windows\ndetection:\n  condition: 1 of them\n", "detection_rule_title": "Sticky Key Like Backdoor Usage", "detection_rule_author": "Florian Roth, @twjackomo", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["not defined", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7757634630437835454}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["TESTCUSTOMER"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "9d26fede-b526-4413-b069-6e24b6d07167", "technique": ["T1191: CMSTP"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    selection2:\n      EventID: 12\n      TargetObject: '*\\cmmgr32.exe*'\n    selection3:\n      EventID: 13\n      TargetObject: '*\\cmmgr32.exe*'\n    selection4:\n      CallTrace: '*cmlua.dll*'\n      EventID: 10\n  logsource:\n    product: windows\n    service: sysmon\n- detection:\n    selection1:\n      ParentImage: '*\\cmstp.exe'\n  logsource:\n    category: process_creation\n    product: windows\ndetection:\n  condition: 1 of them\nfields:\n- CommandLine\n- ParentCommandLine\n- Details\n", "detection_rule_title": "CMSTP Execution", "detection_rule_author": "Nik Seetharaman", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent", "DN_0014_10_windows_sysmon_ProcessAccess", "DN_0016_12_windows_sysmon_RegistryEvent", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["not defined", "LP_0007_windows_sysmon_ProcessAccess", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3165074919788156710}}
{"date_created": "2019-05-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "ed74fe75-7594-4b4b-ae38-e38e3fd2eb23", "technique": ["T1210: Exploitation of Remote Services"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image:\n    - '*\\mstsc.exe'\n    - '*\\RTSApp.exe'\n    - '*\\RTS2App.exe'\n    - '*\\RDCMan.exe'\n    - '*\\ws_TunnelService.exe'\n    - '*\\RSSensor.exe'\n    - '*\\RemoteDesktopManagerFree.exe'\n    - '*\\RemoteDesktopManager.exe'\n    - '*\\RemoteDesktopManager64.exe'\n    - '*\\mRemoteNG.exe'\n    - '*\\mRemote.exe'\n    - '*\\Terminals.exe'\n    - '*\\spiceworks-finder.exe'\n    - '*\\FSDiscovery.exe'\n    - '*\\FSAssessment.exe'\n    - '*\\MobaRTE.exe'\n    - '*\\chrome.exe'\n    - '*\\thor.exe'\n    - '*\\thor64.exe'\n  selection:\n    DestinationPort: 3389\n    EventID: 3\n    Initiated: 'true'\n", "detection_rule_title": "Suspicious Outbound RDP Connections", "detection_rule_author": "Markus Neis - Swisscom", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection"], "logging_policy": ["LP_0005_windows_sysmon_network_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3403003342762651510}}
{"date_created": "2019-10-25T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "919f2ef0-be2d-4a7a-b635-eb2b41fde044", "technique": ["T1089: Disabling Security Tools"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - EventID: 12\n    TargetObject|contains: \\SYSTEM\\\n    TargetObject|endswith: \\Control\\MiniNt\n  - EventID: 14\n    NewName|contains: \\SYSTEM\\\n    NewName|endswith: \\Control\\MiniNt\nfields:\n- EventID\n- Image\n- TargetObject\n- NewName\n", "detection_rule_title": "Disable security events logging adding reg key MiniNt", "detection_rule_author": "Ilyas Ochkov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0016_12_windows_sysmon_RegistryEvent", "DN_0018_14_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6289833004136972827}}
{"date_created": "2017-03-04T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0004: Privilege Escalation"], "dr_id": "b7967e22-3d7e-409b-9ed5-cdae3f9243a1", "technique": ["T1055: Process Injection"], "raw_detection_rule": "detection:\n  combination1:\n    CallTrace: '*|UNKNOWN(*VBE7.DLL*'\n  combination2:\n    CallTrace: '*|UNKNOWN*'\n    SourceImage: '*\\Microsoft Office\\\\*'\n  condition: selection and 1 of combination*\n  selection:\n    EventID: 10\n    GrantedAccess: '0x1FFFFF'\n    TargetImage: '*\\verclsid.exe'\n", "detection_rule_title": "Malware Shellcode in Verclsid Target Process", "detection_rule_author": "John Lambert (tech), Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0014_10_windows_sysmon_ProcessAccess"], "logging_policy": ["LP_0007_windows_sysmon_ProcessAccess"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5482932195204315214}}
{"date_created": "2017-03-04T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "5f113a8f-8b61-41ca-b90f-d374fa7e4a39", "technique": ["T1055: Process Injection"], "raw_detection_rule": "detection:\n  condition: selection_01 OR (selection_02 AND granted_access)\n  granted_access:\n    GrantedAccess:\n    - '0x1F0FFF'\n    - '0x1F1FFF'\n    - '0x143A'\n    - '0x1410'\n    - '0x1010'\n    - '0x1F2FFF'\n    - '0x1F3FFF'\n    - '0x1FFFFF'\n  selection_01:\n    CallTrace:\n    - C:\\Windows\\SYSTEM32\\ntdll.dll+*|C:\\Windows\\System32\\KERNELBASE.dll+*|UNKNOWN(*)\n    - '*UNKNOWN(*)|UNKNOWN(*)'\n    EventID: 10\n  selection_02:\n    CallTrace: '*UNKNOWN*'\n    EventID: 10\n", "detection_rule_title": "Suspicious In-Memory Module Execution", "detection_rule_author": "Perez Diego (@darkquassar), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0014_10_windows_sysmon_ProcessAccess"], "logging_policy": ["LP_0007_windows_sysmon_ProcessAccess"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5993039101160085166}}
{"date_created": "2018-06-25T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "99b97608-3e21-4bfe-8217-2a127c396a0e", "technique": ["T1085: Rundll32", "T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 8\n    SourceImage: '*\\powershell.exe'\n    TargetImage: '*\\rundll32.exe'\n", "detection_rule_title": "PowerShell Rundll32 Remote Thread Creation", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0012_8_windows_sysmon_CreateRemoteThread"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4996817689412128776}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement", "TA0006: Credential Access"], "dr_id": "c0478ead-5336-46c2-bd5e-b4c84bc3a36e", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selector | near dllload1 and dllload2 and not exclusion\n  dllload1:\n    ImageLoaded: '*\\vaultcli.dll'\n  dllload2:\n    ImageLoaded: '*\\wlanapi.dll'\n  exclusion:\n    ImageLoaded:\n    - ntdsapi.dll\n    - netapi32.dll\n    - imm32.dll\n    - samlib.dll\n    - combase.dll\n    - srvcli.dll\n    - shcore.dll\n    - ntasn1.dll\n    - cryptdll.dll\n    - logoncli.dll\n  selector:\n    EventID: 7\n    Image: C:\\Windows\\System32\\rundll32.exe\n  timeframe: 30s\n", "detection_rule_title": "Mimikatz In-Memory", "detection_rule_author": "not defined", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -9148129673413021758}}
{"date_created": "2018-07-24T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "e074832a-eada-4fd7-94a1-10642b130e16", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 11\n    TargetFilename: '*\\Temp\\debug.bin'\n", "detection_rule_title": "Detection of SafetyKatz", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0015_11_windows_sysmon_FileCreate"], "logging_policy": ["LP_0008_windows_sysmon_FileCreate"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1622461976416330384}}
{"date_created": "2019-10-25T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "4f84b697-c9ed-4420-8ab5-e09af5b2345d", "technique": ["T1103: AppInit DLLs"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - EventID:\n    - 12\n    - 13\n    TargetObject|contains: \\SOFTWARE\\\n    TargetObject|endswith: \\Windows\\AppInit_Dlls\n  - EventID: 14\n    NewName|contains: \\SOFTWARE\\\n    NewName|endswith: \\Windows\\AppInit_Dlls\nfields:\n- EventID\n- Image\n- TargetObject\n- NewName\n", "detection_rule_title": "New DLL added to AppInit_DLLs registry key", "detection_rule_author": "Ilyas Ochkov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent", "DN_0016_12_windows_sysmon_RegistryEvent", "DN_0018_14_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8147019887155468940}}
{"date_created": "2019-09-12T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "58cb02d5-78ce-4692-b3e1-dce850aae41a", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image|startswith: \\powershell.exe\n  selection:\n    EventID: 17\n    PipeName|startswith: \\PSHost\n", "detection_rule_title": "T1086 Alternate PowerShell Hosts", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0020_17_windows_sysmon_PipeEvent"], "logging_policy": ["LP_0009_windows_sysmon_PipeEvent"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2248621698326702691}}
{"date_created": "2019-11-18T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67", "technique": ["T1036: Masquerading"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image:\n    - '*\\procdump.exe'\n    - '*\\procdump64.exe'\n  selection:\n    OriginalFileName: procdump\n", "detection_rule_title": "Renamed ProcDump", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded", "DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded", "LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6994545877235463015}}
{"date_created": "2017-08-28T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "25ffa65d-76d8-4da5-a832-3f2b0136e133", "technique": ["not defined"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    selection1:\n      EventID: 13\n      TargetObject: '*\\EulaAccepted'\n  logsource:\n    product: windows\n    service: sysmon\n- detection:\n    selection2:\n      CommandLine: '* -accepteula*'\n  logsource:\n    category: process_creation\n    product: windows\ndetection:\n  condition: 1 of them\n", "detection_rule_title": "Usage of Sysinternals Tools", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["not defined", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8797852584182512369}}
{"date_created": "2019-04-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "fe21810c-2a8c-478f-8dd3-5a287fb2a0e0", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Destination:\n    - '*new-object system.net.webclient).downloadstring(*'\n    - '*new-object system.net.webclient).downloadfile(*'\n    - '*new-object net.webclient).downloadstring(*'\n    - '*new-object net.webclient).downloadfile(*'\n    - '* iex(*'\n    - '*WScript.shell*'\n    - '* -nop *'\n    - '* -noprofile *'\n    - '* -decode *'\n    - '* -enc *'\n    EventID: 20\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious Scripting in a WMI Consumer", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0023_20_windows_sysmon_WmiEvent"], "logging_policy": ["LP_0010_windows_sysmon_WmiEvent"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 286791940806979660}}
{"date_created": "2018-04-11T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0004: Privilege Escalation", "TA0003: Persistence", "TA0005: Defense Evasion"], "dr_id": "36803969-5421-41ec-b92f-8500f79c23b0", "technique": ["T1183: Image File Execution Options Injection"], "raw_detection_rule": "detection:\n  condition: selection_reg1\n  selection_reg1:\n    EventID: 13\n    EventType: SetValue\n    TargetObject:\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\\\*\\GlobalFlag'\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\\\*\\ReportingMode'\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\\\*\\MonitorProcess'\n", "detection_rule_title": "Registry Persistence Mechanisms", "detection_rule_author": "Karneades", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8176196470255996993}}
{"date_created": "2019-10-25T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0011: Command and Control"], "dr_id": "eb07e747-2552-44cd-af36-b659ae0958e4", "technique": ["T1043: Commonly Used Port"], "raw_detection_rule": "detection:\n  condition: (dns_answer and filter_int_ip) and (dns_answer and not filter_int_ip)\n    | count(QueryName) by ComputerName > 3\n  dns_answer:\n    EventID: 22\n    QueryName: '*'\n    QueryStatus: '0'\n  filter_int_ip:\n    QueryResults|startswith:\n    - (::ffff:)?10.\n    - (::ffff:)?192.168.\n    - (::ffff:)?172.16.\n    - (::ffff:)?172.17.\n    - (::ffff:)?172.18.\n    - (::ffff:)?172.19.\n    - (::ffff:)?172.20.\n    - (::ffff:)?172.21.\n    - (::ffff:)?172.22.\n    - (::ffff:)?172.23.\n    - (::ffff:)?172.24.\n    - (::ffff:)?172.25.\n    - (::ffff:)?172.26.\n    - (::ffff:)?172.27.\n    - (::ffff:)?172.28.\n    - (::ffff:)?172.29.\n    - (::ffff:)?172.30.\n    - (::ffff:)?172.31.\n    - (::ffff:)?127.\n  timeframe: 30s\n", "detection_rule_title": "Possible DNS Rebinding", "detection_rule_author": "Ilyas Ochkov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0085_22_windows_sysmon_DnsQuery"], "logging_policy": ["LP_0011_windows_sysmon_DnsQuery"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3123689394218400645}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "1f21ec3f-810d-4b0e-8045-322202e22b4b", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    DestinationIp:\n    - 10.*\n    - 192.168.*\n    - 172.16.*\n    - 172.17.*\n    - 172.18.*\n    - 172.19.*\n    - 172.20.*\n    - 172.21.*\n    - 172.22.*\n    - 172.23.*\n    - 172.24.*\n    - 172.25.*\n    - 172.26.*\n    - 172.27.*\n    - 172.28.*\n    - 172.29.*\n    - 172.30.*\n    - 172.31.*\n    - 127.0.0.1\n    DestinationIsIpv6: 'false'\n    User: NT AUTHORITY\\SYSTEM\n  selection:\n    EventID: 3\n    Image: '*\\powershell.exe'\n    Initiated: 'true'\n", "detection_rule_title": "PowerShell Network Connections", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "low", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection"], "logging_policy": ["LP_0005_windows_sysmon_network_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4160480488720886794}}
{"date_created": "2019-02-21T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "52753ea4-b3a0-4365-910d-36cff487b789", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 11\n    Image: '*\\mstsc.exe'\n    TargetFileName: '*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\\*'\n", "detection_rule_title": "Hijack legit RDP session to move laterally", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0015_11_windows_sysmon_FileCreate"], "logging_policy": ["LP_0008_windows_sysmon_FileCreate"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1299057940262461674}}
{"date_created": "2018-11-30T00:00:00", "date_modified": "2019-11-08T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "6309645e-122d-4c5b-bb2b-22e4f9c2fa42", "technique": ["T1055: Process Injection"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 8\n    TargetProcessAddress|endswith:\n    - 0B80\n    - 0C7C\n    - 0C88\n", "detection_rule_title": "CobaltStrike Process Injection", "detection_rule_author": "Olaf Hartong, Florian Roth, Aleksey Potapov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0012_8_windows_sysmon_CreateRemoteThread"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5370823344806947069}}
{"date_created": "2019-05-21T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image:\n    - '*\\PsExec.exe'\n    - '*\\PsExec64.exe'\n  selection:\n    Description: Execute processes remotely\n    Product: Sysinternals PsExec\n", "detection_rule_title": "Renamed PsExec", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded", "DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded", "LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8787315331834977976}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "2c4523d5-d481-4ed0-8ec3-7fbf0cb41a75", "technique": ["T1050: New Service"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 6\n    ImageLoaded: '*\\Temp\\\\*'\n", "detection_rule_title": "Suspicious Driver Load from Temp", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0010_6_windows_sysmon_driver_loaded"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5558093171101193583}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0008: Lateral Movement"], "dr_id": "0a98a10c-685d-4ab0-bddc-b6bdd1d48458", "technique": ["T1037: Logon Scripts"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    condition: exec_selection and not exec_exclusion1 and not exec_exclusion2\n    exec_exclusion1:\n      Image: '*\\explorer.exe'\n    exec_exclusion2:\n      CommandLine: '*\\netlogon.bat'\n    exec_selection:\n      ParentImage: '*\\userinit.exe'\n  logsource:\n    category: process_creation\n    product: windows\n- detection:\n    condition: create_keywords_cli\n    create_keywords_cli:\n      CommandLine: '*UserInitMprLogonScript*'\n  logsource:\n    category: process_creation\n    product: windows\n- detection:\n    condition: create_selection_reg and create_keywords_reg\n    create_keywords_reg:\n      TargetObject: '*UserInitMprLogonScript*'\n    create_selection_reg:\n      EventID:\n      - 11\n      - 12\n      - 13\n      - 14\n  logsource:\n    product: windows\n    service: sysmon\n", "detection_rule_title": "Logon Scripts (UserInitMprLogonScript)", "detection_rule_author": "Tom Ueltschi (@c_APT_ure)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0015_11_windows_sysmon_FileCreate", "DN_0017_13_windows_sysmon_RegistryEvent", "DN_0016_12_windows_sysmon_RegistryEvent", "DN_0003_1_windows_sysmon_process_creation", "DN_0018_14_windows_sysmon_RegistryEvent", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["LP_0008_windows_sysmon_FileCreate", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 186899902412262874}}
{"date_created": "2018-03-07T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "05936ce2-ee05-4dae-9d03-9a391cf2d2c6", "technique": ["T1084: Windows Management Instrumentation Event Subscription"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 7\n    Image: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\n    ImageLoaded: wbemcons.dll\n", "detection_rule_title": "WMI Persistence - Command Line Event Consumer", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5100620732693497938}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "f239b326-2f41-4d6b-9dfa-c846a60ef505", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 8\n    StartModule: null\n    TargetImage: C:\\Windows\\System32\\lsass.exe\n", "detection_rule_title": "Password Dumper Remote Thread in LSASS", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0012_8_windows_sysmon_CreateRemoteThread"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4321384810496264258}}
{"date_created": "2019-11-01T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "961d0ba2-3eea-4303-a930-2cf78bbfcc5e", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 17\n    PipeName|contains:\n    - \\lsadump\n    - \\cachedump\n    - \\wceservicepipe\n", "detection_rule_title": "Cred dump-tools named pipes", "detection_rule_author": "Teymur Kheirkhabarov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0020_17_windows_sysmon_PipeEvent"], "logging_policy": ["LP_0009_windows_sysmon_PipeEvent"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7953229426404337068}}
{"date_created": "2019-10-25T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "f663a6d9-9d1b-49b8-b2b1-0637914d199a", "technique": ["T1060: Registry Run Keys / Startup Folder"], "raw_detection_rule": "detection:\n  condition: 1 of them\n  selection1:\n    EventID: 12\n    EventType: DeleteValue\n    TargetObject|endswith: \\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\DelegateExecute\n  selection2:\n    EventID: 13\n    TargetObject|endswith: \\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\(Default)\n", "detection_rule_title": "Narrator's Feedback-Hub Persistence", "detection_rule_author": "Dmitriy Lifanov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent", "DN_0016_12_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4481220042537468149}}
{"date_created": "2019-11-14T00:00:00", "date_modified": "2019-11-30T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "092bc4b9-3d1d-43b4-a6b4-8c8acd83522f", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\powershell.exe\n    - \\WINDOWS\\System32\\sdiagnhost.exe\n    User: NT AUTHORITY\\SYSTEM\n  selection:\n    EventID: 7\n    ImageLoaded|endswith:\n    - \\System.Management.Automation.Dll\n    - \\System.Management.Automation.ni.Dll\nenrichment:\n- EN_0001_cache_sysmon_event_id_1_info\n- EN_0003_enrich_other_sysmon_events_with_event_id_1_data\n", "detection_rule_title": "In-memory PowerShell", "detection_rule_author": "Tom Kern, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded", "DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded", "LP_0003_windows_sysmon_process_creation"], "enrichment": ["EN_0001_cache_sysmon_event_id_1_info", "EN_0003_enrich_other_sysmon_events_with_event_id_1_data"], "enrichment_requirements": ["not defined", ["EN_0001_cache_sysmon_event_id_1_info"]]}
{"index": {"_id": 605524321284059893}}
{"date_created": "2019-10-25T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0002: Execution", "TA0005: Defense Evasion"], "dr_id": "c7e91a02-d771-4a6d-a700-42587e0b1095", "technique": ["T1117: Regsvr32"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 3\n    - 22\n    Image|endswith: \\regsvr32.exe\n", "detection_rule_title": "Regsvr32 network activity", "detection_rule_author": "Dmitriy Lifanov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection", "DN_0085_22_windows_sysmon_DnsQuery"], "logging_policy": ["LP_0005_windows_sysmon_network_connection", "LP_0011_windows_sysmon_DnsQuery"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8930148530388663272}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "5ef9853e-4d0e-4a70-846f-a9ca37d876da", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    CallTrace:\n    - '*dbghelp.dll*'\n    - '*dbgcore.dll*'\n    EventID: 10\n    GrantedAccess: '0x1fffff'\n    TargetImage: C:\\windows\\system32\\lsass.exe\n", "detection_rule_title": "LSASS Memory Dump", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0014_10_windows_sysmon_ProcessAccess"], "logging_policy": ["LP_0007_windows_sysmon_ProcessAccess"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4643043398522715232}}
{"date_created": "2019-09-12T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "c539afac-c12a-46ed-b1bd-5a5567c9f045", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    User: NT AUTHORITY\\NETWORK SERVICE\n  selection:\n    DestinationPort:\n    - 5985\n    - 5986\n    EventID: 3\n", "detection_rule_title": "T1086 Remote PowerShell Session", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection"], "logging_policy": ["LP_0005_windows_sysmon_network_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3442270312007310831}}
{"date_created": "2017-05-08T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "e61e8a88-59a9-451c-874e-70fcc9740d67", "technique": ["T1073: DLL Side-Loading"], "raw_detection_rule": "action: global\nadditions:\n- detection:\n    dnsregmod:\n      EventID: 13\n      TargetObject: '*\\services\\DNS\\Parameters\\ServerLevelPluginDll'\n  logsource:\n    product: windows\n    service: sysmon\n- detection:\n    dnsadmin:\n      CommandLine: dnscmd.exe /config /serverlevelplugindll *\n  logsource:\n    category: process_creation\n    product: windows\ndetection:\n  condition: 1 of them\nfields:\n- EventID\n- CommandLine\n- ParentCommandLine\n- Image\n- User\n- TargetObject\n", "detection_rule_title": "DNS ServerLevelPluginDll Install", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs", "Windows Log"], "channel": ["Microsoft-Windows-Sysmon/Operational", "Security"], "provider": ["Microsoft-Windows-Sysmon", "Microsoft-Windows-Security-Auditing"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent", "DN_0003_1_windows_sysmon_process_creation", "DN_0002_4688_windows_process_creation_with_commandline"], "logging_policy": ["not defined", "LP_0003_windows_sysmon_process_creation", "LP_0002_windows_audit_process_creation_with_commandline", "LP_0001_windows_audit_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5067134159772704375}}
{"date_created": "2018-11-22T00:00:00", "date_modified": "2019-11-09T00:00:00", "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "9637e8a5-7131-4f7f-bdc7-2b05d8670c43", "technique": ["T1064: Scripting"], "raw_detection_rule": "detection:\n  condition: 1 of them\n  selection1:\n    Description: \\?\n    FileVersion: \\?\n  selection2:\n    Description: \\?\n    Product: \\?\n  selection3:\n    Company: \\?\n    Description: \\?\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "Suspicious File Characteristics due to Missing Fields", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded", "DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded", "LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 3567997558794190647}}
{"date_created": "2018-06-03T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "b69888d4-380c-45ce-9cf9-d9ce46e67821", "technique": ["T1027: Obfuscated Files or Information"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Imphash: '00000000000000000000000000000000'\n  selection:\n    EventID: 15\nfields:\n- TargetFilename\n- Image\n", "detection_rule_title": "Executable in ADS", "detection_rule_author": "Florian Roth, @0xrawsec", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0019_15_windows_sysmon_FileCreateStreamHash"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8213076682966080982}}
{"date_created": "2018-02-10T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "847def9e-924d-4e90-b7c4-5f581395a2b4", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 11\n    TargetFilename: '*\\AppData\\Local\\Temp\\SAM-*.dmp*'\n", "detection_rule_title": "QuarksPwDump Dump File", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0015_11_windows_sysmon_FileCreate"], "logging_policy": ["LP_0008_windows_sysmon_FileCreate"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6433656173639440128}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0004: Privilege Escalation"], "dr_id": "5b872a46-3b90-45c1-8419-f675db8053aa", "technique": ["T1088: Bypass User Account Control"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 13\n    TargetObject: HKEY_USERS\\\\*\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand\n", "detection_rule_title": "UAC Bypass via sdclt", "detection_rule_author": "Omer Yampel", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5572946821146682081}}
{"date_created": "2019-10-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "db809f10-56ce-4420-8c86-d6a7d793c79c", "technique": ["T1006: File System Logical Offsets"], "raw_detection_rule": "detection:\n  condition: selection and not filter_1 and not filter_2\n  filter_1:\n    Device|contains: floppy\n  filter_2:\n  - Image|endswith:\n    - \\wmiprvse.exe\n    - \\sdiagnhost.exe\n    - \\searchindexer.exe\n    - \\csrss.exe\n    - \\defrag.exe\n    - \\smss.exe\n    - \\vssvc.exe\n    - \\compattelrunner.exe\n    - \\wininit.exe\n    - \\autochk.exe\n    - \\taskhost.exe\n    - \\dfsrs.exe\n    - \\vds.exe\n    - \\lsass.exe\n  selection:\n    EventID: 9\n", "detection_rule_title": "Raw disk access using illegitimate tools", "detection_rule_author": "Teymur Kheirkhabarov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0013_9_windows_sysmon_RawAccessRead"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7231648646386789854}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "2e4e488a-6164-4811-9ea1-f960c7359c40", "technique": ["T1055: Process Injection", "T1064: Scripting"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 8\n    SourceImage:\n    - '*\\System32\\cscript.exe'\n    - '*\\System32\\wscript.exe'\n    - '*\\System32\\mshta.exe'\n    - '*\\winword.exe'\n    - '*\\excel.exe'\n    StartModule: null\n    TargetImage: '*\\SysWOW64\\\\*'\n", "detection_rule_title": "CACTUSTORCH Remote Thread Creation", "detection_rule_author": "@SBousseaden (detection), Thomas Patzke (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0012_8_windows_sysmon_CreateRemoteThread"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5920290110290525155}}
{"date_created": "2018-08-30T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "e0f8ab85-0ac9-423b-a73a-81b3c7b1aa97", "technique": ["T1105: Remote File Copy"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    DestinationHostname:\n    - '*dl.dropboxusercontent.com'\n    - '*.pastebin.com'\n    - '*.githubusercontent.com'\n    EventID: 3\n    Image: C:\\Windows\\\\*\n    Initiated: 'true'\n", "detection_rule_title": "Microsoft Binary Suspicious Communication Endpoint", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection"], "logging_policy": ["LP_0005_windows_sysmon_network_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8290608307455814350}}
{"date_created": "2019-11-01T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "8fbf3271-1ef6-4e94-8210-03c2317947f6", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 11\n    TargetFilename|contains:\n    - \\pwdump\n    - \\kirbi\n    - \\pwhashes\n    - \\wce_ccache\n    - \\wce_krbtkts\n    - \\fgdump-log\n    TargetFilename|endswith:\n    - \\test.pwd\n    - \\lsremora64.dll\n    - \\lsremora.dll\n    - \\fgexec.exe\n    - \\wceaux.dll\n    - \\SAM.out\n    - \\SECURITY.out\n    - \\SYSTEM.out\n    - \\NTDS.out\n    - \\DumpExt.dll\n    - \\DumpSvc.exe\n    - \\cachedump64.exe\n    - \\cachedump.exe\n    - \\pstgdump.exe\n    - \\servpw.exe\n    - \\servpw64.exe\n    - \\pwdump.exe\n", "detection_rule_title": "Cred dump tools dropped files", "detection_rule_author": "Teymur Kheirkhabarov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0015_11_windows_sysmon_FileCreate"], "logging_policy": ["LP_0008_windows_sysmon_FileCreate"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8899482612948935595}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "635dbb88-67b3-4b41-9ea5-a3af2dd88153", "technique": ["T1105: Remote File Copy"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    DestinationHostname:\n    - '*.github.com'\n    - '*.githubusercontent.com'\n    EventID: 3\n    Image: C:\\Windows\\\\*\n    Initiated: 'true'\n", "detection_rule_title": "Microsoft Binary Github Communication", "detection_rule_author": "Michael Haag (idea), Florian Roth (rule)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection"], "logging_policy": ["LP_0005_windows_sysmon_network_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1193569343044837044}}
{"date_created": "2017-03-19T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0011: Command and Control"], "dr_id": "4b89abaa-99fe-4232-afdd-8f9aa4d20382", "technique": ["T1043: Commonly Used Port"], "raw_detection_rule": "detection:\n  condition: selection and not ( filter1 or filter2 )\n  filter1:\n    Image: '*\\Program Files*'\n  filter2:\n    DestinationIp:\n    - 10.*\n    - 192.168.*\n    - 172.16.*\n    - 172.17.*\n    - 172.18.*\n    - 172.19.*\n    - 172.20.*\n    - 172.21.*\n    - 172.22.*\n    - 172.23.*\n    - 172.24.*\n    - 172.25.*\n    - 172.26.*\n    - 172.27.*\n    - 172.28.*\n    - 172.29.*\n    - 172.30.*\n    - 172.31.*\n    - 127.*\n    DestinationIsIpv6: 'false'\n  selection:\n    DestinationPort:\n    - '4443'\n    - '2448'\n    - '8143'\n    - '1777'\n    - '1443'\n    - '243'\n    - '65535'\n    - '13506'\n    - '3360'\n    - '200'\n    - '198'\n    - '49180'\n    - '13507'\n    - '6625'\n    - '4444'\n    - '4438'\n    - '1904'\n    - '13505'\n    - '13504'\n    - '12102'\n    - '9631'\n    - '5445'\n    - '2443'\n    - '777'\n    - '13394'\n    - '13145'\n    - '12103'\n    - '5552'\n    - '3939'\n    - '3675'\n    - '666'\n    - '473'\n    - '5649'\n    - '4455'\n    - '4433'\n    - '1817'\n    - '100'\n    - '65520'\n    - '1960'\n    - '1515'\n    - '743'\n    - '700'\n    - '14154'\n    - '14103'\n    - '14102'\n    - '12322'\n    - '10101'\n    - '7210'\n    - '4040'\n    - '9943'\n    EventID: 3\n    Initiated: 'true'\n", "detection_rule_title": "Suspicious Typical Malware Back Connect Ports", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection"], "logging_policy": ["LP_0005_windows_sysmon_network_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3909341110638238369}}
{"date_created": "2019-01-12T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "0f06a3a5-6a09-413f-8743-e6cf35561297", "technique": ["T1084: Windows Management Instrumentation Event Subscription"], "raw_detection_rule": "detection:\n  condition: selector\n  selector:\n    EventID:\n    - 19\n    - 20\n    - 21\n", "detection_rule_title": "WMI Event Subscription", "detection_rule_author": "Tom Ueltschi (@c_APT_ure)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0023_20_windows_sysmon_WmiEvent", "DN_0024_21_windows_sysmon_WmiEvent", "DN_0022_19_windows_sysmon_WmiEvent"], "logging_policy": ["LP_0010_windows_sysmon_WmiEvent"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 816235354502916360}}
{"date_created": "2019-10-21T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "17f878b8-9968-4578-b814-c4217fc5768c", "technique": ["T1060: Registry Run Keys / Startup Folder"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 13\n    TargetObject|contains:\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\Run\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\RunServices\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce\n    - \\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit\n    - \\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell\n    - \\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\n    - \\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\n", "detection_rule_title": "Autorun keys modification", "detection_rule_author": "Victor Sergeev, Daniil Yugoslavskiy, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 88671123592015546}}
{"date_created": "2018-03-07T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "33f41cdd-35ac-4ba8-814b-c6a4244a1ad4", "technique": ["T1084: Windows Management Instrumentation Event Subscription"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 11\n    Image: C:\\WINDOWS\\system32\\wbem\\scrcons.exe\n", "detection_rule_title": "WMI Persistence - Script Event Consumer File Write", "detection_rule_author": "Thomas Patzke", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0015_11_windows_sysmon_FileCreate"], "logging_policy": ["LP_0008_windows_sysmon_FileCreate"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4526367153381256642}}
{"date_created": "2017-11-04T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0002: Execution"], "dr_id": "cdc8da7d-c303-42f8-b08c-b4ab47230263", "technique": ["T1085: Rundll32"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    DestinationIp:\n    - 10.*\n    - 192.168.*\n    - 172.16.*\n    - 172.17.*\n    - 172.18.*\n    - 172.19.*\n    - 172.20.*\n    - 172.21.*\n    - 172.22.*\n    - 172.23.*\n    - 172.24.*\n    - 172.25.*\n    - 172.26.*\n    - 172.27.*\n    - 172.28.*\n    - 172.29.*\n    - 172.30.*\n    - 172.31.*\n    - 127.*\n  selection:\n    EventID: 3\n    Image: '*\\rundll32.exe'\n    Initiated: 'true'\n", "detection_rule_title": "Rundll32 Internet Connection", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection"], "logging_policy": ["LP_0005_windows_sysmon_network_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1966563306797601296}}
{"date_created": "2019-10-28T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence", "TA0005: Defense Evasion"], "dr_id": "602a1f13-c640-4d73-b053-be9a2fa58b77", "technique": ["T1073: DLL Side-Loading", "T1038: DLL Search Order Hijacking", "T1112: Modify Registry"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    EventID: 7\n    Image:\n    - '*\\svchost.exe'\n    ImageLoaded:\n    - C:\\Windows\\WinSxS\\*\n  selection:\n    EventID: 7\n    Image:\n    - '*\\svchost.exe'\n    ImageLoaded:\n    - '*\\tsmsisrv.dll'\n    - '*\\tsvipsrv.dll'\n    - '*\\wlbsctrl.dll'\n", "detection_rule_title": "Svchost DLL Search Order Hijack", "detection_rule_author": "SBousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4294236027767490816}}
{"date_created": "2017-11-06T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0004: Privilege Escalation"], "dr_id": "fe3ac066-98bb-432a-b1e7-a5229cb39d4a", "technique": ["T1055: Process Injection"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 17\n    - 18\n    PipeName:\n    - \\isapi_http\n    - \\isapi_dg\n    - \\isapi_dg2\n    - \\sdlrpc\n    - \\ahexec\n    - \\winsession\n    - \\lsassw\n    - \\46a676ab7f179e511e30dd2dc41bd388\n    - \\9f81f59bc58452127884ce513865ed20\n    - \\e710f28d59aa529d6792ca6ff0ca1b34\n    - \\rpchlp_3\n    - \\NamePipe_MoreWindows\n    - \\pcheap_reuse\n    - \\msagent_*\n", "detection_rule_title": "Malicious Named Pipe", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0021_18_windows_sysmon_PipeEvent", "DN_0020_17_windows_sysmon_PipeEvent"], "logging_policy": ["LP_0009_windows_sysmon_PipeEvent"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4699964492588775402}}
{"date_created": "2019-09-12T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "867613fb-fa60-4497-a017-a82df74a172c", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Description: system.management.automation\n    EventID: 7\n    ImageLoaded|contains: system.management.automation\n", "detection_rule_title": "T1086 PowerShell Execution", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2744930519996704883}}
{"date_created": "2019-08-11T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "052ec6f6-1adc-41e6-907a-f1c813478bee", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 8\n    StartFunction: LoadLibraryA\n    StartModule|endswith: \\kernel32.dll\n", "detection_rule_title": "T1055 CreateRemoteThread API and LoadLibrary", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0012_8_windows_sysmon_CreateRemoteThread"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6480069235482031615}}
{"date_created": "2019-10-23T00:00:00", "date_modified": "2019-11-07T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "9b0f8a61-91b2-464f-aceb-0527e0a45020", "technique": ["T1122: Component Object Model Hijacking"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 12\n    TargetObject|contains: _Classes\\CLSID\\\n    TargetObject|endswith: \\TreatAs\n    TargetObject|startswith: HKU\\\n", "detection_rule_title": "Windows Registry Persistence - COM key linking", "detection_rule_author": "Kutepov Anton, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0016_12_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4922419170711952667}}
{"date_created": "2017-02-16T00:00:00", "date_modified": "2019-11-08T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "32d0d3e2-e58d-4d41-926b-18b520b2b32d", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    ProcessName|endswith:\n    - \\wmiprvse.exe\n    - \\taskmgr.exe\n    - \\procexp64.exe\n    - \\procexp.exe\n    - \\lsm.exe\n    - \\csrss.exe\n    - \\wininit.exe\n    - \\vmtoolsd.exe\n  selection:\n    EventID: 10\n    GrantedAccess|contains:\n    - '0x40'\n    - '0x1000'\n    - '0x1400'\n    - '0x100000'\n    - '0x1410'\n    - '0x1010'\n    - '0x1438'\n    - '0x143a'\n    - '0x1418'\n    - '0x1f0fff'\n    - '0x1f1fff'\n    - '0x1f2fff'\n    - '0x1f3fff'\n    TargetImage|endswith: \\lsass.exe\n", "detection_rule_title": "Credentials Dumping tools accessing LSASS memory", "detection_rule_author": "Florian Roth, Roberto Rodriguez, Dimitrios Slamaris, Mark Russinovich, Thomas Patzke, Teymur Kheirkhabarov, Sherif Eldeeb, James Dickenson, Aleksey Potapov, oscd.community (update)", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0014_10_windows_sysmon_ProcessAccess"], "logging_policy": ["LP_0007_windows_sysmon_ProcessAccess"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2484304943202152055}}
{"date_created": "2018-07-18T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "b7916c2a-fa2f-4795-9477-32b731f70f11", "technique": ["T1060: Registry Run Keys / Startup Folder"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Details:\n    - C:\\Windows\\Temp\\\\*\n    - C:\\ProgramData\\\\*\n    - '*\\AppData\\\\*'\n    - C:\\$Recycle.bin\\\\*\n    - C:\\Temp\\\\*\n    - C:\\Users\\Public\\\\*\n    - C:\\Users\\Default\\\\*\n    EventID: 13\n    TargetObject: '*\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run'\nfields:\n- Image\n- ParentImage\n", "detection_rule_title": "Registry Persistence via Explorer Run Key", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -8147019887155468940}}
{"date_created": "2019-09-12T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "f67f6c57-257d-4919-a416-69cd31f9aac3", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image|endswith: \\powershell.exe\n  selection:\n    Description: system.management.automation\n    EventID: 7\n    ImageLoaded|contains: system.management.automation\n", "detection_rule_title": "T1086 Alternate PowerShell Hosts", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4699964492588775402}}
{"date_created": "2019-09-12T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "d32b53ce-2a41-4db0-a42a-fb574d819d97", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 17\n    PipeName|startswith: \\PSHost\n", "detection_rule_title": "T1086 PowerShell Execution", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0020_17_windows_sysmon_PipeEvent"], "logging_policy": ["LP_0009_windows_sysmon_PipeEvent"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7854193186451181694}}
{"date_created": "2017-03-19T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "7b434893-c57d-4f41-908d-6a17bf1ae98f", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 3\n    Image:\n    - '*\\$Recycle.bin'\n    - '*\\Users\\All Users\\\\*'\n    - '*\\Users\\Default\\\\*'\n    - '*\\Users\\Public\\\\*'\n    - '*\\Users\\Contacts\\\\*'\n    - '*\\Users\\Searches\\\\*'\n    - C:\\Perflogs\\\\*\n    - '*\\config\\systemprofile\\\\*'\n    - '*\\Windows\\Fonts\\\\*'\n    - '*\\Windows\\IME\\\\*'\n    - '*\\Windows\\addins\\\\*'\n", "detection_rule_title": "Suspicious Program Location with Network Connections", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection"], "logging_policy": ["LP_0005_windows_sysmon_network_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 2248554697534798087}}
{"date_created": "2018-01-07T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "e32ce4f5-46c6-4c47-ba69-5de3c9193cd7", "technique": ["T1073: DLL Side-Loading"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 7\n    Image:\n    - '*\\notepad.exe'\n    ImageLoaded:\n    - '*\\samlib.dll'\n    - '*\\WinSCard.dll'\n", "detection_rule_title": "Possible Process Hollowing Image Loading", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7379277437830493326}}
{"date_created": "2019-10-22T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "857c8db3-c89b-42fb-882b-f681c7cf4da2", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 7\n    Image|endswith: \\lsass.exe\n    Signed: 'false'\n", "detection_rule_title": "Unsigned image loaded into LSASS process", "detection_rule_author": "Teymur Kheirkhabarov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 1049637743330188870}}
{"date_created": "2019-10-12T00:00:00", "date_modified": "2019-10-15T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "34aa0252-6039-40ff-951f-939fd6ce47d8", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection_registry\n  selection_registry:\n    Details:\n    - 00000429\n    - 00050429\n    - 0000042a\n    EventID: 13\n    TargetObject:\n    - '*\\Keyboard Layout\\Preload\\*'\n    - '*\\Keyboard Layout\\Substitutes\\*'\n", "detection_rule_title": "Suspicious Keyboard Layout Load", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -1144051364305199437}}
{"date_created": "2019-10-01T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "9c5037d1-c568-49b3-88c7-9846a5bdc2be", "technique": ["T1060: Registry Run Keys / Startup Folder"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 13\n    Image:\n    - '*\\Downloads\\\\*'\n    - '*\\Temporary Internet Files\\Content.Outlook\\\\*'\n    - '*\\Local Settings\\Temporary Internet Files\\\\*'\n    TargetObject: '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\\*'\n", "detection_rule_title": "Suspicious RUN Key from Download", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7145330661141462140}}
{"date_created": "2019-10-01T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "66d31e5f-52d6-40a4-9615-002d3789a119", "technique": ["T1055: Process Injection"], "raw_detection_rule": "detection:\n  condition: selection AND NOT filter\n  filter:\n    SourceImage|contains: Visual Studio\n  selection:\n    EventID: 8\n    SourceImage|endswith:\n    - \\msbuild.exe\n    - \\powershell.exe\n    - \\word.exe\n    - \\excel.exe\n    - \\powerpnt.exe\n    - \\outlook.exe\n    - \\mspaint.exe\n    - \\winscp.exe\n    - \\w3wp.exe*\n    - \\ping.exe\n    - \\taskhost.exe\n    - \\monitoringhost.exe\n    - \\wmic.exe\n    - \\find.exe\n    - \\findstr.exe\n    - \\smartscreen.exe\n    - \\gpupdate.exe\n    - \\iexplore.exe\n    - \\explorer.exe\n    - \\sapcimc.exe\n    - \\msiexec.exe\n    - \\git.exe\n    - \\vssvc.exe\n    - \\vssadmin.exe\n    - \\lync.exe\n    - \\python.exe\n    - \\provtool.exe\n    - \\robocopy.exe\n    - \\userinit.exe\n    - \\runonce.exe\n    - \\winlogon.exe\n    - \\defrag.exe\n    - \\bash.exe\n    - \\spoolsv.exe\n    - \\cvtres.exe\n    - \\esentutl.exe\n    - \\wscript.exe\n    - \\expand.exe\n    - \\forfiles.exe\n    - \\hh.exe\n    - \\installutil.exe\n    - \\makecab.exe\n    - \\mshta.exe\n    - \\regsvr32.exe\n    - \\schtasks.exe\n    - \\dnx.exe\n    - \\mDNSResponder.exe\n    - \\tstheme.exe\nnotes:\n- MonitoringHost.exe is a process that loads .NET CLR by default and thus a favorite\n  for process injection for .NET in-memory offensive tools.\n", "detection_rule_title": "Suspicious Remote Thread Created", "detection_rule_author": "Perez Diego (@darkquassar), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0012_8_windows_sysmon_CreateRemoteThread"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -7630429428754542968}}
{"date_created": "2019-10-16T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "b3503044-60ce-4bf4-bbcb-e3db98788823", "technique": ["T1177: LSASS Driver"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID:\n    - 12\n    - 13\n    TargetObject:\n    - '*\\CurrentControlSet\\Services\\NTDS\\DirectoryServiceExtPt*'\n    - '*\\CurrentControlSet\\Services\\NTDS\\LsaDbExtPt*'\n", "detection_rule_title": "DLL Load via LSASS", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent", "DN_0016_12_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6241711812778333293}}
{"date_created": "2019-09-12T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "41904ebe-d56c-4904-b9ad-7a77bdf154b3", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000000)\n    EventID: 13\n    TargetObject|endswith:\n    - \\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\UserAuthentication\n    - \\CurrentControlSet\\Control\\Terminal Server\\fDenyTSConnections\n", "detection_rule_title": "T1112 RDP Registry Modification", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -606058010513721673}}
{"date_created": "2019-10-22T00:00:00", "date_modified": "2019-11-04T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "39f1f9f2-9636-45de-98f6-a4046aa8e4b9", "technique": ["T1100: Web Shell"], "raw_detection_rule": "detection:\n  condition: selection_1 and ( selection_2 and selection_3 ) or selection_1 and (\n    selection_4 and selection_5 ) or selection_1 and selection_6\n  selection_1:\n    EventID: 11\n  selection_2:\n    TargetFilename|contains: \\inetpub\\wwwroot\\\n  selection_3:\n    TargetFilename|contains:\n    - .asp\n    - .ashx\n    - .ph\n  selection_4:\n    TargetFilename|contains:\n    - \\www\\\n    - \\htdocs\\\n    - \\html\\\n  selection_5:\n    TargetFilename|contains: .ph\n  selection_6:\n  - TargetFilename|contains|all:\n    - \\\n    - .jsp\n  - TargetFilename|contains|all:\n    - \\cgi-bin\\\n    - .pl\n", "detection_rule_title": "Windows webshell creation", "detection_rule_author": "Beyu Denis, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0015_11_windows_sysmon_FileCreate"], "logging_policy": ["LP_0008_windows_sysmon_FileCreate"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 8788649301181004305}}
{"date_created": "2018-04-07T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0002: Execution"], "dr_id": "f331aa1f-8c53-4fc3-b083-cc159bc971cb", "technique": ["T1086: PowerShell"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 11\n    TargetFilename:\n    - '*\\Invoke-DllInjection.ps1'\n    - '*\\Invoke-WmiCommand.ps1'\n    - '*\\Get-GPPPassword.ps1'\n    - '*\\Get-Keystrokes.ps1'\n    - '*\\Get-VaultCredential.ps1'\n    - '*\\Invoke-CredentialInjection.ps1'\n    - '*\\Invoke-Mimikatz.ps1'\n    - '*\\Invoke-NinjaCopy.ps1'\n    - '*\\Invoke-TokenManipulation.ps1'\n    - '*\\Out-Minidump.ps1'\n    - '*\\VolumeShadowCopyTools.ps1'\n    - '*\\Invoke-ReflectivePEInjection.ps1'\n    - '*\\Get-TimedScreenshot.ps1'\n    - '*\\Invoke-UserHunter.ps1'\n    - '*\\Find-GPOLocation.ps1'\n    - '*\\Invoke-ACLScanner.ps1'\n    - '*\\Invoke-DowngradeAccount.ps1'\n    - '*\\Get-ServiceUnquoted.ps1'\n    - '*\\Get-ServiceFilePermission.ps1'\n    - '*\\Get-ServicePermission.ps1'\n    - '*\\Invoke-ServiceAbuse.ps1'\n    - '*\\Install-ServiceBinary.ps1'\n    - '*\\Get-RegAutoLogon.ps1'\n    - '*\\Get-VulnAutoRun.ps1'\n    - '*\\Get-VulnSchTask.ps1'\n    - '*\\Get-UnattendedInstallFile.ps1'\n    - '*\\Get-WebConfig.ps1'\n    - '*\\Get-ApplicationHost.ps1'\n    - '*\\Get-RegAlwaysInstallElevated.ps1'\n    - '*\\Get-Unconstrained.ps1'\n    - '*\\Add-RegBackdoor.ps1'\n    - '*\\Add-ScrnSaveBackdoor.ps1'\n    - '*\\Gupt-Backdoor.ps1'\n    - '*\\Invoke-ADSBackdoor.ps1'\n    - '*\\Enabled-DuplicateToken.ps1'\n    - '*\\Invoke-PsUaCme.ps1'\n    - '*\\Remove-Update.ps1'\n    - '*\\Check-VM.ps1'\n    - '*\\Get-LSASecret.ps1'\n    - '*\\Get-PassHashes.ps1'\n    - '*\\Show-TargetScreen.ps1'\n    - '*\\Port-Scan.ps1'\n    - '*\\Invoke-PoshRatHttp.ps1'\n    - '*\\Invoke-PowerShellTCP.ps1'\n    - '*\\Invoke-PowerShellWMI.ps1'\n    - '*\\Add-Exfiltration.ps1'\n    - '*\\Add-Persistence.ps1'\n    - '*\\Do-Exfiltration.ps1'\n    - '*\\Start-CaptureServer.ps1'\n    - '*\\Invoke-ShellCode.ps1'\n    - '*\\Get-ChromeDump.ps1'\n    - '*\\Get-ClipboardContents.ps1'\n    - '*\\Get-FoxDump.ps1'\n    - '*\\Get-IndexedItem.ps1'\n    - '*\\Get-Screenshot.ps1'\n    - '*\\Invoke-Inveigh.ps1'\n    - '*\\Invoke-NetRipper.ps1'\n    - '*\\Invoke-EgressCheck.ps1'\n    - '*\\Invoke-PostExfil.ps1'\n    - '*\\Invoke-PSInject.ps1'\n    - '*\\Invoke-RunAs.ps1'\n    - '*\\MailRaider.ps1'\n    - '*\\New-HoneyHash.ps1'\n    - '*\\Set-MacAttribute.ps1'\n    - '*\\Invoke-DCSync.ps1'\n    - '*\\Invoke-PowerDump.ps1'\n    - '*\\Exploit-Jboss.ps1'\n    - '*\\Invoke-ThunderStruck.ps1'\n    - '*\\Invoke-VoiceTroll.ps1'\n    - '*\\Set-Wallpaper.ps1'\n    - '*\\Invoke-InveighRelay.ps1'\n    - '*\\Invoke-PsExec.ps1'\n    - '*\\Invoke-SSHCommand.ps1'\n    - '*\\Get-SecurityPackages.ps1'\n    - '*\\Install-SSP.ps1'\n    - '*\\Invoke-BackdoorLNK.ps1'\n    - '*\\PowerBreach.ps1'\n    - '*\\Get-SiteListPassword.ps1'\n    - '*\\Get-System.ps1'\n    - '*\\Invoke-BypassUAC.ps1'\n    - '*\\Invoke-Tater.ps1'\n    - '*\\Invoke-WScriptBypassUAC.ps1'\n    - '*\\PowerUp.ps1'\n    - '*\\PowerView.ps1'\n    - '*\\Get-RickAstley.ps1'\n    - '*\\Find-Fruit.ps1'\n    - '*\\HTTP-Login.ps1'\n    - '*\\Find-TrustedDocuments.ps1'\n    - '*\\Invoke-Paranoia.ps1'\n    - '*\\Invoke-WinEnum.ps1'\n    - '*\\Invoke-ARPScan.ps1'\n    - '*\\Invoke-PortScan.ps1'\n    - '*\\Invoke-ReverseDNSLookup.ps1'\n    - '*\\Invoke-SMBScanner.ps1'\n    - '*\\Invoke-Mimikittenz.ps1'\n", "detection_rule_title": "Malicious PowerShell Commandlet Names", "detection_rule_author": "Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0015_11_windows_sysmon_FileCreate"], "logging_policy": ["LP_0008_windows_sysmon_FileCreate"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6581434126018569067}}
{"date_created": "2019-08-22T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["not defined"], "dr_id": "d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image:\n    - '*\\powershell.exe'\n    - '*\\powershell_ise.exe'\n  selection:\n    Company: Microsoft Corporation\n    Description: Windows PowerShell\n", "detection_rule_title": "Renamed PowerShell", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded", "DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded", "LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4675164971126954516}}
{"date_created": "2019-08-10T00:00:00", "date_modified": "2019-11-10T00:00:00", "customer": ["None"], "tactic": ["not defined"], "dr_id": "671bb7e3-a020-4824-a00e-2ee5b55f385e", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\WmiPrvSe.exe\n    - \\WmiAPsrv.exe\n    - \\svchost.exe\n  selection:\n    EventID: 7\n    ImageLoaded|endswith:\n    - \\wmiclnt.dll\n    - \\WmiApRpl.dll\n    - \\wmiprov.dll\n    - \\wmiutils.dll\n    - \\wbemcomn.dll\n    - \\wbemprox.dll\n    - \\WMINet_Utils.dll\n    - \\wbemsvc.dll\n    - \\fastprox.dll\n", "detection_rule_title": "T1047 WMI Modules Loaded", "detection_rule_author": "Roberto Rodriguez @Cyb3rWard0g", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 5277429310400004315}}
{"date_created": "2019-02-16T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0011: Command and Control"], "dr_id": "5f699bc5-5446-4a4a-a0b7-5ef2885a3eb4", "technique": ["T1076: Remote Desktop Protocol"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    DestinationIp:\n    - 127.*\n    - ::1\n    EventID: 3\n    Image: '*\\svchost.exe'\n    Initiated: 'true'\n    SourcePort: 3389\n", "detection_rule_title": "RDP over Reverse SSH Tunnel", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection"], "logging_policy": ["LP_0005_windows_sysmon_network_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -3724788731611997946}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion", "TA0004: Privilege Escalation"], "dr_id": "7c81fec3-1c1d-43b0-996a-46753041b1b6", "technique": ["T1088: Bypass User Account Control"], "raw_detection_rule": "detection:\n  condition: methregistry or ( methprocess and not filterprocess )\n  filterprocess:\n    Image: '*\\mmc.exe'\n  methprocess:\n    EventID: 1\n    ParentImage: '*\\eventvwr.exe'\n  methregistry:\n    EventID: 13\n    TargetObject: HKEY_USERS\\\\*\\mscfile\\shell\\open\\command\nfields:\n- CommandLine\n- ParentCommandLine\n", "detection_rule_title": "UAC Bypass via Event Viewer", "detection_rule_author": "Florian Roth", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent", "DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["not defined", "LP_0003_windows_sysmon_process_creation"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4798748471174587740}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "dd5ab153-beaa-4315-9647-65abc5f71541", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: (signedprocess AND NOT filter) OR (unsignedprocess AND NOT filter)\n  filter:\n    Image|contains: Visual Studio\n  signedprocess:\n    EventID: 7\n    ImageLoaded|endswith:\n    - \\dbghelp.dll\n    - \\dbgcore.dll\n    Image|endswith:\n    - \\msbuild.exe\n    - \\cmd.exe\n    - \\svchost.exe\n    - \\rundll32.exe\n    - \\powershell.exe\n    - \\word.exe\n    - \\excel.exe\n    - \\powerpnt.exe\n    - \\outlook.exe\n    - \\monitoringhost.exe\n    - \\wmic.exe\n    - \\msiexec.exe\n    - \\bash.exe\n    - \\wscript.exe\n    - \\cscript.exe\n    - \\mshta.exe\n    - \\regsvr32.exe\n    - \\schtasks.exe\n    - \\dnx.exe\n    - \\regsvcs.exe\n    - \\sc.exe\n    - \\scriptrunner.exe\n  unsignedprocess:\n    EventID: 7\n    ImageLoaded|endswith:\n    - \\dbghelp.dll\n    - \\dbgcore.dll\n    Signed: 'FALSE'\n", "detection_rule_title": "Dumping Lsass.exe memory with MiniDumpWriteDump API", "detection_rule_author": "Perez Diego (@darkquassar), oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0011_7_windows_sysmon_image_loaded"], "logging_policy": ["LP_0006_windows_sysmon_image_loaded"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6529928328467719350}}
{"date_created": "2019-10-25T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "6aa1d992-5925-4e9f-a49b-845e51d1de01", "technique": ["T1182: AppCert DLLs"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n  - EventID:\n    - 12\n    - 13\n    TargetObject|contains: \\SYSTEM\\\n    TargetObject|endswith: \\Control\\Session Manager\\AppCertDlls\n  - EventID: 14\n    NewName|contains: \\SYSTEM\\\n    NewName|endswith: \\Control\\Session Manager\\AppCertDlls\nfields:\n- EventID\n- Image\n- TargetObject\n- NewName\n", "detection_rule_title": "New DLL added to AppCertDlls registry key", "detection_rule_author": "Ilyas Ochkov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent", "DN_0016_12_windows_sysmon_RegistryEvent", "DN_0018_14_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -4952740671277682909}}
{"date_created": "2019-01-18T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "eeb30123-9fbd-4ee8-aaa0-2e545bbed6dc", "technique": ["T1011: Exfiltration Over Other Network Medium"], "raw_detection_rule": "detection:\n  condition: selection_registry and not exclusion_images\n  exclusion_images:\n  - Image: C:\\Windows\\system32\\msiexec.exe\n  - Image: C:\\Windows\\syswow64\\MsiExec.exe\n  selection_registry:\n    EventID: 13\n    TargetObject:\n    - HKLM\\System\\CurrentControlSet\\Control\\Lsa\\Security Packages\n    - HKLM\\System\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages\n", "detection_rule_title": "Security Support Provider (SSP) added to LSA configuration", "detection_rule_author": "iwillkeepwatch", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "critical", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 6018157664172517730}}
{"date_created": "2019-01-18T00:00:00", "date_modified": "2019-10-01T00:00:00", "customer": ["None"], "tactic": ["TA0003: Persistence"], "dr_id": "02ee49e2-e294-4d0f-9278-f5b3212fc588", "technique": ["T1060: Registry Run Keys / Startup Folder"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    Details:\n    - '*C:\\Windows\\Temp\\\\*'\n    - '*\\AppData\\\\*'\n    - '%AppData%\\\\*'\n    - '*C:\\$Recycle.bin\\\\*'\n    - '*C:\\Temp\\\\*'\n    - '*C:\\Users\\Public\\\\*'\n    - '%Public%\\\\*'\n    - '*C:\\Users\\Default\\\\*'\n    - '*C:\\Users\\Desktop\\\\*'\n    - wscript*\n    - cscript*\n    EventID: 13\n    TargetObject:\n    - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\\*'\n    - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\\\*'\nfields:\n- Image\n", "detection_rule_title": "New RUN Key Pointing to Suspicious Folder", "detection_rule_author": "Florian Roth, Markus Neis", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 7618122751076017584}}
{"date_created": "2019-10-26T00:00:00", "date_modified": "2019-11-11T00:00:00", "customer": ["None"], "tactic": ["TA0004: Privilege Escalation"], "dr_id": "0f9c21f1-6a73-4b0e-9809-cb562cb8d981", "technique": ["T1058: Service Registry Permissions Weakness"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 13\n    IntegrityLevel: Medium\n    TargetObject|contains: \\services\\\n    TargetObject|endswith:\n    - \\ImagePath\n    - \\FailureCommand\n    - \\Parameters\\ServiceDll\nenrichment:\n- EN_0001_cache_sysmon_event_id_1_info\n- EN_0003_enrich_other_sysmon_events_with_event_id_1_data\n", "detection_rule_title": "Possible privilege escalation via service registry permissions weakness", "detection_rule_author": "Teymur Kheirkhabarov", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent", "DN_0003_1_windows_sysmon_process_creation"], "logging_policy": ["not defined", "LP_0003_windows_sysmon_process_creation"], "enrichment": ["EN_0001_cache_sysmon_event_id_1_info", "EN_0003_enrich_other_sysmon_events_with_event_id_1_data"], "enrichment_requirements": ["not defined", ["EN_0001_cache_sysmon_event_id_1_info"]]}
{"index": {"_id": -1651626144150065012}}
{"date_created": "2019-10-22T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0006: Credential Access"], "dr_id": "5e3d3601-0662-4af0-b1d2-36a05e90c40a", "technique": ["T1003: Credential Dumping"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 11\n    TargetFilename|contains: lsass\n    TargetFilename|endswith: dmp\n", "detection_rule_title": "LSASS memory dump file creation", "detection_rule_author": "Teymur Kheirkhabarov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "medium", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0015_11_windows_sysmon_FileCreate"], "logging_policy": ["LP_0008_windows_sysmon_FileCreate"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -6227890324343120005}}
{"date_created": "2017-05-15T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "9d3436ef-9476-4c43-acca-90ce06bdf33a", "technique": ["T1073: DLL Side-Loading", "T1112: Modify Registry"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 13\n    TargetObject:\n    - '*\\Services\\DHCPServer\\Parameters\\CalloutDlls'\n    - '*\\Services\\DHCPServer\\Parameters\\CalloutEnabled'\n", "detection_rule_title": "DHCP Callout DLL installation", "detection_rule_author": "Dimitrios Slamaris", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": 4749822482173848123}}
{"date_created": "2019-10-24T00:00:00", "date_modified": "2019-11-13T00:00:00", "customer": ["None"], "tactic": ["TA0008: Lateral Movement"], "dr_id": "e54979bd-c5f9-4d6c-967b-a04b19ac4c74", "technique": ["T1208: Kerberoasting"], "raw_detection_rule": "detection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\lsass.exe\n    - \\opera.exe\n    - \\chrome.exe\n    - \\firefox.exe\n  selection:\n    DestinationPort: 88\n    EventID: 3\n    Initiated: 'true'\n", "detection_rule_title": "Suspicious outbound Kerberos connection", "detection_rule_author": "Ilyas Ochkov, oscd.community", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "experimental", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0007_3_windows_sysmon_network_connection"], "logging_policy": ["LP_0005_windows_sysmon_network_connection"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -2929496374444483253}}
{"date_created": "2019-03-01T22:50:37.587060", "date_modified": null, "customer": ["None"], "tactic": ["TA0006: Credential Access", "TA0002: Execution"], "dr_id": "aa35a627-33fb-4d04-a165-d33b4afca3e8", "technique": ["T1003: Credential Dumping", "T1028: Windows Remote Management"], "raw_detection_rule": "detection:\n  condition: selection\n  selection:\n    EventID: 10\n    SourceImage: C:\\Windows\\system32\\wsmprovhost.exe\n    TargetImage: C:\\windows\\system32\\lsass.exe\n", "detection_rule_title": "Mimikatz through Windows Remote Management", "detection_rule_author": "Patryk Prauze - ING Tech", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "stable", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0014_10_windows_sysmon_ProcessAccess"], "logging_policy": ["LP_0007_windows_sysmon_ProcessAccess"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
{"index": {"_id": -5468840364392857709}}
{"date_created": "2019-04-03T00:00:00", "date_modified": null, "customer": ["None"], "tactic": ["TA0005: Defense Evasion"], "dr_id": "171b67e1-74b4-460e-8d55-b331f3e32d67", "technique": ["not defined"], "raw_detection_rule": "detection:\n  condition: selection_reg\n  selection_reg:\n    EventID: 13\n    TargetObject:\n    - '*\\services\\TermService\\Parameters\\ServiceDll*'\n    - '*\\Control\\Terminal Server\\fSingleSessionPerUser*'\n    - '*\\Control\\Terminal Server\\fDenyTSConnections*'\n", "detection_rule_title": "RDP Sensitive Settings Changed", "detection_rule_author": "Samir Bousseaden", "detection_rule_internal_responsible": "not defined", "detection_rule_development_status": "not defined", "detection_rule_severity": "high", "detection_rule_confidence": "not defined", "category": ["OS Logs"], "platform": ["Windows"], "type": ["Applications and Services Logs"], "channel": ["Microsoft-Windows-Sysmon/Operational"], "provider": ["Microsoft-Windows-Sysmon"], "data_needed": ["DN_0017_13_windows_sysmon_RegistryEvent"], "logging_policy": ["not defined"], "enrichment": ["not defined"], "enrichment_requirements": ["not defined"]}
