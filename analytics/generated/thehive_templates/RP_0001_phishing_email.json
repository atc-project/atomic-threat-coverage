{"customFields": {}, "metrics": {}, "tlp": 2, "pap": 0, "tasks": [{"order": 0, "title": "1 | RA_0001_identification_get_original_email", "group": "identification", "description": "Obtain original phishing email from on of the available/fastest options:\n\n- Email Team/Email server: if there is such option\n- Person who reported the attack (if it wasn't detected automatically or reported by victims)\n- Victims: if they were reporting the attack\n\nAsk for email in `.EML` format. Instructions: \n\n  1. Drug and drop email from Email client to Desktop\n  2. Send to IR specialists by <email>\n"}, {"order": 1, "title": "2 | RA_0002_identification_extract_observables_from_email", "group": "identification", "description": "Extract the data for further response steps:\n\n- attachments (using munpack tool: `munpack email.eml`)\n- from, to, cc\n- subject of the email\n- received servers path\n- list of URLs from the text content of the mail body and attachments\n\nThis Response Action could be automated with [TheHive EmlParser](https://blog.thehive-project.org/2018/07/31/emlparser-a-new-cortex-analyzer-for-eml-files/).\n"}, {"order": 2, "title": "3 | RA_0003_identification_make_sure_email_is_a_phising", "group": "identification", "description": "Check email and its metadata for evidences of phishing attack:\n\n- **Impersonalisation attempts**: sender is trying to identify himself as somebody he is not\n- **Suspicious askings or offers**: download \"invoice\", click on link with something important etc\n- **Psychological manipulations**: invoking a sense of urgency or fear is a common phishing tactic\n- **Spelling mistakes**: legitimate messages usually don't have spelling mistakes or poor grammar\n\nExplore references of the article to make yourself familiar with phishing attacks history and examples.\n"}, {"order": 3, "title": "4 | RA_0004_identification_analyse_obtained_indicators_of_compromise", "group": "identification", "description": "1. Analyse obtained indicators of compromise. Proof that they are malicious\n2. Find out what exactly attacker was targeting (password harvesting, remote control etc)\n\nThis Response Action could be automated with [TheHive Analyzers](https://github.com/TheHive-Project/Cortex-Analyzers).\n"}, {"order": 4, "title": "4.1 | RA_0015_identification_analyse_domain_name", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 5, "title": "4.2 | RA_0016_identification_analyse_filehash", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 6, "title": "4.3 | RA_0017_identification_analyse_ip", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 7, "title": "4.4 | RA_0018_identification_analyse_macos_macho", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 8, "title": "4.5 | RA_0019_identification_analyse_ms_office_file", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 9, "title": "4.6 | RA_0020_identification_analyse_pdf", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 10, "title": "4.7 | RA_0021_identification_analyse_unix_elf", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 11, "title": "4.8 | RA_0022_identification_analyse_uri", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 12, "title": "4.9 | RA_0023_identification_analyse_windows_pe", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 13, "title": "5 | RA_0005_identification_find_all_phising_attack_victims", "group": "identification", "description": "Identify victims of the attack based on results of indicators of compromise analysis:\n\n1. If phishing led to password harvesting form, you have to identify all users who opened malicious link with harvesting form using linked Response Actions\n- Make sure that during your identification of network connections with malicious server you work with complete informatoin. For example, if corporate DNS/Proxy could be bypassed, it means that you could miss some victims. In this way you have to rely on other types of data (i.e. network flows)\n- Better to check all available sources of information to be 100% sure that you've identified a potential victims\n- Sometimes phising alerts could be found in AV, IPS, NGFW etc logs. Check it as well\n2. If phishing led to code execution on victim host, immediately start using Generic Post Exploitation Incident Response Playbook\n"}, {"order": 14, "title": "5.1 | RA_0026_identification_find_emails_opened", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 15, "title": "5.2 | RA_0030_identification_find_all_hosts_communicated_with_domain", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 16, "title": "5.3 | RA_0031_identification_find_all_hosts_communicated_with_ip", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 17, "title": "5.4 | RA_0032_identification_find_all_hosts_communicated_with_url", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 18, "title": "5.5 | RA_0033_identification_find_files_created", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 19, "title": "5.6 | RA_0034_identification_find_all_victims_in_security_alerts", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 20, "title": "6 | RA_0040_identification_put_on_monitoring_compromised_accounts", "group": "identification", "description": "Start monitoring for authentification attempts and all potentially harmful actions from potentially compromised accounts.\nLook for anomalies, strange network connections, unusual geolocation/time of work, actions which were never executed before.\nKeep in touch with real users and in case of need ask them if they executing these actions by themselves or not.\n"}, {"order": 21, "title": "7 | RA_0006_containment_block_domain_on_email", "group": "containment", "description": "Block malicious sender (or entire domain, if possible) on Email Server using native filtering functionality.\n"}, {"order": 22, "title": "8 | RA_0028_containment_block_threat_on_network_level", "group": "containment", "description": "Develop plan of containment depends on connditions and network architecture, execute it and make sure you have fully blocked threat on network level.\n"}, {"order": 23, "title": "8.1 | RA_0006_containment_block_domain_on_email", "group": "containment", "description": "Block malicious sender (or entire domain, if possible) on Email Server using native filtering functionality.\n"}, {"order": 24, "title": "8.2 | RA_0009_containment_block_url_on_proxy", "group": "containment", "description": "Block URL on Proxy Server using native filtering functionality. \nWarning: If corporate Proxy usage is not mandatory and clients can access internet bypassing it (direct access is not restricted by firewall), this Response Action cannot guarantee containment of threat."}, {"order": 25, "title": "8.3 | RA_0007_containment_block_ip_on_border_firewall", "group": "containment", "description": "Block ip address on border firewall using native filtering functionality.\nWarning: \n- If not all corporate hosts access internet through the border firewall, this Response Action cannot guarantee containment of threat.\n- Be careful blocking IP address. Make sure it's not cloud provider or hoster. In this case you have to use blocking by URL something more specific.\n"}, {"order": 26, "title": "8.4 | RA_0008_containment_block_domain_on_dns", "group": "containment", "description": "Block domain on DNS Server using native sinkholing functionality. \nWarning: \n- If corporate DNS usage is not mandatory and hosts can use public DNS servers (access is not blocked by firewall), this Response Action cannot guarantee containment of threat.\n- Be careful blocking IP address. Make sure it's not cloud provider or hoster. In this case you have to use blocking by URL something more specific."}, {"order": 27, "title": "8.5 | RA_0009_containment_block_url_on_proxy", "group": "containment", "description": "Block URL on Proxy Server using native filtering functionality. \nWarning: If corporate Proxy usage is not mandatory and clients can access internet bypassing it (direct access is not restricted by firewall), this Response Action cannot guarantee containment of threat."}, {"order": 28, "title": "9 | RA_0010_eradication_delete_malicious_emails", "group": "eradication", "description": "Delete malicious emails from Email Server and users' email boxes using native Email Server functionality.\n"}, {"order": 29, "title": "10 | RA_0011_eradication_revoke_compromised_credentials", "group": "eradication", "description": "On this step you supposed to know what kind of credentials have beed compromised.\nYou need to revoke them in your Identity and Access Management system where they were created (like, Windows AD) using native functionality.\nWarning:\n- If adversary has generated Golden Ticket in Windows Domain/forest, you have to revoke KRBTGT Account password **twice** for each domain in a forest and proceed monitor malicious activity for next 20 minutes (Domain Controller KDC service doesn\u2019t perform validate the user account until the TGT is older than 20 minutes old)\n"}, {"order": 30, "title": "11 | RA_0012_eradication_report_phishing_attack_to_external_companies", "group": "eradication", "description": "Report phishing attack to external companites:\n\n1. [National Computer Security Incident Response Teams (CSIRTs)](https://www.sei.cmu.edu/education-outreach/computer-security-incident-response-teams/national-csirts/)\n2. [U.S. government-operated website](http://www.us-cert.gov/nav/report_phishing.html)\n3. [Anti-Phishing Working Group (APWG)](http://antiphishing.org/report-phishing/)\n4. [Google Safe Browsing](https://safebrowsing.google.com/safebrowsing/report_phish/?hl=en)\n5. [The FBI's Intenet Crime Complaint Center (IC3)](https://www.ic3.gov/default.aspx)\n\nThis Response Action could be automated with [TheHive and MISP integration](https://blog.thehive-project.org/2017/06/19/thehive-cortex-and-misp-how-they-all-fit-together/).\n"}, {"order": 31, "title": "12 | RA_0013_lessons_learned_develop_incident_report", "group": "lessons_learned", "description": "Develop Incident Report using your corporate template.\n\nIt should include:\n\n1. Executive Summary with short description of damage, actions taken, root cause, and key metrics (Time To Detect, Time To Respond, Time To Recover)\n2. Detailed timeline of adversary actions, mapped to [ATT&CK tactics](https://attack.mitre.org/tactics/enterprise/) (you can use [Kill Chain](https://en.wikipedia.org/wiki/Kill_chain), but 95% of all actions will be in Actions On Objective stage, which is not really representative, meaningfull and usefull)\n3. Detailed timeline of actions taken by Incident Responders\n4. Root Cause Analysis and Recommendations for improvements based on its conclusion\n5. List of specialists involved into Incident Response with their roles\n"}, {"order": 32, "title": "13 | RA_0014_lessons_learned_conduct_lessons_learned_exercise", "group": "lessons_learned", "description": "This Lessons Learned phase evaluates the team's performance through each step. \nBasically, this takes the incident report and answers some basic questions:\n\n- What happened?\n- What did we do well?\n- What could we have done better?\n- What will we do differently next time?\n\nThe goal of the Lessons Learned phase is to discover how to make the next incident response go faster, smoother, or ideally never happen at all.\nKeep in mind that incident report is a key. If, for example, Time To Respond looks horrible, it was caused by some problem.\nThe only way to solve it is to bring it up and start working on it.\n"}], "description": "Description:\nResponse playbook for Phishing Email case. \n\n\nWorkflow:\n1. Execute Response Actions step by step. Some of them directly connected, which means you will not be able to move forward not finishing previous step\n2. Start executing containment and eradication stages concurrently with next identification steps, as soon as you will receive infomration about malicious hosts\n3. If phishing led to code execution or remote access to victim host, immediately start executing Generic Post Exploitation Incident Response Playbook\n4. Save all timestamps of implemented actions in Incident Report draft on the fly, it will save a lot of time\n", "name": "RP_0001_phishing_email", "status": "Ok", "severity": 2, "titlePrefix": "", "tags": ["attack.initial_access", "attack.t1193", "attack.t1192", "phishing"]}